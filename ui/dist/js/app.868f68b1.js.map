{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/Pipeline.vue","webpack:///src/components/Pipeline.vue","webpack:///./src/components/Pipeline.vue?1d32","webpack:///./src/components/Pipeline.vue?77cc","webpack:///./src/components/QuickActionButtons.vue?bc95","webpack:///./src/components/ImageBrowsing.vue?3073","webpack:///./src/components/QueueView.vue?b099","webpack:///./src/components/TaggingShortcutsDialog.vue?3fcd","webpack:///./src/views/Login.vue?c3c6","webpack:///./src/views/PageView.vue?ff0f","webpack:///./src/views/DbConsole.vue?4835","webpack:///./src/views/TaskList.vue?e65c","webpack:///./public/assets/video.png","webpack:///./src/components/Pipeline.vue?e461","webpack:///./src/components/ImageBrowsing.vue?2741","webpack:///./src/views/SystemAdmin.vue?1222","webpack:///./src/components/ParamInput.vue","webpack:///src/components/ParamInput.vue","webpack:///./src/components/ParamInput.vue?988f","webpack:///./src/components/ParamInput.vue?1244","webpack:///./src/App.vue","webpack:///./src/components/QueueView.vue","webpack:///src/components/QueueView.vue","webpack:///./src/components/QueueView.vue?4a47","webpack:///./src/components/QueueView.vue?7da7","webpack:///src/App.vue","webpack:///./src/App.vue?ff1e","webpack:///./src/App.vue?315a","webpack:///./src/plugins/vuetify.js","webpack:///./src/views/SearchForm.vue","webpack:///./src/components/ResultsView.vue","webpack:///./src/views/PageView.vue","webpack:///./src/components/ContentView.vue","webpack:///src/components/ContentView.vue","webpack:///./src/components/ContentView.vue?9e2b","webpack:///./src/components/ContentView.vue?64fa","webpack:///./src/components/ImageBrowsing.vue","webpack:///./src/components/VideoPlayer.vue","webpack:///src/components/VideoPlayer.vue","webpack:///./src/components/VideoPlayer.vue?d49e","webpack:///./src/components/VideoPlayer.vue?7720","webpack:///src/components/ImageBrowsing.vue","webpack:///./src/components/ImageBrowsing.vue?9f34","webpack:///./src/components/ImageBrowsing.vue?e97c","webpack:///src/views/PageView.vue","webpack:///./src/views/PageView.vue?4b17","webpack:///./src/views/PageView.vue?b2b5","webpack:///./src/components/QuickActionButtons.vue","webpack:///src/components/QuickActionButtons.vue","webpack:///./src/components/QuickActionButtons.vue?a77f","webpack:///./src/components/QuickActionButtons.vue?76c2","webpack:///./src/components/TaggingDialog.vue","webpack:///src/components/TaggingDialog.vue","webpack:///./src/components/TaggingDialog.vue?8207","webpack:///./src/components/TaggingDialog.vue?eaea","webpack:///./src/components/TaggingShortcutsDialog.vue","webpack:///src/components/TaggingShortcutsDialog.vue","webpack:///./src/components/TaggingShortcutsDialog.vue?d7cb","webpack:///./src/components/TaggingShortcutsDialog.vue?d301","webpack:///src/components/ResultsView.vue","webpack:///./src/components/ResultsView.vue?440a","webpack:///./src/components/ResultsView.vue?4e80","webpack:///src/views/SearchForm.vue","webpack:///./src/views/SearchForm.vue?ffd0","webpack:///./src/views/SearchForm.vue?3091","webpack:///./src/views/TaskDetail.vue","webpack:///./src/components/BlocklyComponent.vue","webpack:///src/components/BlocklyComponent.vue","webpack:///./src/components/BlocklyComponent.vue?0342","webpack:///./src/components/BlocklyComponent.vue?81f5","webpack:///src/views/TaskDetail.vue","webpack:///./src/views/TaskDetail.vue?ae5d","webpack:///./src/views/TaskDetail.vue?ed19","webpack:///./src/views/TaskShortcut.vue","webpack:///src/views/TaskShortcut.vue","webpack:///./src/views/TaskShortcut.vue?6e17","webpack:///./src/views/TaskShortcut.vue?5710","webpack:///./src/views/TaskList.vue","webpack:///src/views/TaskList.vue","webpack:///./src/views/TaskList.vue?f821","webpack:///./src/views/TaskList.vue?bd03","webpack:///./src/views/DatasetList.vue","webpack:///src/views/DatasetList.vue","webpack:///./src/views/DatasetList.vue?841a","webpack:///./src/views/DatasetList.vue?cfd8","webpack:///./src/views/History.vue","webpack:///src/views/History.vue","webpack:///./src/views/History.vue?d08c","webpack:///./src/views/History.vue?c329","webpack:///./src/views/Login.vue","webpack:///src/views/Login.vue","webpack:///./src/views/Login.vue?97cc","webpack:///./src/views/Login.vue?24a5","webpack:///./src/views/QueueResult.vue","webpack:///src/views/QueueResult.vue","webpack:///./src/views/QueueResult.vue?82a4","webpack:///./src/views/QueueResult.vue?96d0","webpack:///./src/views/StorageList.vue","webpack:///src/views/StorageList.vue","webpack:///./src/views/StorageList.vue?0a55","webpack:///./src/views/StorageList.vue?4b7e","webpack:///./src/views/SystemAdmin.vue","webpack:///src/views/SystemAdmin.vue","webpack:///./src/views/SystemAdmin.vue?bddc","webpack:///./src/views/SystemAdmin.vue?c00e","webpack:///./src/views/Preferences.vue","webpack:///src/views/Preferences.vue","webpack:///./src/views/Preferences.vue?5e11","webpack:///./src/views/Preferences.vue?053c","webpack:///./src/views/DbConsole.vue","webpack:///src/views/DbConsole.vue","webpack:///./src/views/DbConsole.vue?c855","webpack:///./src/views/DbConsole.vue?026f","webpack:///./src/views/AutoTags.vue","webpack:///src/views/AutoTags.vue","webpack:///./src/views/AutoTags.vue?46d3","webpack:///./src/views/AutoTags.vue?09ce","webpack:///./src/views/QueryFormTest.vue","webpack:///./src/components/QueryFormulator.vue","webpack:///src/components/QueryFormulator.vue","webpack:///./src/components/QueryFormulator.vue?31e4","webpack:///./src/components/QueryFormulator.vue?f7a7","webpack:///src/views/QueryFormTest.vue","webpack:///./src/views/QueryFormTest.vue?cd22","webpack:///./src/views/QueryFormTest.vue?09af","webpack:///./src/main.js","webpack:///./public/assets/loading.png","webpack:///./src/views/SearchForm.vue?afc5","webpack:///./src/views/AutoTags.vue?e3af","webpack:///./src/views/QueueResult.vue?a7f4","webpack:///./src/components/ResultsView.vue?c9dd","webpack:///./src/views/Preferences.vue?ba7c","webpack:///./src/locales/index.js","webpack:///./src/components/TaggingDialog.vue?26ad","webpack:///./src/App.vue?bb18","webpack:///./src/views/DatasetList.vue?ed3d","webpack:///./src/views/StorageList.vue?0afe","webpack:///./src/api.js","webpack:///./src/components/VideoPlayer.vue?464b","webpack:///./public/assets/no-image.png","webpack:///./src/components/ParamInput.vue?51ef","webpack:///./src/components/ContentView.vue?4d63","webpack:///./src/components/BlocklyComponent.vue?0375","webpack:///./src/components/ResultsView.vue?5323"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","installedCssChunks","jsonpScriptSrc","p","exports","module","l","e","promises","cssChunks","Promise","resolve","reject","href","fullhref","existingLinkTags","document","getElementsByTagName","tag","dataHref","getAttribute","rel","existingStyleTags","linkTag","createElement","type","onload","onerror","event","request","target","src","err","Error","code","parentNode","removeChild","head","appendChild","then","installedChunkData","promise","onScriptComplete","script","charset","timeout","nc","setAttribute","error","clearTimeout","chunk","errorType","realSrc","message","name","undefined","setTimeout","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","console","jsonpArray","window","oldJsonpFunction","slice","staticClass","_c","_vm","_v","attrs","index","on","update_valid","model","callback","expression","directives","staticRenderFns","render","components","StageDetail","draggable","stages","show_code","valid","shortcut","props","methods","update_shortcut","append_stage","remove_stage","move_stage","mounted","api","component","arg","choices","filter","hint","inputListeners","input","$attrs","keys","$event","ref","indexOf","keyCode","_k","$$v","preventDefault","drop_file","$refs","input_file","click","_s","_b","default","input_func","vm","val","inheritAttrs","events","PrismEditor","computed","type_choices","split","map","x","text","prompt","file_prompt","langs","object_value","watch","validate","highlighter","update_object_value","refresh","update_choices","join","reader","scopedSlots","proxy","$t","_l","item","log_out","$router","_e","drawer","queue","opacity","$route","fullPath","staticStyle","viewer","console_outputs","width","$i18n","messages","pair","ui_language","domProps","sb","show_detail","running","clear_not_viewable","task","delete_result","download_link","title","view_result","downloadable","viewable","QueueView","loading","finished","waiting","queue_source","logs","admin","shortcuts","snackbars","app_title","app_dark","copyright","queue_timeout_flag","setup","created","$on","loading_num","bundle","concat","visible","logined","catch","nav_click","update_queue","queue_event","sse","cleanup","Vue","use","Vuetify","icons","iconfont","q","sort","selected_datasets","search","groups","export_file","page_size","load_search","rawName","total","update_selection","selected","$set","current_q","source","config","view_mode","class","_id","view_page","mongocollection","dialogs","info","edit","fn","set_selection","visible_data","Array","isArray","col","show_embedded","pages","paragraph","start_index","new_field","$forceUpdate","send_task","quicktask_results","quicktask","tagging_shortcuts","initial","clear_selection","delete_items","show_tagging_dialog","playing","left","down","style","overflow","height","_wheel_handler","page","try_page","pagenum_editor","pagenum_edit","active_paragraph","outline","show_modal","is_html","content","favored","fav","get_item_image","querystring_stringify","match","quote","show_all_tags","tags","_open_window","tag_class","scope","autoplay","fit_image","browse_next","browsing_page","rating","options","muted","handleVideoPlaying","handleMouse","playbackRate","vp","currentTime","handleVideoPlay","delta","requestFullscreen","toggle_play","to_friendly_time","secs","fullscreen","handleKey","setInterval","slider","span","beforeDestroy","ContentView","VideoPlayer","browsing_video","format","get_item_video","wh","ww","imgr","nw","transform","offsetX","offsetY","rr","nh","top","position","display","toggle_fits","browse_prev","ParamInput","ImageBrowsing","file","pdf_image","new_pagenum","sequential","folio","fetched_paragraphs","loading_image","paragraph_index","item_index","playing_timer","playing_interval","last_inc","last_wheel","paragraphs","plugin_pages","window_height","active_item","shown_paragraphs","active_paragraph_images","params","update_pdfpage","path","history","query","id","keywords","image_element","_event_handler","direction","inc","_paragraph","save_pagenum","selection_count","tag_choices","tag_typing","tag_new","batch_delim","batch_prefix","author_candidates","author","cancel","batch","enter_hit","show","escape_search","match_pattern","search_tag","pattern","regex","do_submit","multiple","match_initials","load","PageView","QuickActionButtons","TaggingDialog","TaggingShortcutsDialog","token","page_range","sticky","set","embedded","quicktasks","pipeline","results_count","list","tagging","selection","browsing_item","select_index","last_key","offset","columns","_fetched","start","querify","turn_page","items","image","_preload","limit","update_view_mode","arr","_keyup_handler","selection_line_number","_album","escape_regex","replace","selection_inc","ele","archive","mediaitem","save","matched_content","_show_dialog","selected_paragraphs","selected_items","paragraph_id","y","selected_ids","sel_end","sel","toggle_selection","set_author","ids","$push","pull","$pull","updates","select_paragraph_item_objects","visible_album_items","album_items","least","group","ungroup","merge","reset_storage","get_paragraph_image","ResultsView","datasets","open_datasets","selected_mongocollections","querystr","req","selection_bundles","external_json","cancel_source","expert","search_params","datasets_req","sid","sourcefiles","dataset","req_datasets","req_sourcefiles","sf","mongocollections","count","keyword_patterns","reduce","kvpair","export_query","put","output_format","drop_json_file","load_remote_file","shared","resume_next","parseInt","blockly","k","shortcut_map","pipelines","workspace","blocks_dict","media","toolbox","Blockly","clearInterval","auto_parse","load_toolbox","kind","contents","colour","previousStatement","nextStatement","message0","obj","init","toolbox_contents","args0","output","tooltip","文件来源","网页来源","文件页码","页码","日期","关键词和标签","内容","语言","数据集","大纲","图像","color","to_xml","parent","args","block","argtype","field","argvalue","valuenode","valueblock","valueblockfield","from_field_expr","op","EQ","LT","LE","GT","GE","NE","from_xml","next","child","Pipeline","BlocklyComponent","tasks","user","delete_task","alert","notify","enqueue","shortcut_description","kv","shortcut_params","results","result_plain","update_params","byteNumbers","byteArrays","b64toBlob","get_map_arg","v","get_map_val","create_task","duplicate_task","otask","delete","enqueue_task","rename_collection","input_coll","load_datasets","coll","order_weight","sources","append_dataset","to","refresh_sources","h","queries","replay","encodeURIComponent","tab","username","password","remember","otp","login","auth","redirect","load_data","ex","update_files","fullpath","file_link","enter","f","install_plugin","rename_file","pages_count","files","selected_dir","progress","open_file_dialog","new_folder","mkdir","upload_file","upload","search_file","url","destination","copy_file_path","testingCodeToCopy","show_modify","new_user","show_user_modal","del_user","show_creation","add_user","users","roles","scheduled_jobs","scheduler","cron","modify_user_role","update_scheduler","create_schedule","delete_schedule","old_password","password2","otp_secret","force_thumbnail","enhance","update_password","change_otp","create_qr_code","colorDark","colorLight","correctLevel","command","operation","previewed","stringify_command","operation_params","preview","preview_text","get_command","JSON","execute","auto_tags_apply","auto_tags","new_tag","cond","auto_tags_create","auto_tags_delete","reload","next_page","prev_page","do_search","toLowerCase","this","_self","test","brackets","startsWith","jointer_choices","jointer","successor","FIELDS","BINARY_OPERATORS","JOINTERS","LITERALS","UNIARY_OPERATORS","FUNCTIONS","context","function","literal","_items_from_array","_selected_string","_stringify","update","QueryFormulator","ignoredElements","VueRouter","ds","Date","toLocaleString","Treeselect","routes","SearchForm","Login","TaskShortcut","TaskDetail","TaskList","DatasetList","History","QueueResult","StorageList","SystemAdmin","Preferences","DbConsole","AutoTags","QueryFormTest","router","scrollBehavior","beforeEach","from","localStorage","vuetify","i18n","App","$mount","VueI18n","DEFAULT_LANG","LOCALE_KEY","locales","chs","require","cht","en","ja","locale","fallbackLocale","lang","getItem","setItem","forEach","body","classList","remove","add","_prompt_no_image","_prompt_video","apiBase","_stack","_token","LocalConfig","defaults","fit","contain","dbconsole","multiple_image_domains","_save_config","stringify","_load_config","parse","handler","Proxy","assign","Cookies","domain","location","hostname","stack","bus","notice","$emit","querystring_parse","str","URLSearchParams","entries","substring","blob_download","blob","filename","URL","createObjectURL","link","download","dispatchEvent","MouseEvent","bubbles","cancelable","view","revokeObjectURL","axios","CancelToken","_catch_and_then","DataError","constructor","resp","pop","__exception__","__tracestack__","log","endsWith","toString","_axios_config","other","headers","progress_handler","onUploadProgress","substr","expires","help_pipelines","_pipelines","accept","help_langs","_langs","_debracket","post","cancelToken","cut_words","includes","get_datasets","_segs","seg","weights","colls","_comp","s1","s2","si","xx","yy","localeCompare","get_datasets_hierarchy","bundles","hierarchy","children","segments","display_name","level","parent_obj","segs","cand","label","dataset_name","_generate_domain","prefix","host_name_regex","simpleHash","hash","char","charCodeAt","Uint32Array","host","get_image_url","ext","orig_path","block_id","Buffer","disable_args","item_type","thumbnail","images","ats"],"mappings":"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njE,MAA2jE,CAAjvF,U,oBAEIS,UAAe,GAAnB,0FAEA,GAASC,C,6GC2FM,GACfhI,OACA,OACAsN,iBAGA9E,eACAC,SACAkF,iBACA,+CAEAD,iBACA,gCACA3E,oCACAA,eAAA6E,eACA,4BAGAJ,qBACA,iCACA,gCACAzE,oCACA,6BAIA8E,eACA,gCACA,+CACA,qBAEAC,gBACA,sBACA,WACA,WACA,WACA,SACA,QACA,WAGAC,YACA,sBACA,WACA,eACA,gBACA,SACA,QACA,aC/ImV,I,wBCQ/U/E,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,EAAAA,E,oBCkJA,GACf7D,WACA8C,YACA+F,aAEAhO,OACA,OACAuM,UACA0B,WACAzB,OACA0B,YACAC,UACAZ,YAEAa,kBACAC,QACAC,SACAC,aACAC,aACA1B,mBACA2B,mBACAC,YACAC,aACAxB,eACAyB,uBAGArD,OACAmD,YACA,8BAEAD,aACA5L,kBAEAsK,eACA0B,kBACA9F,iBAEAwD,UACAxD,yBAGA+F,UACA,mCACA/F,WACAgG,IAAA,UAAAC,qBACAD,IAAA,QAAAE,IACA,gBACA,mCACAA,EACA,8BACA9F,OAAA8B,cACAiE,OAAA,CACA,CACAhE,KACA,gDACA,WACAhG,EACAiK,cAGAjI,MAAA,OAEA6H,IAAA,SAAAvI,IACA,oCAEA,wBACAuC,OACAqG,UACAhL,KAAApE,kDACAoE,KAAA,KACA2E,OACAnI,KAAA,mBACAwD,KAAApE,4BACA,aACA,qBAGAqP,MAAA,8BAGAvG,UACAC,6BACAtI,+BAEA,sBACAuG,mBACA,0BACA,wBAEAA,oBACA,oBAEA,kCAEA6D,UACAgC,SACA,2CAGApE,SACA6G,aACA,8DAEAlD,UACArD,kBAEAwG,gBACA,IACA,YACA,0CACA,yCACA,4CAGAC,cACAzG,6CACA,oBACA,uDACA,gCACAjC,eACA,yBACA,OACA,uCACA,iCACA,gEACA,yBAIA2I,KACAC,aCxS8T,ICQ1T,G,UAAY,eACd,EACA,EACA3H,GACA,EACA,KACA,KACA,OAIa,I,wCCdf4H,aAAIC,IAAIC,QAEO,UAAIA,OAAQ,CACvBC,MAAO,CAAEC,SAAU,S,+FCRiLtG,W,MAAwB,KAAiD,EAAlG,W,OAA+HA,SAAOM,C,MAAkB,CAAxJ,UAAuKxC,GAAK,OAAC,wC,GAAC,CAAuB,cAAc,GAAtC,OAA4C,mBAA5C,wCAA0HmC,SAAI,SAAL,GAAmBvC,EAAW,oB,GAAgDhC,OAAS,C,MAAc7B,CAAxB,qBAA7E,kBAAuH,WAAC,UAAxH,8CAA8IqE,IAAK,c,YAAaqI,iC,MAAGpI,C,IAAyB,CAAxC,mBAAmDC,eAAqCV,IAAiDI,OAAM,U,MAAY,CAApE,UAA+F,SAAC,YAAC,IAAQ,G,WAA4H,OAArO,UAAsQI,YAAM,qC,MAAM,CAASC,MAAQ,G,MAAiBP,EAAA,a,GAAWQ,CAAnD,kBAAuE,OAAC,OAAa,8DAAY,EAAC,+BAAsC,MAAnD,CAAuEN,MAAM,IAAC,SAAQF,SAAO,GAAQ,IAAQ,G,WACpnC4E,OAAZ,EACA,Q,YAAW,+B,MAAc/F,CAAzB,MACA,S,MAA6BA,CAA7B,MACA,a,MAAQmB,G,MAAyB,EAJ0mC,KAK3oC,gBAAE6D,MAAM7D,MAA2BnB,CALwmC,KAM3oC,cAAEgF,MAAM7D,SAAkBnB,CANinC,uBAAxH,gBAO7gC,CAAEA,KAAOmB,EAAI4I,GAAZ,UAAkBrI,MAAQ,UAAiBP,CAA3C,6BAAyDQ,aAAzD,CAPyZ,KAAf,EAOlT,GAAC,UAAS+E,MAAW,YAArB,MAAkD,CAA0BrF,MAAM,OAAC,kBAAD,GAAiB,OAAUF,GAAlC,sBAAuFnB,IAAK,GAAK,EAACgK,Q,YAA4B,C,aAAoBA,U,CAAuBrI,UAAU,EAAC,cAA9F,OAAhH,UAA+O,EAAUV,QAAY,WAAcC,YAAW,iB,MAAQ,CAAR,0BAA6B,SAAC,YAAC,oBAAY+I,GAAU9I,WAAW+C,wBAAsDwC,OAAW,EAAC,Q,YAAC,a,CAAqB,UAAtB,OAAmDvF,MAAO,WAAuFuF,IAAa,MAAQ,WAAQrF,GAAK,GAAC,kC,YAAA,O,YAAA,CAAsB,cAC1vB,O,iBAAe,W,CAAf,EACA,6C,YAAW,sB,YAAqB,CAAhC,MACA,Q,MAA0BrB,CAA1B,MACA,G,KAAQmB,G,MAAyB,EAJiuB,kBAApG,cAKxpB,CAAEnB,KAAOmB,EAAI+I,YAAQxI,MAAQ,SAAiBP,CAA7C,oBAA6DQ,gBAA7D,CALigB,KAKta,eAAwBV,MAAW,YAAc,OAA6BC,MAAG,EAAD,OAA2GD,SAAW,SAAZ,GAA0B,Y,WAAoC,aAApC,uBAAnC,YAAkG,UAAqGA,IAAwB,MAAC,iB,GAA0B,OAAOE,GAAIgJ,8BAAX,sD,YAA+B,UAAzD,IAA6DjJ,MAAG,SAAcE,GAAoG,OAAC,EAAL,uB,CAAyC,YAAYD,GAAIiJ,2EAAjB,YAAxC,UAAoE7I,GAAG,CAAC,MAAOJ,SAAIkJ,GAAZ,gC,uGAElvBxI,cAEJ,YAAiBA,O,2KChB+J,GAA+P,W,IAASR,EAAM,KAAC,IAAQ,SAAhB,OAA0C,IAAb,QAAiB,WAAmCA,IAAK,U,MAAE,EAAQ,kBAAT,UAAhB,YAAqC,SAAqDA,GAAK,OAAC,C,YAAS,oBAAT,OAAsBH,UAAY,GAAmDU,MAAU,I,GAAe0I,CAAiBtK,OAAU,EAACuK,kBAAzC,MAAb,CAAoGtJ,QAAY,iBAAUE,SAAO,SAAWA,GAA0BoJ,EAAOpJ,KAAIoJ,yBAAiCtJ,WAAY,qBAA0DuC,GAAI,QAAYvC,OAAkCE,MAAQA,S,CAAiEb,EAAG,OAAC,MAAWgB,oBAAhB,a,MAAsBL,CAA1C,MAAoE,S,CAAiBA,UAAW,EAAC,uBAAvB,a,MAAwC,C,MAAE,YAAjD,GAAoEC,OAAE,GAAO,6C,WAACD,CAAW,CAAnB,KAAgC,OAAcA,iBAA6BI,MAAM,e,WAAS,mB,YAA7C,S,CAAmEE,EAAG,kC,MAAC,W,OAA0B,EAAOJ,OAAIqJ,C,YAAiC,cAAvE,EAAtE,qC,IAA+I/I,Y,YAAgBgJ,qB,GAAU/I,KAAQ,cAAC,SAAe,K,MAACP,GAAIuJ,OAAQ,QAAZ,C,IAA7C,W,YAAqF,WAArF,SAAtK,IAA+Q,EAAgDrJ,YAAM,Y,MAAC,C,UAEpgDsJ,Q,GAEPT,MAAQ,C,YAJkgD,Q,CAKzgD,UAAS,CALggD,6BAAZ,MAKp+C9I,CAA+HC,MAAM,GAAC,eAClKF,I,GAIE6I,C,OACQ,YANuJ,sCAAZ,MAOzH5I,CAAoCC,MAAM,WAAC,SAASuJ,SAAV,GAAqB,OAAS,iBAAYzJ,WAAW+C,gBAZgjC,EAAH,GAY12B/C,IAAI0J,EAAOC,QAAX,YAAmC5J,MAAG,EAAD,IAAS,CAAC6J,MAAM,CAAEN,KAAQ,IAAIA,yBAArB,gBAAgCpJ,kBAAM,YAAC,gBAA0C,OAAS,WAAyBE,CAAE,EAAC,gH,MAAC,C,KAAyB,IAAWiJ,wBAAJ,CAAjC,6DAAyE,kBAAW,CAASjH,WAAQ,OAAOpC,SAA5G,kBAAgKb,GAAK,GAAC0K,EAAP,4BAAW3J,MAAM,CAAC,cAAgBwJ,IAAiB,kB,CAA+B,YAAc,8IAA/E,sBAAsF3J,GAAS,WAAN,EAAD,OAAO,qBAACD,OAAiCC,SAAE,EAAS,U,MAAK,C,QAAgCC,EAAI8J,OAAJ,QAAqB,WAAtD,8BAAkJ5J,IAAO,MAAQ,SAAU6J,GAE58B,SAAS,yBAAYhK,SAAE,SAAkB,GAAiF,0B,EACxH,KAACiK,EAAQC,cAAe,C,IAAM,MAD0F,OACtFlK,UAAY,EAAI,OAAI,UAAkF,UAAC,EAAC,WAAQ,I,YAA6BmK,OACjJ,SAD2G,gCACxG,CAACnK,EAAG,QAAoGG,IAAO,eAAW,GAAnB,yB,CAA4DiK,EAAE,OAAC,GAAS,+D,MAAA,C,KAAMjK,oFAAN,OAAc,W,UAAmCJ,GAAW,GAAC,sE,GAAb,CAA4I,kBAAG,EAApO,sBAAmP,EAAC,QAASE,KAAA,SAAYgK,K,CAAsFlK,UAAW,EAAC,2EAAvB,GAAmCC,CAAwBK,MAAG,YAAC,UAAQ,c,EAAiBJ,QAAIoK,cAAJ,K,GACzjB,wF,MAD+hB,CAAzB,WACxf,IAA+CtK,YAAY,OALgoB,IAZ2X,YAAjL,GAiB7yBC,UAAG,GAA8E,EAAOA,MAAY,IAA3E,MAAkH,UAAW,EAAKC,GAAG,EAACqK,IAAuCtK,YAAQ,kBAAKI,6FAA0C,MAAU,I,CAAMhB,EAAG,OAAI,EAAGgB,iDAAX,OAAoBmK,EAAMC,OAAUC,CAA6BpK,IAAG,E,YAAS,W,GAAiB,OAAWqK,C,GAAsB,CAA3D,kBAAiE,EAAC,cAAU,CAAO,IAjB3a,EAiB8f,UAAS,YAA8C,GAAC,0BAAC,OAASzK,EAAI0K,OAAMvR,CAA3B,2BAAwC,IAAC,QAAC0F,GAAK,EAAEmB,QAAR,0D,OAAkBO,EAAQ,KAAC,C,IAAmB,GAA9C,oBAAyDC,eAAW,mCAApE,eAA8ET,IAAG,GAA8ED,OAAY,qBAAsByF,SAAW,KAAC,CAAC,MAAY,GAA5D,wCAAoErF,GAAM,CAAC,MAAO,SAAR,GAAiB,OAAQ,wBAAQ,UAAS,MAASkC,eAAO,gDAACpC,MAAwC,iBAAnE,oBAAxL,GAA5I,QAAyZD,CAAiED,OAAkCyF,OAAW,EAAC,oBAA/C,CAAoErF,MAAM,OAAC,SAAS,SAAQ,GAAU,OAAQ,GAAII,WAAM,UAA8BC,QAAS,cAAe,0C,YAAUP,sB,YAAhE,CAA+FQ,YAAW,QAAnS,MAAtb,CAAswB6B,KAAI,SAAYvC,MAAW,I,GAAoB,CAA8B,gBAAgB4J,GAAiB,gBAAkBM,IAAQW,EAAUC,UAA+C,GAAC,8D,YAAQ,sB,YAAwB5K,CAA4B,YAA5D,Q,MAAqF,CAAmC,MAAxH,gBAAyH,U,MAAzH,CAA0K,QAAO,OAASoC,U,SAAY4H,SAAalC,GAChyD9H,EAAIgK,OAAQC,OAAK3N,YAAjB,IAAmC,WAAS0D,uBAAYM,IAAM,iB,IAACzB,Y,YAA+C,Y,MAAmB,CAA6C,WAAhH,eAAiH2B,UAAW,mBAA5H,4CAA2JT,aAAc,gB,GAAQlB,CAAiC0B,KAAQ,SAAC,GAAgBP,OAAIuJ,EAAKvJ,UAAYiK,EAArB,KAA2B,IAAiBzJ,cAAW,GAAlH,8BAAwL+E,OAAW,SAAC,GAAC,WAAe,GAAQrF,KAAM,YAAC,UAAO,gBAAnD,yBAA2D,OAAQ,U,MAAkD,CAA3D,kCAA+DH,SAAG,SAAU,GAAqI,EAAOA,KAAG,EAAD,QAAS,wBAAT,WAAoB,+B,EAAiB,OAAO,C,MAAR,CAAhB,MAAmCE,EAAGD,QAAR,KAAqBD,QAAYG,SAAM,YAAC,OAAO,6BAAxB,WAAyC,yBAAoDE,CAAE,EAAC,4B,YAAS,C,eAA6B6J,QAAtC,OAA+DjK,KAAO,I,GAAkEnB,CAAiC0B,MAAQ,SAAC,GAAgBP,EAAIuJ,QAAQ,KAACS,SAAc,KAAtF,2HAAnB,OAAkK,SAAUjK,CAAmIG,IAAM,GAAC,UAAO,CAAf,OAAsB,W,CAA0BF,EAAIgK,KAAJ,GAAYE,MAAKpC,EAAjB,OAA2B,CAAM,OAA3D,WAA8L,GAAO/H,GAAG,YAAc,MAACZ,GAAG,EAACA,kBAAL,GAAWY,CAK99CG,MAAM,YAAC,UAAM,mB,GAAiC+C,OAAS,8C,MAA1C,CAAP,MAAP,uBAAkE3C,SAAM,YAACzB,OAAOmB,EAAIgK,QAAQE,KAAK5N,UAAzB,I,WAA+D,yB,GAA6CkE,UAAW,uG,MAAvH,CALi7C,KAKxxCyE,IAA4E/E,IAAO,MAAM,YAAEjE,EAAI,QAAE,KAAR,c,CAAA,oGAAP,OAAP,UAA4DqE,IAAM,GAACzB,GAAK,OAAE,CAAiBgM,OAAzB,mDAC1Q,EAAC,KADyQ,gBAAoCtK,OAAyBP,IAAIuJ,CAAjE,cAA2G/I,KAAU,EAArH,eAAkK,OAAyBR,MAAIgK,EAAJ,QAAiB1N,KAAO0D,OAAIgK,G,qBACrlBhK,EAAI8K,eAAJ,kBAD+hB,0CAC1a,UAAC,SAAQ,2BAAT,MAAP,CAA6B,IAAC,CAAC,cAAyB,WAAkB,aAAiD1K,MAAG,CAAC,QAAQ,QAASgC,e,SAAY4H,SAAalC,GAAgB,sCAAI9H,WAAW+C,4BAA0DlE,SAAOmB,C,GAA8BO,C,MAA6BgJ,SAASS,GAA5E,uE,CAA6T,SAAO,4DAAR,MAAP,CAAqB,MAAC,W,GAA0BhK,CAAqC,kBAA/D,mB,CAAyJ,OAASA,GAAIgK,KAAJ,YAAqB1N,EAArB,QAAV,GAAP,CAAkE,MAAC,YAAC,UACl5B,KAACiE,SAAS,K,CAAA,EAAX,iDADk5B,OAApG,MAAjS,EAC9b,QAAM,SAAD,QAAaD,SAAM,YAACzB,EAAK,KAAMmL,UAAQe,SAAUjD,UAA9B,I,WAAyE9H,6B,CAAwCQ,SAAU,GAAC,mHAA5H,OAA2JT,KAAG,I,GAA2G,CAAR,kBAAsB,iC,CAAgE,iEAAhE,OAAoEA,OAAG,EAAUC,QAAO,gBAAgB,KAAxN,IAAiO,WAAuC,CAA2CE,KAAM,eAAC,OAAQ,EAAG,OAAQF,EAAI4E,QAAG,SAA3B,iBAAgFtE,IAAM,iB,MAAM,CAAkCC,QAAS,kBAAe,Q,SAAC,SAAayJ,GAA9E,kFAA0K9J,GAAK,OAAC,qE,MAAC,CAAkB,SAAYE,GAAG,CAAC,MAAQ,SAASgC,GAAQ,UAAWQ,UAAMoI,cAA8B,CAACjL,EAAG,QAAD,EAAWC,GAAIC,gBAAG,IAAR,GAA8BD,EAAG,OAAQA,CAAuEqC,YAAI,QAAoBnC,GAAK,OAAC,qB,MAAC,CAAhC,SAA+E,MAAC,gBAAC,MAAOF,EAAIiL,8BAA9G,MAAnjB,CAA6tB/K,MAAM,6BAAC,kBAAc8J,GAA+B,OAAUhK,EAAIgK,QAAQkB,qBAAkBC,IAAyB,2CAAyB,EAAC,Q,MAAC,C,MAAiCnL,UAAsB,UAAEM,IAAOzB,MAAOmB,SAAYkL,GAA2B3K,OAAQ,EAAC,wBAAe,Y,CAA0DC,SAAU,GAAC,iGAA5I,wBAzB5xC,MAyBk9C,CAAkB6B,MAAI,UAAL,yB,GAA6B,CAAsC,OAAW,cAAqC,IAAC,yC,MAAC,C,QAAiCrC,EAAItE,QAAJ,kBAAP,KAA8B,QAAzD,oCAA0D,UAASsE,EAAnE,mBAA8GE,IAAO,gBAAkBF,GAAoB,gBAAuB0J,K,MAA6B,CAAwC,gBAAkB1J,kBAAIoL,QAAgB,SAASpL,SAAIqL,GAAa,OAAS,UAASjJ,kBAAO,cAAwB,WAA1J,uCAA6K,mBAAUkJ,C,IAAoB,iB,MAAkB,CAAkB,QAAU,EAACP,QAA1P,gBAAoQ,MAAO/K,EAAIuL,MAA/Q,8BAzB31D,OAyB8pE,SAAU,GAAI,OAAC,aAzBpwE,uBA2BI7K,uBAAJ,CAEA,MAASC,C,wbC7B6P,W,IAAW9B,EAAK,K,EAChR2M,EAAM,MAAMxL,G,OAEZyL,EAAI,OAAQzL,C,YACR,W,MAA4B8E,C,MAA4B,Q,WAAlD,QAAA9E,EAAA,sBAAAA,EAAA,UAJwQ,WAAvC,KAAD,CAAZ,UAKF0L,WAAW/B,EAA2BgC,YAAoBC,KAAM,QAAzD,QALL,UAK+E1L,MAAM,CAAC,KAAO,6BAL7F,oCAKoG,6BAAC,OAAW,EAAC2L,gBAAb,mBAAkC,SAAsF/L,WAAY,gNAAkFI,MAAM,wBAAC,SAAD,SAAW,eAAlB,GAA0CE,MAAG,CAAC,S,GAA4D,CAA7D,yBAAkImF,UAAY,+B,YAAC,QAAd,WAAkCrF,YAAM,W,CAAC,OAAQ,GAAT,8C,MAAY,CAAU,KAAO,GAAS,QAAQF,EAAI8L,QAAM1L,GAAG,CAAC,MAAQJ,SAAI+L,GAAb,oC,CAA4C,SAAO,0CAAR,YAAP,CAAqB,YAAC,Q,MAA0B,CAAkC,SAA5D,QAAgEhM,KAAG,SAA4DD,MAAW,EAAC,M,GAAe,CAA5B,oBAA2C,SAAQ,C,MAAiB,CAAiC,SAA9G,GAAoH,CAAsIA,MAAW,SAAC,GAAW,SAAO,0BAAsE,UAAU,GAAM,4C,YAAO+J,QAAP,MAAgB,CAAe3J,KAAM,I,GAAe,C,MAAoB,SAAgByJ,GAAnD,8BAAuG7J,UAAW,CAAC,yGAApB,YAAyC,QAAiMI,GAAK,MAAC,C,YAAA,c,CAAW,OAAQ,8BAAnB,OAAP,SAAgC,IAAC,OAAC,iBAAiBkC,C,MAAY4J,CACruDhM,UAAIiM,EAAqB,kBAD8qD,0BACxpD,MAAE,mBAAQ,SAAT,yBAAc,CAACjM,EAAIC,GAAG,cAAvC,SAAoE,KAAMD,EAAIC,GAAG,KAAID,WAAJ,CAAWA,EAAO,iBAAlB,SAA0CA,EAAIkM,eAAiBC,EAAtE,GAAgFpM,EAAG,GAAD,YAAc,KAAQgD,EAAG/C,GAAI4E,EAAG,iBADmwC,SAC7uCsH,cAAiBzC,CAAoBvJ,MAAM,CAAC,KAAOF,GAAgC,UAApD,GAAyEA,CAAiMF,MAAW,SAAZ,GAAwB,wDAAC,gBAAiBsC,KAAlB,WAA/B,MAAiG,CAAOlC,MAAM,K,CAAqB,KAAM,yLAA3B,MAAP,CAAwC,KAAC,8BAAC,OAAO,W,CAClnB,2KAD0mB,oBAAnD,GAD4iB,CAEjjCA,MAAM,YAAC,eAAgBgM,eAAxB,UAAiG9L,MAAG,CAAC,MAAO,U,IAAiB,I,GAAkC,CAA3D,iBAA0FJ,EAA9N,OAA2OD,MAAG,OAAW,uFAAyBO,MAAM,CAACzB,UAAWuN,mBAAY7L,KAAQ,EAAC,Y,aAAgBP,EAAeyC,c,GAAKjC,CAArE,iBAAkG,OAAC,EAAQ,iBAAqBN,OAAM,oBAAU,QAAV,a,MAAqB,CAAU,WAA/B,UAA3B,CAAiF,MAAC,aAAC,SAAQ,SAASkC,GAAQpC,EAAIoM,WAAa,GAA3C,0BAAsG/J,GAAI,QAAQkD,YAAY,Q,MAAC,CAA1B,OAA0CrF,MAAM,GAAC,KAAMF,GAAc,IAAM,GAA3B,UAAoDE,IAAO,MAAQ,YAAhB,mB,CAAyDK,SAAS,sBAAe,Y,IAACP,Q,YAAnD,CAAyEQ,cAApH,MAAoJ,CAAmGN,IAAM,YAAC,WAAa,GAAC,U,MAAC,C,MAA6B+L,SAA9B,OAAuDlM,MAAG,EAAD,aAA0FG,SAAM,YAAC,eAAM,G,WAAiC,iBAA/C,8EAAwDI,MAAM,CAACzB,KAAOmB,I,GAAyDA,CAAiD,MAAlH,YAAmHQ,gBAAW,KAAiDN,GAAK,OAAC,kE,MAAC,C,IACt2C,CACJjE,KAAM+D,EAAI4E,GAAG,WAFm2C,a,MAGn2C,CAAiCrE,QAAS,eAAe,Y,SAAC,SAAayL,GAA7E,qFAA4K9L,EAAK,aAAC,C,MAAC,C,IAAY,CAAwBjE,KAAM,oBAApC,6B,MAA0D,CAA4BsE,QAAS,eAAe,W,SAAC,SAAayL,GAAxE,mFAAqL9L,EAAK,aAAC,C,MAAC,CAAR,KAA8B,wBAAC,cAV3d,O,6BAYIQ,kBAAJ,GAEA,EAASC,KAAQD,iBAAjB,Y,qLCdwH,GAA4C2L,W,IAAiBtG,EAAQ,KAAE,UAAY/F,GAAvB,MAAgD,CAAC,OAAKA,OAAO,QAAQ+C,SAAOuJ,EAAX,WAA4B,QAAQ,CAACxM,YAAY,kBAAaI,GAAK,QAAC,O,SAAC,CAAoC,UAAWqM,KAAhD,cAAkE,MAAQ,yCAA1E,YAAhC,aAA8GnM,MAAG,CAAC,MAAQ,UAASgC,SAAO,G,KAAKoK,EAAJ,Q,cACha1B,IADsY,IAClX/K,MAAG,SAAS,GAACG,EAAM,0B,CAA+H,SAAQ,CAAT,OAAcF,MAAW,K,CAE7Hb,EAAG,GAAC2F,eAAL,wE,MAAchF,CAAmByF,W,EAAjC,mF,OAAwE,EAAC,Q,IAAC,MAAD,mBAAnF,YAAgH,CAAUrF,SAAM,U,MAAuB,CAAyB,MAAMF,EAAIyM,aAA1L,GAAT,SAAiO,MAF3L,CAEuN3M,QAAY,UAAmB,OAAO,cAACA,IAAW,EAAC,sBAAmCA,MAAqBC,IAAG,GAAD,EAAQ,gBAACD,YAAY,gBAAY,CAACE,EAAG,MAAO,CAA2DF,YAAY,uBAAS,CAACC,EAAG,OAAI,CAACD,YAAY,QAA+BI,GAAK,OAAC,C,YAAU,Y,CAAS,OAAQF,GAAI2K,iBAAJ3K,EAA4B,qBAAoBA,EAAI2K,OAAJ,CAA3E,qBAA8H,CAAC3K,EAAG,IAAIA,CAA4EF,YAAY,+BAAoBI,MAAM,CAAC,OAAOF,SAAyB,QAAS,UAA1C,uJAAhD,YAAkH,oBAA+CF,OAAwCI,KAAM,uBAAC,OAAO,SAA8D,UAAoB,CAACF,EAAG,OAAO,CAAC+C,EAAG/C,GAAI2K,cAAUlB,IAArB,GAAltB,EAAsvB1J,IAAE,CAAMD,YAAY,4BAAlB,MAAkCG,CAAuD,KAASvE,sBAAqB,gCAACyD,OAAOa,W,CAAsFE,KAAM,uC,YAAOxE,W,GAAI,KAAO,KAAMsE,SAAI0M,aAAsB,Y,MACj3C3D,CAAQrN,OAARqN,EAAQ,EAAU,IAAV,C,IACP,GACCrN,EAAIiR,UAAM,OACN3M,KAAI4M,YACJ5M,I,MALyzC,8B,MAM9zC,CAN8zC,MAMzyCA,KAAOA,IAAOtE,EAAd,sBAAiC,CAAI,OAAJ,+CAASwE,EAAM,kEAAf,kB,CAA+B,OAAQ,SAASkC,EAAO,Q,IAACpC,E,MAAyB,CAAnD,SAN4O,GAAvC,CAHtS,kB,yECgFe,IACflC,mBACAqD,OACA,YACA,kBACA,aACA,cACA,YACA,WAEAxI,WACAkU,mBAEArJ,UACA6I,UACA,mCAEAC,UACA,+DAEAC,UACA,uCAEAO,OACA,uDAEA,OADA,8DACA,GAEAjJ,OACA,oCAGAzC,SACA2L,gBACApN,gBAEA8M,kBACA,iCAEAD,MACA9K,4BAEAkL,SACA,6BAEAI,aACA,yBACA,UACAtR,yBACA,WACAA,wBACA,WAEAgR,mDACAO,qBCtIqV,MCQjV,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,qBCnByI5K,GAAI,W,IAAcvC,OAA2BI,EAAM,W,OAAoC,OAAU,S,YAC5O,W,GACPgN,eAFmP,kB,IAGnPxB,c,YACS,e,MACPE,C,IAFK,yBAH4O,SAA9C,SAOlM7L,UAAS,EAACwF,MAAW,CAAE,MAAQ,OAAO,oBAA0B,SAA9D,YAAmG,CAACmG,MAAO,OAC9GE,aAAQ,U,GAERD,CAH8G,sBAItFtJ,GAAI,OAAiBnC,MAAM,CAAC,OAAMF,QAA6B,MAAM,OAAtE,oB,CAA4F,OAAU,EAACmN,OAAZ,qBAA/G,MAA4IlI,CAAmBnF,MAAY,uBAAyBC,IAAG,kB,GAAgB,CAAD,oBAA8BG,EAAM,kB,YAAQ,wBAAR,WAAhB,MAAkC,CAAgBA,MAAM,Q,CAAY,UAAZ,MAAP,CAAwC,KAAC,M,CAA4B,UAAWkN,CAAvC,MAAzC,CAA6F9M,OAAM,EAACzB,gBAAWwO,G,GAAwCrN,CAAsB,SAA1E,cAA2EQ,OAAW,aAA5M,MAAoOR,CAAsBF,QAAY,cAAmBI,SAAM,YAAC,gBAAO,GAAQH,WAAW,oBAA4B,KAAOC,KAASsN,SAAhB,CAA8CxN,YAAY,mBAApB,MAAgC,CAAYyF,YAAD,WAAwCrF,YAAM,a,CAAoB,iBAAnB,cAAD,S,YAAoC,Q,CAAkB,W,YAAtD,CAAsF,QAAO,gBAAME,MAAG,CAAC,mBAAiBgC,Q,MAAepC,kB,kBAAoB,G,MAAuBoC,G,KAAlD,MAA1B,GAApJ,CAA4O9B,MAAM,YAACzB,OAAOmB,EAAI8E,MAAKwI,SAAjB,CAAyB/M,KAAS,OAAgBP,IAAIuJ,MAAvT,MAAqX,CAAQzJ,QAAY,YAA+BE,SAAO,SAAWA,GAAgH,EAAOD,KAAG,EAAD,KAAS,aAAeD,WAAW,iB,EAAqB,OAAO,C,YAAW,8B,GAAG,OAAO,EAAME,GAAI0M,sBAAsB,mE,OACj0C,EAAE1M,OAAIiN,C,kBAILtC,a,MACC,CAN+zC,KAA7D,GAOpwC,SAPowC,kCAO7uC,EAAC,QAAU3K,EAAIC,WAAU6B,YAP6pC,EAAT,iBAO3nC,UAAQ,OAAO,8BAAsB,OAAS,WAAtC,uCAAqE,EAAC,Q,MAAC,C,KAAyB,GAAmC,SAA7D,gBAAiE/B,eAAaC,KAAuFE,IAAO,eAAgByK,GAAU,SAAY,wBAlB1X,gE,+BAoBIjK,OAEJ,UAAiBA,Y,qFCtB2C,GAAU,W,IAAOZ,OAAsBC,EAAG,QAAQ,G,OAAiB,SAAcD,YAAY,SAAgB4L,GAAK,QAAM6B,CAAqBrN,IAAK,EAAC,I,IAAC,c,YAAiB,gB,MAAgC,UAAeqN,OAAQL,G,MAAS,CAA4B,eAAqB,mBAAmB,SAAQ,mBAAuB,SAAU,4BAAhS,mBAAoUnH,mBAAS,QAAC,uBAAoByH,UAAlW,oC,SAAoXxN,CAAoB,QAAUA,QAAIyN,O,GAA4CzN,CAAoB,KAA1G,kBAA2G,UAAc,mBAAmB,eAAgB0N,GAA5J,cAAwLxN,SAAM,oBAAC,UAAU3D,gBAA9jB,CAAH,EAA4kByD,SAAIuN,CAA4BzN,OAAyBC,IAAG,EAAD,SAAiB,UAAO,SAIjwB,OAJiwB,SAAR,YAAP,YAAmBK,CAAE,EAAC,Q,MAAC,CAAD,SAAyCK,IAAa3C,MAAK,EAAN,c,CAA8Be,SAAQmB,C,WAAuB,EAA9D,YAA8EA,QAAO,SAA2BS,OAAU,EAAE,QAAC3C,WAAD,c,CAA8Be,KAAOmB,cAArC,U,WAA4D,EAA7D,YAA4EA,QAAO,SAAgCF,QAAY,QAAQiG,WAAS,aAA9B,qCAA4D3F,YAAG,Q,SAAC,C,MAA8BuN,mBAA/B,IAA6F5N,OAAG,SAAS,GAACgG,EAAQ,aAAC,qCAAe,CAAC/F,EAAG,SAAH,CAA8B+F,SAAS,CAAC,MAAQ,KAAI,CAAC/F,EAAIC,GAAG,UAAUF,EAAG,SAAS,CAACgG,SAAS,CAAC,MAAQ,IAAI,CAAC/F,EAAIC,GAAG,UAAUF,EAAG,SAAS,CAACgG,SAAS,CAAC,MAAQ,IAAI,CAAC/F,EAAIC,GAAG,UAAUF,EAAG,SAAS,CAACgG,SAAS,CAAC,MAAQ,IAAI,CAAC/F,EAAIC,GAAG,UAAhuB,EAA4uBF,SAAU,CAACsC,SAAI,CAAatC,MAAG,IAAyBD,kBAAY,SAA1B,CAA2CI,IAAK,aAAE,UAAU0N,C,IAAY,S,YAAgB5N,iB,MAAgB,CAAkB,MAAzE,YAAmF,MAAW,MAAQ,cAAvJ,kBAAkK,KAAC,GAAC,S,MAAiC6N,SAAlC,IAA2D9N,OAAE,SAAS,GAACG,EAAM,qBAAc,EAAC,Q,MAAC,CAAD,SAA3vD,I,qBAIA,GAASS,OAAT,CAAiBD,0BAAjB,U,MCyDe,IACf5C,mBACAqD,wBACAxI,OACA,OACA4S,WACAqC,MACAC,cACAF,iBAGAvM,SACA0M,mBACA,sBAEAL,sBACA,gBACA,iBACA,wCAEAC,eACA,WACA,8BACA3S,kBACA,oCACA,mCACAgT,GAEA,UACA,wBAEA,yBAGAC,qBACAjT,8BAEAkT,cACA,6BACA,gBAEAC,oBACA,cACA,uBAEAC,KACA,kBACA,WAEA,OADAA,MACA,2BACA,mBAEAC,aACA,6BAEAC,aACA,gBACA,cACA,QACA,wBACA,MACA,QACA,wBACA,MACA,QACA,uCACA,SAIA5M,UACA,aACA6M,iBACA,yBACAC,iBACA,yDACA,IACAC,kCACArL,qBACA,oCACAoL,kBACA5O,sDAEAwD,iCAEA,MAEAsE,UACA9H,mDAEA8O,gBACA9O,uDCxJqV,MCQjV,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCsFA,IACf7B,qBACA8C,YACA8N,eACAC,gBAEAxN,0CACAxI,OACA,OACA0U,kBAGAnJ,OACAY,QACA,+CAGAtB,UACAoL,iBACA,iDAGAxN,SACAwL,SACA,4CAEAiC,YACA,gBACA,QACA,qCACA,SAEA,MACA,qDACA,IAGApC,kBACA,iCAEAqC,kBACA,iCAEA3B,aACA,iBACA4B,qBACAC,oBACAC,iCACA,MACA,QACAC,IACAC,KACApQ,KACAqQ,IACAC,IACAC,WAEA,iCAEA,OADAvQ,kCACA,GACA,gBACAwQ,IACAL,MACAE,IACAC,UACA,MACA,iBACAH,IACAK,MACAH,UACAC,IACA,MAEAF,sBACA,CACA,0BACA,WACA,eACApQ,gCACA,MACA,QACAA,+BAEA,UACA,gBACAmQ,IACAK,MACA,MACA,iBACAA,IACAL,MACA,MAEAC,0CAEA/V,uBACAwS,cACAlG,aACAyJ,YACA,8BACAK,WACAhE,YACAiE,oBACAC,mBAGAC,cACA,sCACAjO,+DACA,gBAAApF,mCACA,qBAEA8Q,cACA,kCACA,sBAEAwC,cACA,iCACA,sBAEAlD,mDACAO,qBClOuV,MCSnV,I,oBAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QC6IA,IACfnP,gBACA8C,YACAiP,mBACAnB,eACAoB,kBAEAnX,OACA,OACAoX,QACAjE,OACAkE,aACA5D,cACAH,gBACAD,gBACAiE,cACAC,iBACAC,UAEAC,sBACArG,4BACAsG,wBACAC,kBACAC,aAEAC,gBACAC,qBACAC,WACAC,sBAGAxP,OACAwI,WACA1G,gBAEA2N,YACA3N,gBAEA2H,aACA3H,WAEApE,OACAoE,YAEA4N,cACA5N,aAGAO,UACAsN,gBACA,2BAEA5E,mBACA,wDACA,yDAEA6E,cACA,2DAEAC,mBACA,8BACA,wBACA,yBAEAC,0BACA,OACA,uBACA,8BACA,oCAEA,6BAEA,uBACA,8BACA,mCACA,mDAEA,wBACA,KAGAxC,gBACA9O,yDAEA8H,UACA9H,sDAEA8B,UAEA,GADA,kBACA,gBACA,sCACA,8BACAyP,+BACA,0BACA,aACA,sDACA,2BAGA,uBAEAhN,OACArF,SACA,GACA,sCACA,kBACA,uBAEA,8DAGA+R,aACA,yBACA,8CACA,4BACA,iEAIAxP,SACAyK,kBACA,6BACA,+BACA,yDACA,0BAEA9Q,qBAEAoW,iBACA,sCACA,+BACAC,QACAA,qBACAC,yCAEA,kCAEA,mCACA3P,OACAnI,KAAA,aACA+X,MACA,IACA5P,eACA,kBACA,CAAA6P,sBACA,CAAA9H,QAAAsG,eAAAjE,kBAEA/B,uCAEAhN,KAAApE,IACA,iCACA,kBACA,yBACA,CACA8Q,QACAsG,eACAjE,gBAEA0F,YACAlF,WACAzC,YAOA,MACA,uBACA,CAAAkG,eAAAjE,gBACA,6BACA,2CACA,8BACA,YACA2F,QACAA,cACA,2BAGA,mBAGAlG,WACA,6BACA,6BACA,oCACA,mCACA,yBAEAmG,kBACA,0DAEA,wBAEA,UACA,2DACA,OACA,sDACAC,sBACA,yBAGA,QACA,UACA,YACA,gBACAC,KACA,MACA,WACA,iBACAA,IACA,MACA,qBACAA,qBACA,MACA,sBACAA,sDACA,MACA,eACAA,gBACA,MACA,QACApW,kEACA,MACA,YACA,eACA,MACA,QACA,sDACA,aACA,MAGA,eACA,2BAEA,YAGA,2BACA,+CAEA,wBACA,kBACA,sDACA,kBAEA,2BACA,8BACA,wCAEA,yBAEA,8BACA,+BAEA,uBAGA,uBACA,WACA,uBACA,sBACA,MACA,cAEA,GACA,8BACA,sBACA,sDACA,CACA,mBACA,MAEA,yB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A,oBAEA,IAEAG,YACA,WACA,SACA,2CAEA,0BCzGgW,MCQ5V,I,WAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCoXA,IACflV,mBACAqD,OACAgS,SAEAvS,YACAiP,mBACAuD,YACA1E,eACA2E,sBACAC,iBACAC,2BAEA5a,OACA,OACAyQ,QACA0C,OACAjN,SACA2U,WACAC,iBACA5C,gBACA6C,UACAhK,gCACAjL,SACA,aAEAkV,WACArX,OACA,uBAIA0N,SACA4J,UACA9L,WACAxL,WAEA4N,MACApC,WACAxL,UACAuO,cAEAF,WACA7C,WACA8C,cACA9F,SAEAmF,MACAnC,WACAxL,WAEAyO,WACAjD,WACA+L,cACAC,YACAC,oBAEA7I,mBACApD,WACAkM,QACA7I,YAEA8I,SACAnM,WACAjG,aAIAqS,aACAC,iBACApC,kBACAqC,gBACAC,cAGAnQ,OACA4H,QACA,mBAEA,wCACA,8CACA,yFACAnM,kCAIA6D,UACAkH,QACA,SACA,iCACA,uBACA,IACA,YACAvK,YACAA,+BAEAxF,UAEA,UAEA0P,eACA,UACA,eACA,WACAxK,MAAA,gCACAA,MAAA,EAAA6B,2BAGA4S,SACA,6CAEAC,UACA,cACA,+BACA,wBAEA,8BAGA9S,UACA,aAEAC,0CAEA,aADA/I,WACA,EACA,0CACAkL,oBACAhF,eAIA6C,oCACA/I,GACA,oDACAkL,YACAhF,qBAIA6C,OACAnI,KAAA,mBACAwD,KAAApE,gCAEA8O,UACA9H,sDAEA8O,gBACA9O,yDAEAyB,SACAoT,WACA,OACA,iEAGAhL,YACA,wDAEAiL,SACA,sBACA,gDACA,IACA,kBACA3I,GACA,mBAEA4I,uBACAC,eAGA,cAEAC,UACA,UACA,uDACA,yBACA,gBACAC,oCATA,QAgBAxD,kBACA,GACA,GACA3P,6BACAtI,yDACA0S,mBAIA,6BACAnM,eAAA6P,sCACA,iBA8CAsF,qBACA,4BA9CA,gBACA,mBACAR,mBACAS,gCACAxU,aACA,0BAGA,GAFA,mBAEA,+BAEA,6CAEA,YADA,4BAIA,kBACA,oDACA,sBACAnH,iBAAAkQ,eAGA,iCACA,MACA,SAGA,aAFA,eACA,cACA,IACA,kCACA,sBAGA,eACA,aAGAwL,qBACA,0BAGA,mDAEA,2BAQAE,mBACA,cAEAvK,mBACA,iCACA,KACA,eAAAwK,SAAAxL,WAEAK,aACA,kCACA,qCACA,wBAEAyB,UACA,qCACA,kBACA,+DAEA2J,kBACA,4DAEA,IAAI,EACJ,EADA,IAKA,OAHA,6DACAC,+FAEA,qBACA,gBACA,4DACA,MACA,iBACA,4DACA,MACA,QACA,wBACA,MACA,QACA,gCACA,MACA,QACApa,8CACA,MACA,QACA,QACA,2BACA,MACA,QACA,8CACA,MACA,QACA,QACA,aACA,4DACA,oBACA,oBAEA,MACA,QACA,QACA,aACA,kCACA,uBACA,MACA,QACA,cACA,gBACA,8BACA,uCACA,MACA,QACA,4DACA,qBACA,oBAEA,MACA,QACA,QACA,QACA,QACA,+BACA,wCACA,oCACA,4BACA,QACA,gCACA,MACA,QACA,oBACA,mBACA4N,aACAjH,wBACA0T,4CACA,IAEArM,gBAEA,MACA,QACA,kBACA,WAEA,8BACAsM,aAAAD,cACAE,QAAA,qBAHA,2CAKA,MACA,QACA,qDACA,uDACA,OAGA,MACA,QACA,QACA,QACA,QACA,QAEA,4BACA,QACAC,KACA,MACA,QACAA,IACA,MACA,QACAA,KACA,MACA,QACAA,IACA,MACA,QACAA,IACA,MAEA,wBACAA,mEACA,uBACA,uBAEA,gDACAC,oEACA7V,8CACA,oBACA,MACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,uCACA,oCACA,6CACA,MACA,QACA,8CACAiE,qBAEA,UACA,mBACA6R,WACA9M,mFACA+M,mCACA/K,gDAIA,MAGA,8CAEAgL,OACAjU,OACAnI,KACA,eACA,yDACA,+BACA,0BAEAwD,KAAA,KACA,8BACA2E,eAAA6E,4BAGAwE,aACA,kCACA,IACA,kCACA,wCAGA8D,YACA,gBACA,QACA,qCACA,SAEA,MACA,qDACA,IAGA5D,aACAvJ,OACAnI,KAAA,aACAua,UACA,CACA,iBACA,CACAxH,uBACA,kCACAlT,oBAAAwc,8BAKA,4CAGA7Y,KAAApE,IACAoC,YACAf,gBACAsa,SACAlL,sBACAoK,gCAIAzG,gBACA,6DACApN,gBAEAkW,gBACA,eACA,oBAEArJ,OACA9K,eAEA6K,WACA,0BAEAK,mBACAkJ,sBACA,sCACA,yBACAlS,qDAGA,qBAGAmS,iBACA,sCACA,CACA3c,mDACA4c,kDAIA,kCACA,OACAC,SACAlb,iBACA,uCACA,KAGA,KAIAmb,eACA,iDAGA7M,wBACA,SACA,wCACA7N,0CACA,oCACA2a,gCACA,qBACA,mDACA5b,kCAGAA,MAIA,aADA,oBACA,GACA,4BACA,yCACA,mDAGA,4CAEA6P,iBACA,uBACAgM,4BACA,iBACA,4CAEAC,mBACA,qDACA,8DACA,4CAEAjL,mBACA,8CACA7Q,cACAqJ,cACA,qDAEA,4CAEA0H,sBACA,wCACA,cACA,mEAEA,gDAGAgL,cACA,iCACA,aACA5U,OACAnI,KACA,yDACA,CACAgd,wBACAjE,SACAkE,OAAAhF,cAGAzU,KAAApE,IACA,wBACA4B,cACA5B,wDAIA+C,YACA,iCACA,gBAEA,cACA,mEAEA,6BACA+a,IACA,GACAnM,wCACA,GACAiM,wBACAC,OAAAhF,YACAkF,OAAAlF,aAEA,+BACAmF,2CACA,8CAEAjV,OACAnI,KACA,yDACAod,GAEA5Z,KAAApE,IACA,wBACA4B,cACA5B,6DAIAie,iCAEA,SACAC,KAmBA,OAjBA,kCACA,oBACAC,sBACAA,gCAGAvc,cACA,wBACAsc,gBACA,EACA,KACA,+BACA,oCACAlc,0BAIA,CACAmc,cAAAD,wBAIAxL,eACA,iCACA,wCACA3J,OACAnI,KAAA,oBACAud,4BAEA/Z,KAAA,KACAxC,cACAqJ,yBACA3K,oDAGA,2BAGAqU,UACA,iCACA,sBACAlK,GACAwO,MACAmF,iBAGA3T,kDACAQ,UAEA,sBACA,mCACAlC,2CACA/I,eACA,wBACA4B,aACAI,iBACA1B,GACA,wDAMAsB,0BACA,0BAGAyc,SACA,iCACA,gBACA,OACAT,wBACAU,WAEA,oIACA,oEACArP,2DAEAlG,OACAnI,KAAA,yDAAAqO,GACA7K,KAAApE,IACA,wBACA4B,UACAI,GACAA,sBACAmH,OAAA8B,qCACAiE,OAAAlP,6BAIAue,QACA,iCACA,wCACA,aACAxV,OACAnI,KAAA,0DACAqX,2BAEA7T,KAAA,8BAEA2G,QACA,iCACA,wCACA,aACAhC,OACAnI,KAAA,0DACAqX,2BAEA7T,KAAA,8BAEAoa,gBACA,iCACAzV,OACAnI,KAAA,2BACAgd,0CAEAxZ,KAAA,8BAEAqa,uBACA,sCAEA1K,mDACAO,qBC3nCqV,MCSjV,I,oBAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCoEA,IACfnP,kBACA8C,YAAAyW,eAAAxH,oBACAlX,OACA,OACA2e,YACAzO,qBACA0O,iBACAC,6BACA7O,KACAI,cACAH,QACA6O,YACAC,OACAC,qBACAC,mBACA3O,aACA4O,qCACAC,8BAGArW,UACA,oBACA,0CACA,2BACA,iCAEA,gDAEA,aADA,kEACA,uBACA,qBACA,6DAEAC,yCACA,0BACA,iCACA,uBACAqW,6CACA,2BAGA3W,SACA4W,eACA,iCACAC,8BAEAP,KAEA,eACA,QACA5V,OAAA8B,cACAD,IAAAC,wCACAsU,IACApW,OAAA8B,aACAD,IAAAC,KACAmM,iCACAoI,0BAEAC,KACAC,KACA,0CACA,sCAGA,aACAD,0EAEA,aACAC,IACA1U,IAAA2U,uDACA9T,KAAA,MAEAkT,EACA,IACA,MACA5V,OAAA8B,eACAY,KAAA,KACA,IAMA,MAHA,qCACAkT,4BAEA,GAEA5O,UACA,wBAEA,mCACA,mDAEA,8BAEA,OACAuI,kBACA,GACA,GACA3P,6BACAtI,yDACAuP,SACAE,yCACAD,eACAG,mBACAyO,6DAKA,2CAEAtO,eACA,yCAEA,sBACAnO,YACAf,gCACAe,SACAA,kBAEAuZ,gBACAlL,gCACAoK,eAIA,oBAEA,8BACA,sDADA,CAKA,gDAEA,0CAEA,OACA7K,+BACA+O,aACA9O,2DACA2P,gDACAjE,gBACAS,cACAhM,OACA,6DAGA,+CACArH,8B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AS,EAAC,MAAOD,G,OAA2BD,QAAY,SAA9B,CAA2CI,IAAK,a,YAAO,aAAN,OAAsBH,GAAG,gBAA4BwF,QAAW,C,IAAE,iBAAD,aAAqBxF,QAAS,UAAyBA,EAAG,MAAD,CAAUG,YAAM,W,CAAC,SAAQ,CAAT,MAAP,CAA6B,MAAC,eAAqBF,MAAOA,EAAA,OAAyDI,CAAE,EAAC,mC,YAAS,O,GAAiB,CAA2B,kBAArD,4B,qECcjX,IACftC,wBACAqD,mCACAxI,OACA,OACA6gB,eACAC,iBAGAhY,UACA,uBACA,GACA,gBACA,WACA,mBACA,sBAJA,CAQA,OACAiY,eACAC,6BAEAla,uBAEA,oDACA,uBACA,oCACA,yBACAA,eACAma,0CACAC,mBACA,MAEAzY,SACA0Y,cACA,4BACA,mCACA,4CACA,GAEAC,eACA,OACAC,uBACAC,aAQA,aALAN,iBACAK,gBACAlc,YACAmc,cAEA,gBACAN,iBACAK,gBACAlc,OACAoc,WACAD,cAEA,uCACA,oBACA,gBACA,WACA,GACAE,uBACAC,mBACAF,WACAG,+BAEA,2BACA,iCACA,gBACAzY,oCACA0Y,gDACA1Y,cACA,oBACA0Y,iBACA1Y,qBACA,CACA3F,sBACA6B,YACAyP,eACA7J,MAAA,KACAC,IAAAC,wCAEA,iCACA,CACA3H,oBACA6B,aAEA,eACA,CACA7B,sBACA6B,aAEA,eACA,CACA7B,sBACA6B,YACAyP,2CAEA,mBACA,CACAtR,uBACA6B,aAEA,CACA7B,mBACA6B,cAIA8b,qBACAW,OACA,mBAGAC,QACAR,aACA/d,eAKA0d,iBACAK,gBACAlc,UACAmc,UACA,CAAAD,aAAA/d,aACA,CAAA+d,aAAA/d,uBACA,CAAA+d,aAAA/d,uBAIA,OACA,CACAA,qBACA6B,YACAuc,qBACAI,OACA,CACAxe,mBACA6B,eAGA4c,gBACAR,WACAS,4CAEA,CACA1e,yBACA6B,aACAuc,sBACAI,OACA,CACAxe,mBACA6B,eAGA4c,gBACAR,WACAS,4DAIA,wBACAC,sBACAC,qBACAC,sBACAC,eACAC,aACAC,oBACAC,eACAC,YACAC,gBACAC,eACAC,gBA8CA,OA3CA3B,iBACAK,gBACAlc,UACAmc,UACA,CACAD,aACA/d,sBAEA,CACA+d,aACA/d,wBAEA,CACA+d,aACA/d,yBAEA,UACA,OACA+d,aACA/d,sBACA6B,UACAuc,cACAI,SACAC,gBACAa,WAOA,OALA3B,qBACAW,OACA,mBAGA,CAAAP,aAAA/d,kBAEA,UACA2d,qBACAW,OACA,mBAGA,CAAAP,aAAA/d,kBAIA,GAEAuf,YACA,QAEA,gBACA,QACA,qCACAC,iBACAA,IAGA,WACAC,OACA,sCAEA,GADAC,yBACA,qBAIA,gBACA,WACA/Z,kCACAgC,cACA,GACA,OACAnE,sBACA,SAEA,aACA,SACA,GACA,2CACAmc,gBAEAC,kCACAA,yBACAC,OACA,+BACAD,cACAF,sBACA,iBACAE,sCACAA,yBACA,iBACAF,qBACA,CACA,sCACAI,yBACA,sCACAC,eACA,QACA,+CAEA,sCACAC,8BACAA,cACAD,iBACAD,iBACAJ,kBAIAF,YACAA,MACA,OAhDAhc,kCAmDAyc,mBACA,SAEA,OADAP,8BACA,QACA,kBACA,WACA,qBACA,uBACAA,8CAEA,oBAEA,OADAQ,kDAEA,kDACA,CACAC,OACAC,OACAC,QACAC,OACAC,QACAC,SACAN,GACA,kDAEA,QACA,kCACA,iDACA,kCACA,OACAR,uBACA,IACA,2DACA,IAEA,MAEA,UAEAe,YACA,SACA,SAEA,WACApC,GACAxc,4BACA4d,SAEA,wBACA,kBACA,WACAiB,gBACA,MACA,YACA,YACArC,oDACAsC,eAEA,MACA,gBACAtC,6CACAsC,eAEA,MAGAziB,wBACAwhB,IAEA,UAEAhG,OACA,8CACA,sBAEA,oBACA,mBAEAlW,eAEA,yBC/X0V,MCQtV,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCmGA,IACf3B,kBACA8C,YACAic,iBACAC,oBACAjN,oBAEA1O,aACAxI,OACA,OACAyN,MACAyD,OACA/L,QACAwb,gBACAxF,aAEAsF,WACAG,eACAtY,SACAD,aACA+b,WAGAtb,UACAC,uCACA,qBAEAA,mDA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","file":"js/app.868f68b1.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded CSS chunks\n \tvar installedCssChunks = {\n \t\t\"app\": 0\n \t}\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"js/\" + ({}[chunkId]||chunkId) + \".\" + {\"chunk-0fa28732\":\"39462851\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// mini-css-extract-plugin CSS loading\n \t\tvar cssChunks = {\"chunk-0fa28732\":1};\n \t\tif(installedCssChunks[chunkId]) promises.push(installedCssChunks[chunkId]);\n \t\telse if(installedCssChunks[chunkId] !== 0 && cssChunks[chunkId]) {\n \t\t\tpromises.push(installedCssChunks[chunkId] = new Promise(function(resolve, reject) {\n \t\t\t\tvar href = \"css/\" + ({}[chunkId]||chunkId) + \".\" + {\"chunk-0fa28732\":\"551cd1a5\"}[chunkId] + \".css\";\n \t\t\t\tvar fullhref = __webpack_require__.p + href;\n \t\t\t\tvar existingLinkTags = document.getElementsByTagName(\"link\");\n \t\t\t\tfor(var i = 0; i < existingLinkTags.length; i++) {\n \t\t\t\t\tvar tag = existingLinkTags[i];\n \t\t\t\t\tvar dataHref = tag.getAttribute(\"data-href\") || tag.getAttribute(\"href\");\n \t\t\t\t\tif(tag.rel === \"stylesheet\" && (dataHref === href || dataHref === fullhref)) return resolve();\n \t\t\t\t}\n \t\t\t\tvar existingStyleTags = document.getElementsByTagName(\"style\");\n \t\t\t\tfor(var i = 0; i < existingStyleTags.length; i++) {\n \t\t\t\t\tvar tag = existingStyleTags[i];\n \t\t\t\t\tvar dataHref = tag.getAttribute(\"data-href\");\n \t\t\t\t\tif(dataHref === href || dataHref === fullhref) return resolve();\n \t\t\t\t}\n \t\t\t\tvar linkTag = document.createElement(\"link\");\n \t\t\t\tlinkTag.rel = \"stylesheet\";\n \t\t\t\tlinkTag.type = \"text/css\";\n \t\t\t\tlinkTag.onload = resolve;\n \t\t\t\tlinkTag.onerror = function(event) {\n \t\t\t\t\tvar request = event && event.target && event.target.src || fullhref;\n \t\t\t\t\tvar err = new Error(\"Loading CSS chunk \" + chunkId + \" failed.\\n(\" + request + \")\");\n \t\t\t\t\terr.code = \"CSS_CHUNK_LOAD_FAILED\";\n \t\t\t\t\terr.request = request;\n \t\t\t\t\tdelete installedCssChunks[chunkId]\n \t\t\t\t\tlinkTag.parentNode.removeChild(linkTag)\n \t\t\t\t\treject(err);\n \t\t\t\t};\n \t\t\t\tlinkTag.href = fullhref;\n\n \t\t\t\tvar head = document.getElementsByTagName(\"head\")[0];\n \t\t\t\thead.appendChild(linkTag);\n \t\t\t}).then(function() {\n \t\t\t\tinstalledCssChunks[chunkId] = 0;\n \t\t\t}));\n \t\t}\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"ml-10\"},[_c('v-btn',{staticClass:\"mb-5 mt-5\",on:{\"click\":function($event){return _vm.append_stage()}}},[_c('v-icon',[_vm._v(\"mdi-plus\")])],1),_c('draggable',{attrs:{\"handle\":\".drag-handle\",\"list\":_vm.value}},_vm._l((_vm.value),function(stage,index){return _c('div',{key:index,staticClass:\"stage-opers\"},[_c('StageDetail',{attrs:{\"stages\":_vm.stages,\"map_id\":_vm.map_id + '.' + index},on:{\"validation\":function($event){return _vm.update_valid(_vm.map_id + '.' + index, $event)},\"shortcut\":_vm.update_shortcut},model:{value:(_vm.value[index]),callback:function ($$v) {_vm.$set(_vm.value, index, $$v)},expression:\"value[index]\"}}),_c('div',{staticClass:\"opers\"},[_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.remove_stage(index)}}},[_c('v-icon',[_vm._v(\"mdi-delete\")])],1),_c('v-btn',{directives:[{name:\"show\",rawName:\"v-show\",value:(index > 0),expression:\"index > 0\"}],attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.move_stage(index, -1)}}},[_c('v-icon',[_vm._v(\"mdi-arrow-up\")])],1),_c('v-btn',{directives:[{name:\"show\",rawName:\"v-show\",value:(index < _vm.value.length - 1),expression:\"index < value.length - 1\"}],attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.move_stage(index, 1)}}},[_c('v-icon',[_vm._v(\"mdi-arrow-down\")])],1),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.append_stage(index+1)}}},[_c('v-icon',[_vm._v(\"mdi-plus\")])],1)],1),_c('v-divider',{staticClass:\"mb-5\"})],1)}),0)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"ml-10\">\n    <v-btn @click=\"append_stage()\" class=\"mb-5 mt-5\">\n      <v-icon>mdi-plus</v-icon>\n    </v-btn>\n    <draggable handle=\".drag-handle\" :list=\"value\">\n    <div\n      v-for=\"(stage, index) in value\"\n      :key=\"index\"\n      class=\"stage-opers\">\n      <StageDetail\n        :stages=\"stages\"\n        :map_id=\"map_id + '.' + index\"\n        v-model=\"value[index]\"\n        @validation=\"update_valid(map_id + '.' + index, $event)\"\n        @shortcut=\"update_shortcut\"\n      />\n      <div class=\"opers\">\n        <v-btn icon @click=\"remove_stage(index)\" >\n          <v-icon>mdi-delete</v-icon>\n        </v-btn>\n        <v-btn icon\n          @click=\"move_stage(index, -1)\"\n          v-show=\"index > 0\"\n          \n        >\n          <v-icon>mdi-arrow-up</v-icon>\n        </v-btn>\n        <v-btn\n          @click=\"move_stage(index, 1)\"\n          v-show=\"index < value.length - 1\"\n          icon\n        >\n          <v-icon>mdi-arrow-down</v-icon>\n        </v-btn>\n        <v-btn icon @click=\"append_stage(index+1)\" >\n          <v-icon>mdi-plus</v-icon>\n        </v-btn>\n      </div>\n        <v-divider class=\"mb-5\"></v-divider>\n    </div>\n    </draggable>\n  </div>\n</template>\n\n<script>\nimport api from '../api'\nimport draggable from 'vuedraggable'\n\nexport default {\n  name: \"Pipeline\",\n  components: {\n    StageDetail: () => import('./StageDetail.vue'),\n    draggable\n  },\n  data() {\n    return {\n        stages: {},\n        show_code: false,\n        valid: [],\n        shortcut: {}\n    }\n  },\n  props: [\"value\", \"map_id\"],\n  methods: {\n    update_valid(name, valid) {\n      var l = this.valid.indexOf(name);\n      if (l >= 0) this.valid.splice(l, 1);\n      if (!valid) this.valid.push(name);\n      this.$emit(\"validation\", this.valid.length == 0)\n    },\n    update_shortcut(shortcut_name, arg_description) {\n      this.$emit(\"shortcut\", shortcut_name, arg_description)\n    },\n    append_stage(index) {\n      if (typeof index === 'undefined')\n        this.value.push([\"Passthrough\", {}]);\n      else\n        this.value.splice(index, 0, [\"Passthrough\", {}])\n    },\n    remove_stage(current) {\n        this.value.splice(current, 1);\n    },\n    move_stage(current, inc) {\n        var st = this.value[current];\n        this.value.splice(current, 1);\n        this.value.splice(current + inc, 0, st);\n    }\n  },\n  mounted () {\n    api.help_pipelines().then((data) => {\n      this.stages = data;\n    });\n    if (!Array.isArray(this.value))\n        this.$emit(\"input\", []);\n  }\n};\n</script>\n\n<style scoped>\n.opers {\n  visibility: hidden;\n}\n\n.stage-opers:hover .opers {\n  visibility: visible;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pipeline.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pipeline.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Pipeline.vue?vue&type=template&id=ccaf75ca&scoped=true&\"\nimport script from \"./Pipeline.vue?vue&type=script&lang=js&\"\nexport * from \"./Pipeline.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Pipeline.vue?vue&type=style&index=0&id=ccaf75ca&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ccaf75ca\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QuickActionButtons.vue?vue&type=style&index=0&id=0bda02b7&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageBrowsing.vue?vue&type=style&index=0&id=7462d287&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueueView.vue?vue&type=style&index=0&id=25525aa2&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaggingShortcutsDialog.vue?vue&type=style&index=0&id=736d6737&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=00694030&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageView.vue?vue&type=style&index=0&id=a5c961f0&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DbConsole.vue?vue&type=style&index=0&id=59c088dc&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskList.vue?vue&type=style&index=0&id=1d2bdd0c&prod&scoped=true&lang=css&\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV4AAACWBAMAAABkyf1EAAAAG1BMVEXMzMyWlpbFxcW+vr6xsbGcnJyjo6Oqqqq3t7cKhryjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADFUlEQVR4nO2YvW/TUBTF/ZXEY25bp4xJoWLFCFHGmIEZLxVjLFSpY9yKPVkq/mzuV2InQrDZr9L5Le/KjqrT6/vOve9FEQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMCIrOjSo4yKkzcxzYeX81+mdHWMrk/ehKm3y6pkuq8xTL0p0dKiPesLX29U086CljavQW9LWwtE+CvQu6fvuibHwnAC1RvTha75mZ2FqndKb3SdHY3NCVRvRgtdJ8fGEUXvHoon15u81Pdf/fHdQ/E8vMAzuG51XYk805gTs7Z4z2Gx01+8l8dPowk9UNMHWSrxCdNYibArjTMJrWKSWsJiOaZWoaW1LI34sGpMVSOVElcWL/kHtxZuRpSqlCZBRaneCdHzzWdqOOZi+bH8UqtFt7T4+LY535XDYzWQ6raLLaey8zizc5+BbsXyWPpWXOTMpYdnqvIyTZzqrbVApqJ3pc0klXcz85Hm0A5HI9ccmmrRm1rjSEVvZXuxWcgr9bvS2+F4JKovVh2iN/M5uOa4sZ63p2Pf7tv0SDRSkqV+Z9E784ZXcezSS/5FZTaSjb/hKnGyVsdK0XvIIM/DiYuL+WVjc2fu7XBENLW1djnTe+GP5+7E0u0ObSU5H4uGZ8KVmVjaYj1jmF5u0PmJ3qU8DUDvjAXmVrRx70x0oncb+ZhxXMcj5yqdWVL7+Y37ejcB6ZVamJhb9es3lvrtzCCceuCtzx9/LVGsPdj8YSV6uyuJcPabdLG9qen7byl+1plXOH4myW2sKq2/WRHIfYQnM/8dUr/git34h+/ND5HMk/5vSPbLYPoxV8Cl14DPZ1Ibic07O3ncUm/eGf8UyhntPMEues7myUVA82QknurHHNW70uI4mdcvA5rXI0mabSbTy5oeb16o1lqmn8tP9t9Udh66/tcfGgg+tKudeS+uu/Nma+1N3k4tHHtcF1aHJmB69SS80Hga3nk+EpPyr+x3Oo0UdHcXUVjyA7kv+Qvpr+LRw+Rbfb/z+K4O4D4KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMLlD3CGZGQvx4tTAAAAAElFTkSuQmCC\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pipeline.vue?vue&type=style&index=0&id=ccaf75ca&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageBrowsing.vue?vue&type=style&index=1&id=7462d287&prod&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SystemAdmin.vue?vue&type=style&index=0&id=4a6f3d06&prod&scoped=true&lang=css&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[(_vm.type_choices)?_c('v-autocomplete',_vm._g(_vm._b({attrs:{\"label\":_vm.arg.name,\"value\":_vm.value === null || typeof _vm.value === 'undefined' ? _vm.arg.default : _vm.value,\"items\":_vm.type_choices},on:{\"change\":_vm.inputListeners.input}},'v-autocomplete',_vm.$attrs,false),_vm.inputListeners)):(_vm.arg.type == 'TASK' || _vm.arg.type == 'PIPELINE')?_c('v-autocomplete',_vm._g(_vm._b({attrs:{\"label\":_vm.arg.name,\"value\":_vm.value,\"items\":_vm.choices,\"hint\":(_vm.choices.filter((x) => x.value == _vm.value)[0] || {}).hint,\"persistent-hint\":\"\",\"item-value\":\"value\",\"item-text\":\"text\"},on:{\"change\":_vm.inputListeners.input}},'v-autocomplete',_vm.$attrs,false),_vm.inputListeners)):(_vm.arg.type == 'DATASET')?_c('v-combobox',_vm._g(_vm._b({attrs:{\"items\":_vm.choices,\"label\":_vm.arg.name,\"value\":_vm.value,\"item-value\":\"value\",\"item-text\":\"text\"},on:{\"change\":_vm.inputListeners.input}},'v-combobox',_vm.$attrs,false),_vm.inputListeners)):(_vm.arg.type == 'object')?_c('div',[_vm._l((_vm.keys),function(r,i){return _c('v-row',{key:r.name},[_c('v-col',[_c('v-text-field',{on:{\"input\":_vm.update_object_value},model:{value:(r.name),callback:function ($$v) {_vm.$set(r, \"name\", $$v)},expression:\"r.name\"}})],1),_c('v-col',[_c('v-select',{attrs:{\"items\":['str', 'int', 'float', 'bool']},on:{\"input\":_vm.update_object_value},model:{value:(r.type),callback:function ($$v) {_vm.$set(r, \"type\", $$v)},expression:\"r.type\"}})],1),_c('v-col',[_c('ParamInput',{attrs:{\"arg\":r},on:{\"input\":_vm.update_object_value},model:{value:(_vm.object_value[r.name]),callback:function ($$v) {_vm.$set(_vm.object_value, r.name, $$v)},expression:\"object_value[r.name]\"}})],1),_c('v-col',[_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.keys.splice(i, 1);\n            _vm.update_object_value();}}},[_c('v-icon',[_vm._v(\"mdi-minus\")])],1)],1)],1)}),_c('v-row',[_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.keys.push({ name: '', type: 'str' })}}},[_c('v-icon',[_vm._v(\"mdi-plus\")])],1)],1)],2):(_vm.arg.type == 'bool')?_c('div',[_c('v-simple-checkbox',_vm._g(_vm._b({ref:\"checkbox\",staticClass:\"d-inline-block\",attrs:{\"value\":_vm.value}},'v-simple-checkbox',_vm.$attrs,false),_vm.inputListeners)),_c('label',{on:{\"click\":() => _vm.$refs.checkbox.click()}},[_vm._v(_vm._s(_vm.arg.name))])],1):(_vm.arg.type == 'QUERY')?_c('div',[_c('label',[_vm._v(_vm._s(_vm.arg.name))]),_c('prism-editor',{staticClass:\"my-editor match-braces\",attrs:{\"highlight\":_vm.highlighter,\"line-numbers\":\"\"},on:{\"input\":function($event){return _vm.$emit('input', _vm.code)},\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;if(!$event.ctrlKey)return null;return _vm.$emit('submit')}},model:{value:(_vm.code),callback:function ($$v) {_vm.code=$$v},expression:\"code\"}})],1):(_vm.arg.type == 'str' || _vm.arg.type == 'string')?_c('v-textarea',_vm._g(_vm._b({attrs:{\"value\":_vm.value,\"hint\":_vm.arg.default,\"required\":!_vm.arg.default,\"rows\":(_vm.value || '').includes('\\n') ? 4 : 1,\"cols\":\"40\",\"label\":_vm.arg.name}},'v-textarea',_vm.$attrs,false),_vm.inputListeners)):(_vm.arg.type.startsWith('file'))?_c('div',{staticClass:\"file-drop\",on:{\"drop\":function($event){$event.preventDefault();return _vm.drop_file.apply(null, arguments)},\"dragover\":function($event){$event.preventDefault();},\"click\":function($event){return _vm.$refs.input_file.click()}}},[_vm._v(\" \"+_vm._s(_vm.file_prompt)+\" \"),_c('input',{ref:\"input_file\",attrs:{\"type\":\"file\",\"accept\":_vm.arg.type\n          .substr(5)\n          .split(',')\n          .map((x) => `.${x}`)\n          .join(', ')},on:{\"change\":function($event){return _vm.drop_file({ dataTransfer: { files: $event.target.files } })}}})]):_c('v-text-field',_vm._g(_vm._b({attrs:{\"type\":\"text\",\"value\":_vm.value,\"placeholder\":_vm.arg.default,\"required\":!_vm.arg.default,\"label\":_vm.arg.name}},'v-text-field',_vm.$attrs,false),_vm.inputListeners)),_vm._v(\" \"+_vm._s(_vm.prompt)+\" \")],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <v-autocomplete\r\n      v-if=\"type_choices\"\r\n      :label=\"arg.name\"\r\n      :value=\"\r\n        value === null || typeof value === 'undefined' ? arg.default : value\r\n      \"\r\n      v-bind=\"$attrs\"\r\n      v-on=\"inputListeners\"\r\n      @change=\"inputListeners.input\"\r\n      :items=\"type_choices\"\r\n    >\r\n    </v-autocomplete>\r\n\r\n    <v-autocomplete\r\n      :label=\"arg.name\"\r\n      v-bind=\"$attrs\"\r\n      v-on=\"inputListeners\"\r\n      :value=\"value\"\r\n      @change=\"inputListeners.input\"\r\n      :items=\"choices\"\r\n      :hint=\"(choices.filter((x) => x.value == value)[0] || {}).hint\"\r\n      persistent-hint\r\n      item-value=\"value\"\r\n      item-text=\"text\"\r\n      v-else-if=\"arg.type == 'TASK' || arg.type == 'PIPELINE'\"\r\n    ></v-autocomplete>\r\n\r\n    <v-combobox\r\n      v-else-if=\"arg.type == 'DATASET'\"\r\n      :items=\"choices\"\r\n      :label=\"arg.name\"\r\n      v-bind=\"$attrs\"\r\n      v-on=\"inputListeners\"\r\n      :value=\"value\"\r\n      item-value=\"value\"\r\n      item-text=\"text\"\r\n      @change=\"inputListeners.input\"\r\n    ></v-combobox>\r\n\r\n    <div v-else-if=\"arg.type == 'object'\">\r\n      <v-row v-for=\"(r, i) in keys\" :key=\"r.name\">\r\n        <v-col\r\n          ><v-text-field\r\n            v-model=\"r.name\"\r\n            @input=\"update_object_value\"\r\n          ></v-text-field\r\n        ></v-col>\r\n        <v-col\r\n          ><v-select\r\n            :items=\"['str', 'int', 'float', 'bool']\"\r\n            v-model=\"r.type\"\r\n            @input=\"update_object_value\"\r\n          ></v-select\r\n        ></v-col>\r\n        <v-col\r\n          ><ParamInput\r\n            :arg=\"r\"\r\n            v-model=\"object_value[r.name]\"\r\n            @input=\"update_object_value\"\r\n        /></v-col>\r\n        <v-col\r\n          ><v-btn\r\n            icon\r\n            @click=\"\r\n              keys.splice(i, 1);\r\n              update_object_value();\r\n            \"\r\n            ><v-icon>mdi-minus</v-icon></v-btn\r\n          ></v-col\r\n        >\r\n      </v-row>\r\n      <v-row>\r\n        <v-btn icon @click=\"keys.push({ name: '', type: 'str' })\"\r\n          ><v-icon>mdi-plus</v-icon></v-btn\r\n        >\r\n      </v-row>\r\n    </div>\r\n\r\n    <div v-else-if=\"arg.type == 'bool'\">\r\n      <v-simple-checkbox\r\n        :value=\"value\"\r\n        class=\"d-inline-block\"\r\n        ref=\"checkbox\"\r\n        v-bind=\"$attrs\"\r\n        v-on=\"inputListeners\"\r\n      >\r\n      </v-simple-checkbox\r\n      ><label @click=\"() => $refs.checkbox.click()\">{{ arg.name }}</label>\r\n    </div>\r\n\r\n    <div v-else-if=\"arg.type == 'QUERY'\">\r\n      <label>{{ arg.name }}</label>\r\n      <prism-editor\r\n        class=\"my-editor match-braces\"\r\n        v-model=\"code\"\r\n        @input=\"$emit('input', code)\"\r\n        :highlight=\"highlighter\"\r\n        line-numbers\r\n        @keyup.ctrl.enter=\"$emit('submit')\"\r\n      />\r\n    </div>\r\n\r\n    <v-textarea\r\n      v-else-if=\"arg.type == 'str' || arg.type == 'string'\"\r\n      :value=\"value\"\r\n      v-bind=\"$attrs\"\r\n      v-on=\"inputListeners\"\r\n      :hint=\"arg.default\"\r\n      :required=\"!arg.default\"\r\n      :rows=\"(value || '').includes('\\n') ? 4 : 1\"\r\n      cols=\"40\"\r\n      :label=\"arg.name\"\r\n    ></v-textarea>\r\n\r\n    <div\r\n      v-else-if=\"arg.type.startsWith('file')\"\r\n      @drop.prevent=\"drop_file\"\r\n      @dragover.prevent\r\n      @click=\"$refs.input_file.click()\"\r\n      class=\"file-drop\"\r\n    >\r\n      {{ file_prompt }}\r\n      <input\r\n        type=\"file\"\r\n        @change=\"drop_file({ dataTransfer: { files: $event.target.files } })\"\r\n        :accept=\"\r\n          arg.type\r\n            .substr(5)\r\n            .split(',')\r\n            .map((x) => `.${x}`)\r\n            .join(', ')\r\n        \"\r\n        ref=\"input_file\"\r\n      />\r\n    </div>\r\n\r\n    <v-text-field\r\n      v-else\r\n      type=\"text\"\r\n      :value=\"value\"\r\n      v-bind=\"$attrs\"\r\n      v-on=\"inputListeners\"\r\n      :placeholder=\"arg.default\"\r\n      :required=\"!arg.default\"\r\n      :label=\"arg.name\"\r\n    >\r\n    </v-text-field>\r\n\r\n    {{ prompt }}\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nfunction input_func(vm) {\r\n  return function (event) {\r\n    var val = vm.validate(event);\r\n    if (typeof val !== \"undefined\") {\r\n      vm.prompt = \"\";\r\n    } else {\r\n      val = null;\r\n    }\r\n    if (val && typeof val.value !== \"undefined\") val = val.value;\r\n    vm.$emit(\"validation\", vm.prompt === \"\");\r\n    vm.$emit(\"input\", val);\r\n  };\r\n}\r\n\r\nimport api from \"../api\";\r\nimport { PrismEditor } from \"vue-prism-editor\";\r\nimport \"vue-prism-editor/dist/prismeditor.min.css\"; // import the styles somewhere\r\n\r\n// import highlighting library (you can use any library you want just return html string)\r\nimport { highlight, languages } from \"prismjs/components/prism-core\";\r\nimport \"prismjs/components/prism-clike\";\r\nimport \"prismjs/themes/prism-tomorrow.css\"; // import syntax highlighting styles\r\n\r\nexport default {\r\n  name: \"ParamInput\",\r\n  inheritAttrs: false,\r\n  props: [\"value\", \"arg\"],\r\n  events: [\"validation\"],\r\n  components: {\r\n    PrismEditor,\r\n  },\r\n  computed: {\r\n    inputListeners: function () {\r\n      const vm = this;\r\n      return Object.assign({}, this.$listeners, {\r\n        input: input_func(vm),\r\n      });\r\n    },\r\n    type_choices() {\r\n      function _expand_choices(x) {\r\n        return x\r\n          .split(\"|\")\r\n          .map((x) => (x.includes(\":\") ? x.split(\":\") : [x, x]))\r\n          .map((x) => ({ text: x[0], value: x[1] }));\r\n      }\r\n\r\n      switch (this.arg.type) {\r\n        case \"LANG\":\r\n          return _expand_choices(this.langs);\r\n        default:\r\n          if (this.arg.type.includes(\"|\")) {\r\n            return _expand_choices(this.arg.type);\r\n          }\r\n          var doc_choose = (this.arg.description || \"\").match(\r\n            /@choose\\((.*?)\\)/\r\n          );\r\n          if (doc_choose) {\r\n            return _expand_choices(doc_choose[1]);\r\n          }\r\n          return false;\r\n      }\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      prompt: \"\",\r\n      code: \"\",\r\n      choices: [],\r\n      file_prompt: this.$t(\"drop-in-files\"),\r\n      langs: this.$t(\"langs\"),\r\n      object_value: {},\r\n      keys: [],\r\n    };\r\n  },\r\n  watch: {\r\n    arg() {\r\n      this.update_choices();\r\n    },\r\n  },\r\n  methods: {\r\n    validate(val) {\r\n      if (val === \"\") {\r\n        if (\r\n          typeof this.arg.default === \"undefined\" ||\r\n          this.arg.default === null\r\n        ) {\r\n          this.prompt = this.$t(\"required\");\r\n          return;\r\n        }\r\n        return null;\r\n      }\r\n      switch (this.arg.type) {\r\n        case \"bool\":\r\n          return val;\r\n        case \"int\":\r\n          if (val.match(/^[+-]?\\d+$/)) return parseInt(val);\r\n          break;\r\n        case \"float\":\r\n        case \"number\":\r\n          if (val.match(/^[+-]?\\d?\\.?\\d+[eE]?[+-]?\\d*$/))\r\n            return parseFloat(val);\r\n          break;\r\n        default:\r\n          return val;\r\n      }\r\n      this.prompt = this.$t(\"match-type\", { type: this.arg.type });\r\n      return;\r\n    },\r\n    highlighter(code) {\r\n      return highlight(code, languages.clike); // languages.<insert language> to return html with markup\r\n    },\r\n    update_object_value() {\r\n      if (this.arg.type !== \"object\") return;\r\n      var val = {};\r\n      for (var k of this.keys) {\r\n        val[k.name] = this.object_value[k.name];\r\n      }\r\n      this.$emit(\"input\", val);\r\n    },\r\n    refresh(val) {\r\n      this.code = val;\r\n      this.$emit(\"input\", val);\r\n    },\r\n    update_choices() {\r\n      switch (this.arg.type) {\r\n        case \"TASK\":\r\n        case \"DATASET\":\r\n          api.call(this.arg.type.toLowerCase() + \"s\").then(\r\n            (data) =>\r\n              (this.choices = data.result.map((x) => ({\r\n                text: x.name,\r\n                value: this.arg.type == \"TASK\" ? x._id : x.name,\r\n              })))\r\n          );\r\n          break;\r\n        case \"PIPELINE\":\r\n          api.help_langs.then(\r\n            (data) =>\r\n              (this.choices = [].concat(\r\n                ...Object.values(data).map((x) =>\r\n                  Object.keys(x).map((k) => ({\r\n                    text: `${x[k].doc} ${k}`,\r\n                    value: k,\r\n                    hint: x[k].args\r\n                      .map(\r\n                        (x) =>\r\n                          `${x.name} (${x.type}${\r\n                            x.default !== null ? \" optional\" : \"\"\r\n                          })`\r\n                      )\r\n                      .join(\", \"),\r\n                  }))\r\n                )\r\n              ))\r\n          );\r\n          break;\r\n        case \"LANG\":\r\n          api.help_langs().then((data) => {\r\n            for (var pair of Object.entries(data)) {\r\n              let key = pair[0],\r\n                val = pair[1];\r\n              if (this.langs.indexOf(`:${key}`) >= 0) continue;\r\n              this.langs += `|${val}:${key}`;\r\n            }\r\n          });\r\n          break;\r\n        case \"object\":\r\n          this.keys = this.arg.keys || [];\r\n      }\r\n    },\r\n    drop_file(e) {\r\n      let types = this.arg.type.substr(5).split(\",\");\r\n      let types_check = new RegExp(\"\\\\.(\" + types.join(\"|\") + \")$\", \"i\");\r\n      let droppedFiles = Array.from(e.dataTransfer.files).filter((x) =>\r\n        x.name.match(types_check)\r\n      );\r\n      if (!droppedFiles.length) {\r\n        api.notify(this.$t(\"match-file-type\", { type: types.join(\", \") }));\r\n        return;\r\n      }\r\n      let file = droppedFiles[0];\r\n      var reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        this.$emit(\"input\", e.target.result);\r\n        this.file_prompt = file.name;\r\n      };\r\n      reader.onerror = (e) => console.log(\"Error : \" + e.type);\r\n      reader.readAsDataURL(file);\r\n    },\r\n  },\r\n  mounted() {\r\n    this.code = this.value;\r\n    this.update_choices();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nblockquote {\r\n  color: red;\r\n}\r\n\r\n/* required class */\r\n.my-editor {\r\n  /* we dont use `language-` classes anymore so thats why we need to add background and text color manually */\r\n  background: #2d2d2d;\r\n  color: #ccc;\r\n\r\n  /* you must provide font-family font-size line-height. Example: */\r\n  font-family: Fira code, Fira Mono, Consolas, Menlo, Courier, monospace;\r\n  font-size: 14px;\r\n  line-height: 1.5;\r\n  padding: 5px;\r\n}\r\n\r\n/* optional class for removing the outline */\r\n.prism-editor__textarea:focus {\r\n  outline: none;\r\n}\r\n\r\n.file-drop {\r\n  border: 1px dashed dodgerblue;\r\n  max-width: 200px;\r\n  padding: 20px;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ParamInput.vue?vue&type=template&id=fbcef6ac&scoped=true&\"\nimport script from \"./ParamInput.vue?vue&type=script&lang=js&\"\nexport * from \"./ParamInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ParamInput.vue?vue&type=style&index=0&id=fbcef6ac&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fbcef6ac\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-app',[(!_vm.viewer)?_c('v-navigation-drawer',{attrs:{\"app\":\"\",\"disable-resize-watcher\":\"\"},model:{value:(_vm.drawer),callback:function ($$v) {_vm.drawer=$$v},expression:\"drawer\"}},[_c('v-list',{attrs:{\"nav\":\"\"}},[_c('v-list-item',{attrs:{\"link\":\"\"},on:{\"click\":function($event){return _vm.$router.push('/')}}},[_c('v-list-item-title',[_vm._v(_vm._s(_vm.$t(\"search\")))])],1),_c('v-list-group',{scopedSlots:_vm._u([{key:\"activator\",fn:function(){return [_c('v-list-item-title',[_vm._v(_vm._s(_vm.$t(\"tasks\")))])]},proxy:true}],null,false,224619653)},[_c('v-list-item',{attrs:{\"link\":\"\"},on:{\"click\":function($event){return _vm.$router.push('/tasks')}}},[_c('v-list-item-title',[_vm._v(_vm._s(_vm.$t(\"all\")))])],1),_vm._l((_vm.shortcuts || [{ _id: '', name: _vm.$t('quick-task') }]),function(s){return _c('v-list-item',{key:s._id,attrs:{\"link\":\"\"},on:{\"click\":function($event){return _vm.$router.push('/tasks/shortcut/' + s._id)}}},[_c('v-list-item-title',[_vm._v(_vm._s(s.name))])],1)})],2),_c('v-list-group',{scopedSlots:_vm._u([{key:\"activator\",fn:function(){return [_c('v-list-item-title',[_vm._v(_vm._s(_vm.$t(\"user\")))])]},proxy:true}],null,false,4269343434)},[_vm._l(([\n            ['preferences', 'preferences'],\n            ['history', 'history'],\n          ]),function(item){return _c('v-list-item',{key:item[0],attrs:{\"link\":\"\"},on:{\"click\":function($event){return _vm.$router.push(`/${item[1]}`)}}},[_c('v-list-item-title',[_vm._v(_vm._s(_vm.$t(item[0])))])],1)}),_c('v-list-item',{attrs:{\"link\":\"\"},on:{\"click\":function($event){_vm.log_out();\n            _vm.$router.push('/login');}}},[_c('v-list-item-title',[_vm._v(_vm._s(_vm.$t(\"log-out\")))])],1)],2),_c('v-list-group',{scopedSlots:_vm._u([{key:\"activator\",fn:function(){return [_c('v-list-item-title',[_vm._v(_vm._s(_vm.$t(\"admin\")))])]},proxy:true}],null,false,4012197972)},_vm._l(([\n            ['file-storage', 'storage'],\n            ['dataset', 'datasets'],\n            ['console', 'dbconsole'],\n            ['system-admin', 'admin'],\n            ['auto-tagging', 'autotags'],\n          ]),function(item){return _c('v-list-item',{key:item[0],attrs:{\"link\":\"\"},on:{\"click\":function($event){return _vm.$router.push(`/${item[1]}`)}}},[_c('v-list-item-title',[_vm._v(_vm._s(_vm.$t(item[0])))])],1)}),1)],1)],1):_vm._e(),(!_vm.viewer)?_c('v-app-bar',{attrs:{\"app\":\"\",\"color\":\"primary\",\"dark\":\"\"}},[_c('v-app-bar-nav-icon',{on:{\"click\":function($event){_vm.drawer = !_vm.drawer}}}),_c('v-toolbar-title',[_vm._v(_vm._s(_vm.app_title))]),_c('v-spacer'),_c('queue-view',{attrs:{\"data\":_vm.queue}})],1):_vm._e(),_c('v-main',[_c('v-progress-linear',{style:({ opacity: _vm.loading ? 1 : 0, 'z-index': 5 }),attrs:{\"indeterminate\":\"\",\"app\":\"\",\"fixed\":\"\"}}),_c('div',{attrs:{\"id\":_vm.viewer ? 'viewer' : 'content-wrapper'}},[_c('keep-alive',{attrs:{\"include\":['SearchForm', 'ResultsView', 'DbConsole']}},[_c('router-view',{key:_vm.$route.fullPath,on:{\"logined\":function($event){return _vm.$emit('logined')}}})],1)],1),_c('div',{staticStyle:{\"height\":\"40px\"}}),(!_vm.viewer)?[_c('v-card',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.console_outputs.length > 0),expression:\"console_outputs.length > 0\"}],ref:\"console\",attrs:{\"flat\":\"\"}},[_c('v-btn',{staticClass:\"ma-3\",attrs:{\"small\":\"\",\"left\":\"\",\"bottom\":\"\",\"text\":\"\"},on:{\"click\":function($event){_vm.console_outputs = []}}},[_c('v-icon',[_vm._v(\"mdi-delete\")]),_vm._v(_vm._s(_vm.$t(\"clear\")))],1),_c('div',{staticClass:\"console\"},_vm._l((_vm.console_outputs.slice(0, 50)),function(line,index){return _c('div',{key:index},[_vm._v(\" \"+_vm._s(line)+\" \")])}),0)],1),_c('v-footer',{attrs:{\"id\":\"footer\"}},[_c('div',{staticClass:\"language mr-5\"},[_c('v-select',{style:({\n              width: '150px',\n            }),attrs:{\"dense\":\"\",\"flat\":\"\",\"single-line\":\"\",\"prepend-icon\":\"mdi-web\",\"items\":Object.entries(_vm.$i18n.messages).map((pair) => ({\n                value: pair[0],\n                text: pair[1]._lang,\n              }))},model:{value:(_vm.ui_language),callback:function ($$v) {_vm.ui_language=$$v},expression:\"ui_language\"}})],1),_c('div',{staticClass:\"powered-by\"},[_vm._v(\" Powered by Jindai © 2018-\"+_vm._s(new Date().getFullYear())+\" zhuth & contributors \")]),_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.copyright)}})])]:_vm._e()],2),_vm._l((_vm.snackbars),function(sb,index){return _c('v-snackbar',{key:`sb${index}`,scopedSlots:_vm._u([{key:\"action\",fn:function(){return [_c('v-btn',{attrs:{\"color\":\"primary\",\"text\":\"\"},on:{\"click\":function($event){return _vm.snackbars.splice(index, 1)}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1)]},proxy:true}],null,true),model:{value:(sb.visible),callback:function ($$v) {_vm.$set(sb, \"visible\", $$v)},expression:\"sb.visible\"}},[_vm._v(\" \"+_vm._s(sb.text)+\" \")])})],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('a',{staticStyle:{\"color\":\"white\",\"text-decoration\":\"none\"},attrs:{\"link\":\"\"},on:{\"click\":function($event){_vm.show_detail = true}}},[_c('v-badge',{attrs:{\"value\":_vm.data.finished.length > 0,\"content\":_vm.data.finished.length,\"color\":\"green\"}},[_vm._v(\" \"+_vm._s(_vm.$t(\"finished\"))+\" \")]),_c('v-badge',{staticClass:\"ml-5 mr-5\",attrs:{\"value\":_vm.data.waiting.length > 0,\"content\":_vm.data.waiting.length}},[_vm._v(\" \"+_vm._s(_vm.$t(\"waiting\"))+\" \")]),_c('v-badge',{attrs:{\"color\":\"orange\",\"value\":_vm.data.running.length > 0,\"content\":_vm.data.running.length}},[_vm._v(\" \"+_vm._s(_vm.$t(\"running\"))+\" \")])],1),_c('v-dialog',{attrs:{\"width\":\"80%\"},model:{value:(_vm.show_detail),callback:function ($$v) {_vm.show_detail=$$v},expression:\"show_detail\"}},[_c('v-card',[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"finished-tasks\"))+\" \"),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":_vm.clear_not_viewable}},[_c('v-icon',[_vm._v(\"mdi-delete\")])],1),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.show_detail = false}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1)],1),(_vm.data.finished.length > 0)?_c('v-card-text',_vm._l((_vm.data.finished),function(task){return _c('div',{key:task.key},[_c('h4',[_vm._v(_vm._s(task.name))]),_c('span',[_vm._v(_vm._s(task.key))]),_vm._v(\" \"+_vm._s(_vm.$t(\"run-at\"))+\": \"+_vm._s(task.queued_at)),_c('br'),(_vm.downloadable(task))?_c('v-btn',{attrs:{\"href\":_vm.download_link(task),\"target\":\"_blank\"}},[_c('v-icon',[_vm._v(\"mdi-download\")])],1):_vm._e(),(_vm.viewable(task))?_c('v-btn',{staticClass:\"ml-3\",on:{\"click\":function($event){return _vm.view_result(task)}}},[_c('v-icon',[_vm._v(\"mdi-eye\")])],1):_vm._e(),_c('v-btn',{staticClass:\"ml-3\",on:{\"click\":function($event){return _vm.delete_result(task)}}},[_c('v-icon',[_vm._v(\"mdi-delete\")])],1),_c('v-divider',{staticClass:\"mt-5\"})],1)}),0):_c('v-card-text',[_vm._v(_vm._s(_vm.$t(\"no-available\")))]),_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"running-tasks\")))]),_c('v-card-text',_vm._l((_vm.data.running),function(task){return _c('div',{key:task.key,staticClass:\"mb-5\"},[_c('span',[_vm._v(_vm._s(task.key))]),_vm._v(\" \"+_vm._s(_vm.$t(\"run-at\"))+\": \"+_vm._s(task.queued_at)),_c('br'),_c('v-btn',{on:{\"click\":function($event){return _vm.delete_result(task)}}},[_c('v-icon',[_vm._v(\"mdi-stop\")])],1)],1)}),0),_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"waiting-tasks\")))]),_c('v-card-text',_vm._l((_vm.data.waiting),function(task){return _c('div',{key:task.key,staticClass:\"mb-5\"},[_c('span',[_vm._v(_vm._s(task.key))]),_vm._v(\" \"+_vm._s(_vm.$t(\"run-at\"))+\": \"+_vm._s(task.queued_at)),_c('br'),_c('v-btn',{on:{\"click\":function($event){return _vm.delete_result(task)}}},[_c('v-icon',[_vm._v(\"mdi-stop\")])],1)],1)}),0)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <a\r\n      link\r\n      style=\"color: white; text-decoration: none\"\r\n      @click=\"show_detail = true\"\r\n    >\r\n      <v-badge\r\n        :value=\"data.finished.length > 0\"\r\n        :content=\"data.finished.length\"\r\n        color=\"green\"\r\n      >\r\n        {{ $t(\"finished\") }}\r\n      </v-badge>\r\n      <v-badge\r\n        class=\"ml-5 mr-5\"\r\n        :value=\"data.waiting.length > 0\"\r\n        :content=\"data.waiting.length\"\r\n      >\r\n        {{ $t(\"waiting\") }}\r\n      </v-badge>\r\n      <v-badge\r\n        color=\"orange\"\r\n        :value=\"data.running.length > 0\"\r\n        :content=\"data.running.length\"\r\n      >\r\n        {{ $t(\"running\") }}\r\n      </v-badge>\r\n    </a>\r\n    <v-dialog v-model=\"show_detail\" width=\"80%\">\r\n      <v-card>\r\n        <v-card-title\r\n          >{{ $t(\"finished-tasks\") }}\r\n          <v-spacer></v-spacer>\r\n          <v-btn icon @click=\"clear_not_viewable\">\r\n            <v-icon>mdi-delete</v-icon>\r\n          </v-btn>\r\n          <v-btn icon @click=\"show_detail = false\"\r\n            ><v-icon>mdi-close</v-icon></v-btn\r\n          >\r\n        </v-card-title>\r\n        <v-card-text v-if=\"data.finished.length > 0\">\r\n          <div v-for=\"task in data.finished\" :key=\"task.key\">\r\n            <h4>{{ task.name }}</h4>\r\n            <span>{{ task.key }}</span>\r\n            {{ $t(\"run-at\") }}: {{ task.queued_at }}<br />\r\n            <v-btn\r\n              :href=\"download_link(task)\"\r\n              v-if=\"downloadable(task)\"\r\n              target=\"_blank\"\r\n            >\r\n              <v-icon>mdi-download</v-icon>\r\n            </v-btn>\r\n            <v-btn\r\n              class=\"ml-3\"\r\n              @click=\"view_result(task)\"\r\n              v-if=\"viewable(task)\"\r\n            >\r\n              <v-icon>mdi-eye</v-icon>\r\n            </v-btn>\r\n            <v-btn class=\"ml-3\" @click=\"delete_result(task)\">\r\n              <v-icon>mdi-delete</v-icon>\r\n            </v-btn>\r\n            <v-divider class=\"mt-5\"></v-divider>\r\n          </div>\r\n        </v-card-text>\r\n        <v-card-text v-else>{{ $t(\"no-available\") }}</v-card-text>\r\n        <v-card-title>{{ $t(\"running-tasks\") }}</v-card-title>\r\n        <v-card-text>\r\n          <div v-for=\"task in data.running\" :key=\"task.key\" class=\"mb-5\">\r\n            <span>{{ task.key }}</span>\r\n            {{ $t(\"run-at\") }}: {{ task.queued_at }}<br />\r\n            <v-btn @click=\"delete_result(task)\"\r\n              ><v-icon>mdi-stop</v-icon></v-btn\r\n            >\r\n          </div>\r\n        </v-card-text>\r\n        <v-card-title>{{ $t(\"waiting-tasks\") }}</v-card-title>\r\n        <v-card-text>\r\n          <div v-for=\"task in data.waiting\" :key=\"task.key\" class=\"mb-5\">\r\n            <span>{{ task.key }}</span>\r\n            {{ $t(\"run-at\") }}: {{ task.queued_at }}<br />\r\n            <v-btn @click=\"delete_result(task)\"\r\n              ><v-icon>mdi-stop</v-icon></v-btn\r\n            >\r\n          </div>\r\n        </v-card-text>\r\n      </v-card>\r\n    </v-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport api from \"../api\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      show_detail: false,\r\n    };\r\n  },\r\n  props: [\"data\"],\r\n  methods: {\r\n    download_link(task) {\r\n      return \"/api/queue/\" + encodeURIComponent(task.key);\r\n    },\r\n    delete_result(task) {\r\n      var id = encodeURIComponent(task.key);\r\n      api.delete(\"queue/\" + id).then(() => {\r\n        api.notify({ title: \"成功删除\" });\r\n        this.$emit(\"updated\", {});\r\n      });\r\n    },\r\n    clear_not_viewable() {\r\n      for (var task of this.data.finished) {\r\n        var id = encodeURIComponent(task.key);\r\n        api.delete(\"queue/\" + id).then(() => {\r\n          this.$emit(\"updated\", {});\r\n        });\r\n      }\r\n    },\r\n    view_result(task) {\r\n      var id = encodeURIComponent(task.key);\r\n      this.$router.push(\"/results/\" + id).catch(() => {});\r\n      this.show_detail = false;\r\n    },\r\n    downloadable(task) {\r\n      switch (task.result_type) {\r\n        case \"list\":\r\n        case \"dict\":\r\n        case \"file\":\r\n          return true;\r\n        default:\r\n          return false;\r\n      }\r\n    },\r\n    viewable(task) {\r\n      switch (task.result_type) {\r\n        case \"list\":\r\n        case \"redirect\":\r\n        case \"exception\":\r\n          return true;\r\n        default:\r\n          return false;\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.click-here > span {\r\n  border-radius: 5px;\r\n  line-height: 100%;\r\n  text-align: center;\r\n  min-width: 14px;\r\n  background-color: green;\r\n  display: inline-block;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueueView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueueView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./QueueView.vue?vue&type=template&id=25525aa2&scoped=true&\"\nimport script from \"./QueueView.vue?vue&type=script&lang=js&\"\nexport * from \"./QueueView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./QueueView.vue?vue&type=style&index=0&id=25525aa2&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"25525aa2\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <v-app>\n    <v-navigation-drawer v-model=\"drawer\" app v-if=\"!viewer\" disable-resize-watcher>\n      <v-list nav>\n        <v-list-item link @click=\"$router.push('/')\">\n          <v-list-item-title>{{ $t(\"search\") }}</v-list-item-title>\n        </v-list-item>\n        <v-list-group>\n          <template v-slot:activator>\n            <v-list-item-title>{{ $t(\"tasks\") }}</v-list-item-title>\n          </template>\n          <v-list-item link @click=\"$router.push('/tasks')\">\n            <v-list-item-title>{{ $t(\"all\") }}</v-list-item-title>\n          </v-list-item>\n          <v-list-item\n            link\n            v-for=\"s in shortcuts || [{ _id: '', name: $t('quick-task') }]\"\n            :key=\"s._id\"\n            @click=\"$router.push('/tasks/shortcut/' + s._id)\"\n          >\n            <v-list-item-title>{{ s.name }}</v-list-item-title>\n          </v-list-item>\n        </v-list-group>\n\n        <v-list-group>\n          <template v-slot:activator>\n            <v-list-item-title>{{ $t(\"user\") }}</v-list-item-title>\n          </template>\n          <v-list-item\n            v-for=\"item in [\n              ['preferences', 'preferences'],\n              ['history', 'history'],\n            ]\"\n            :key=\"item[0]\"\n            link\n            @click=\"$router.push(`/${item[1]}`)\"\n          >\n            <v-list-item-title>{{ $t(item[0]) }}</v-list-item-title>\n          </v-list-item>\n          <v-list-item\n            link\n            @click=\"\n              log_out();\n              $router.push('/login');\n            \"\n          >\n            <v-list-item-title>{{ $t(\"log-out\") }}</v-list-item-title>\n          </v-list-item>\n        </v-list-group>\n\n        <v-list-group>\n          <template v-slot:activator>\n            <v-list-item-title>{{ $t(\"admin\") }}</v-list-item-title>\n          </template>\n\n          <v-list-item\n            v-for=\"item in [\n              ['file-storage', 'storage'],\n              ['dataset', 'datasets'],\n              ['console', 'dbconsole'],\n              ['system-admin', 'admin'],\n              ['auto-tagging', 'autotags'],\n            ]\"\n            :key=\"item[0]\"\n            link\n            @click=\"$router.push(`/${item[1]}`)\"\n          >\n            <v-list-item-title>{{ $t(item[0]) }}</v-list-item-title>\n          </v-list-item>\n        </v-list-group>\n      </v-list>\n    </v-navigation-drawer>\n\n    <v-app-bar app color=\"primary\" dark v-if=\"!viewer\">\n      <v-app-bar-nav-icon @click=\"drawer = !drawer\"></v-app-bar-nav-icon>\n      <v-toolbar-title>{{ app_title }}</v-toolbar-title>\n      <v-spacer></v-spacer>\n      <queue-view :data=\"queue\"></queue-view>\n    </v-app-bar>\n\n    <v-main>\n      <v-progress-linear\n        indeterminate\n        :style=\"{ opacity: loading ? 1 : 0, 'z-index': 5 }\"\n        app\n        fixed\n      ></v-progress-linear>\n\n      <div :id=\"viewer ? 'viewer' : 'content-wrapper'\">\n        <keep-alive :include=\"['SearchForm', 'ResultsView', 'DbConsole']\">\n          <router-view @logined=\"$emit('logined')\" :key=\"$route.fullPath\" />\n        </keep-alive>\n      </div>\n\n      <div style=\"height: 40px\"></div>\n\n      <template v-if=\"!viewer\">\n        <v-card flat v-show=\"console_outputs.length > 0\" ref=\"console\">\n          <v-btn\n            small\n            left\n            bottom\n            text\n            class=\"ma-3\"\n            @click=\"console_outputs = []\"\n            ><v-icon>mdi-delete</v-icon>{{ $t(\"clear\") }}</v-btn\n          >\n          <div class=\"console\">\n            <div\n              v-for=\"(line, index) in console_outputs.slice(0, 50)\"\n              :key=\"index\"\n            >\n              {{ line }}\n            </div>\n          </div>\n        </v-card>\n\n        <v-footer id=\"footer\">\n          <div class=\"language mr-5\">\n            <v-select\n              dense\n              flat\n              single-line\n              prepend-icon=\"mdi-web\"\n              v-model=\"ui_language\"\n              :items=\"\n                Object.entries($i18n.messages).map((pair) => ({\n                  value: pair[0],\n                  text: pair[1]._lang,\n                }))\n              \"\n              :style=\"{\n                width: '150px',\n              }\"\n            ></v-select>\n          </div>\n          <div class=\"powered-by\">\n            Powered by Jindai &copy; 2018-{{ new Date().getFullYear() }} zhuth\n            &amp; contributors\n          </div>\n          <div v-html=\"copyright\"></div>\n        </v-footer>\n      </template>\n    </v-main>\n\n    <v-snackbar\n      v-model=\"sb.visible\"\n      v-for=\"(sb, index) in snackbars\"\n      :key=\"`sb${index}`\"\n    >\n      {{ sb.text }}\n      <template v-slot:action=\"\">\n        <v-btn color=\"primary\" text @click=\"snackbars.splice(index, 1)\">\n          <v-icon>mdi-close</v-icon>\n        </v-btn>\n      </template>\n    </v-snackbar>\n  </v-app>\n</template>\n\n<script>\nimport api from \"./api\";\nimport QueueView from \"./components/QueueView.vue\";\nimport { setup } from \"./locales\";\n\nexport default {\n  name: \"app\",\n  components: {\n    QueueView,\n  },\n  data() {\n    return {\n      drawer: true,\n      loading: false,\n      queue: {\n        finished: [],\n        waiting: 0,\n        running: [],\n      },\n      queue_source: null,\n      logs: {},\n      admin: false,\n      shortcuts: [],\n      snackbars: [],\n      console_outputs: [],\n      app_title: \"Jindai\",\n      app_dark: false,\n      copyright: \"\",\n      ui_language: \"\",\n      queue_timeout_flag: 0,\n    };\n  },\n  watch: {\n    app_dark(val) {\n      this.$vuetify.theme.dark = !!val;\n    },\n    app_title(val) {\n      document.title = val;\n    },\n    ui_language(val) {\n      setup(val);\n      api.locale = val;\n    },\n    drawer(val) {\n      api.config.drawer = val;\n    }\n  },\n  created() {\n    this.ui_language = this.$i18n.locale;\n    api.bus\n      .$on(\"loading\", (loading_num) => (this.loading = loading_num > 0))\n      .$on(\"alert\", (bundle) => {\n        const message = bundle.title\n          ? `${bundle.title}\\n${bundle.text || \"\"}`.trim()\n          : bundle;\n        this.snackbars = this.snackbars\n          .filter((x) => x.visible)\n          .concat([\n            {\n              text:\n                typeof this.$i18n.messages.chs[message] !== \"undefined\"\n                  ? this.$t(message)\n                  : message,\n              visible: true,\n            },\n          ])\n          .slice(0, 5);\n      })\n      .$on(\"finish\", (key) => {\n        if (this.logs[key]) delete this.logs[key];\n      });\n    this.$on(\"logined\", () => {\n      api\n        .logined()\n        .then((data) => (this.admin = data.result.roles.indexOf(\"admin\") >= 0))\n        .then(() => {\n          api\n            .call(\"tasks/shortcuts\")\n            .then((data) => (this.shortcuts = data.result));\n          if (!this.viewer) {\n            this.queue_event();\n          }\n        })\n        .catch(() => (localStorage.token = \"\"));\n    });\n  },\n  mounted() {\n    api.call(\"meta\").then((data) => {\n      Object.assign(this, data.result);\n    });\n    this.$emit(\"logined\");\n    window.onblur = () => {\n      this.queue_source.close()\n      this.queue_source = null\n    }\n    window.onfocus = () => {\n      this.queue_event()\n    }\n    this.drawer = api.config.drawer;\n  },\n  computed: {\n    viewer() {\n      return location.href.indexOf(\"/view/\") > 0;\n    },\n  },\n  methods: {\n    nav_click(e) {\n      this.$router.push(e.target.getAttribute(\"to\")).catch(() => {});\n    },\n    log_out() {\n      api.log_out();\n    },\n    update_queue(queue) {\n      if (!queue) return;\n      this.queue = {\n                'finished': queue.filter(x => x.status == 'stopped'),\n                'running': queue.filter(x => x.status == 'running'),\n                'waiting': queue.filter(x => x.status == 'pending'),\n            }\n    },\n    queue_event() {\n      api.queue().then((queue) => this.update_queue(queue));\n      if (this.queue_source) return;\n      this.queue_source = new EventSource(\"/api/queue/events\");\n      this.queue_source.onmessage = (event) => {\n        console.log(event)\n        var data = JSON.parse(event.data);\n        if (data.log) {\n          this.console_outputs.splice(0, 0, data.log);\n          if (this.console_outputs.length > 100)\n            this.console_outputs.splice(50, this.console_outputs.length - 50);\n        } else this.update_queue(data);\n      };\n    },\n  },\n  sse: {\n    cleanup: true,\n  },\n};\n</script>\n\n<style>\nem {\n  background-color: yellow;\n  font-style: normal;\n  color: black;\n}\n\n.console {\n  height: 200px;\n  overflow-y: auto;\n  font-size: 12px;\n}\n\n.chip {\n  border-radius: 20px;\n  min-width: 30px;\n  max-width: 120px;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n  text-align: center;\n  background: #eee;\n  color: #333 !important;\n  text-decoration: none !important;\n  padding: 4px;\n  margin-top: 4px;\n  display: inline-block;\n  white-space: nowrap;\n  vertical-align: middle;\n}\n\n.pointer {\n  cursor: pointer;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=65c6d83c&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&id=65c6d83c&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue';\nimport Vuetify from 'vuetify/lib/framework';\nimport '@mdi/font/css/materialdesignicons.css';\nimport \"@fontsource/roboto\";\n\nVue.use(Vuetify);\n\nexport default new Vuetify({\n    icons: { iconfont: 'mdi' }\n});\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"search\")))]),_c('v-card-text',{on:{\"drop\":function($event){$event.preventDefault();return _vm.drop_json_file.apply(null, arguments)},\"dragover\":function($event){$event.preventDefault();}}},[_c('form',{attrs:{\"autocapitalize\":\"off\",\"autocorrect\":\"off\",\"spellcheck\":\"false\"}},[_c('v-row',[_c('v-col',[(_vm.expert)?_c('ParamInput',{ref:\"search_code\",staticClass:\"mb-5 d-inline-block cond-width\",attrs:{\"arg\":{name: _vm.$t('query'), type: 'QUERY'}},on:{\"submit\":_vm.search},model:{value:(_vm.q),callback:function ($$v) {_vm.q=$$v},expression:\"q\"}}):_c('v-text-field',{staticClass:\"d-inline-block selector cond-width\",attrs:{\"dense\":\"\",\"label\":_vm.$t('query')},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.search.apply(null, arguments)}},model:{value:(_vm.q),callback:function ($$v) {_vm.q=$$v},expression:\"q\"}}),_c('v-combobox',{staticClass:\"d-inline-block ml-5 selector\",style:({ width: '100px' }),attrs:{\"label\":_vm.$t('sort'),\"dense\":\"\",\"items\":[\n              { text: _vm.$t('default'), value: 'id' },\n              { text: _vm.$t('pdate'), value: 'pdate' },\n              { text: _vm.$t('pdate-rev'), value: '-pdate' },\n              { text: _vm.$t('source'), value: 'source' },\n              { text: _vm.$t('latest-imported'), value: '-id' },\n              { text: _vm.$t('random'), value: 'random' },\n            ]},model:{value:(_vm.sort),callback:function ($$v) {_vm.sort=$$v},expression:\"sort\"}})],1)],1),_c('v-row',{staticStyle:{\"margin-top\":\"-24px\"}},[_c('v-col',[_c('treeselect',{attrs:{\"multiple\":true,\"options\":_vm.datasets,\"placeholder\":_vm.$t('dataset')},model:{value:(_vm.selected_datasets),callback:function ($$v) {_vm.selected_datasets=$$v},expression:\"selected_datasets\"}})],1)],1),_c('v-row',{staticClass:\"ml-0 mb-3\"},[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.search}},[_vm._v(_vm._s(_vm.$t(\"search\")))]),_c('span',{staticClass:\"ml-5\",staticStyle:{\"line-height\":\"100%\",\"vertical-align\":\"middle\"}},[_vm._v(\" \"+_vm._s(_vm.$t(\"grouping\"))+\" \"),_c('v-combobox',{staticClass:\"d-inline-block ml-1\",staticStyle:{\"width\":\"80px\"},attrs:{\"dense\":\"\",\"flat\":\"\",\"items\":[\n              { text: _vm.$t('none'), value: 'none' },\n              { text: _vm.$t('group'), value: 'group' },\n              { text: _vm.$t('source'), value: 'source' },\n              { text: _vm.$t('author'), value: 'author' },\n            ]},model:{value:(_vm.groups),callback:function ($$v) {_vm.groups=$$v},expression:\"groups\"}})],1),_c('v-spacer'),_c('v-btn',{staticClass:\"exports\",on:{\"click\":_vm.export_query}},[_c('v-icon',[_vm._v(\"mdi-clipboard-outline\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"export-task\"))+\" \")],1),_c('v-btn',{staticClass:\"exports\",on:{\"click\":function($event){return _vm.export_file('xlsx')}}},[_c('v-icon',[_vm._v(\"mdi-file-excel\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"export-excel\"))+\" \")],1),_c('v-btn',{staticClass:\"exports\",on:{\"click\":function($event){return _vm.export_file('json')}}},[_c('v-icon',[_vm._v(\"mdi-download\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"export-json\"))+\" \")],1)],1)],1),_c('ResultsView',{ref:\"results\",staticClass:\"mt-5\",attrs:{\"page_size\":_vm.page_size},on:{\"load\":_vm.load_search}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.total !== 0)?_c('v-sheet',{ref:\"results\",class:_vm.config.view_mode},[_c('div',{staticClass:\"tools\"},[_c('v-btn-toggle',{staticClass:\"view-mode-toggler\",attrs:{\"mandatory\":\"\",\"dense\":\"\"},on:{\"change\":_vm.update_view_mode},model:{value:(_vm.config.view_mode),callback:function ($$v) {_vm.$set(_vm.config, \"view_mode\", $$v)},expression:\"config.view_mode\"}},[_c('v-btn',{attrs:{\"value\":\"list\"}},[_c('v-icon',[_vm._v(\"mdi-view-list\")])],1),_c('v-btn',{attrs:{\"value\":\"page\"}},[_c('v-icon',[_vm._v(\"mdi-text-long\")])],1),_c('v-btn',{attrs:{\"value\":\"gallery\"}},[_c('v-icon',[_vm._v(\"mdi-view-module\")])],1)],1)],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.total !== null),expression:\"total !== null\"}],staticClass:\"count\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"found-results\", { total: _vm.total }))+\" \")]),_c('v-divider',{staticClass:\"mt-5 mb-5\"}),(_vm.columns.includes('content'))?_c('div',{ref:\"all_items\",staticClass:\"wrapper-container\"},[_vm._l((_vm.visible_data),function(r,index){return [(r.spacer)?_c('div',{key:'spacer' + index,staticClass:\"spacer\"}):_c('div',{key:index,staticClass:\"paragraph\",attrs:{\"data-id\":r._id}},[_c('div',{staticClass:\"meta\"},[_c('v-checkbox',{staticClass:\"d-inline-block\",attrs:{\"dense\":\"\",\"hide-details\":\"\"},on:{\"change\":function($event){return _vm.update_selection(r, null, index)}},model:{value:(r.selected),callback:function ($$v) {_vm.$set(r, \"selected\", $$v)},expression:\"r.selected\"}}),_vm._v(\" \"+_vm._s(_vm.$t(\"dataset\"))+\": \"),_c('a',{attrs:{\"href\":'/' +\n              _vm.querystring_stringify({\n                q: _vm.current_q(),\n                selected_datasets: [r.dataset],\n                groups: 'none'\n              }),\"target\":\"_blank\"}},[_vm._v(_vm._s(r.dataset))]),_vm._v(\" \"+_vm._s(_vm.$t(\"outline\"))+\": \"+_vm._s(r.outline)+\" \"+_vm._s(_vm.$t(\"source\"))+\": \"),_c('a',{attrs:{\"href\":'/' +\n              _vm.querystring_stringify({\n                q: `(${_vm.current_q()}),source.file=${_vm.quote(\n                  r.source.file\n                )}`,\n                selected_datasets: [r.dataset],\n                groups: 'none',\n              }),\"target\":\"_blank\"}},[_vm._v(_vm._s(r.source.file))]),_c('a',{attrs:{\"href\":r.source.url,\"target\":\"_blank\"}},[_vm._v(_vm._s(r.source.url))]),_vm._v(\" \"+_vm._s(_vm.$t(\"pagenum\"))+\": \"+_vm._s(r.pagenum)+\" \"+_vm._s(_vm.$t(\"date\"))+\": \"+_vm._s(_vm._f(\"dateSafe\")(r.pdate))+\" \"),_c('v-divider',{staticClass:\"mt-5\"})],1),(_vm.config.view_mode == 'gallery')?_c('v-img',{class:{ selected: r.selected },attrs:{\"contain\":_vm.config.contain,\"height\":240,\"src\":_vm.get_paragraph_image(r)},on:{\"click\":function($event){return _vm.update_selection(r, $event, index)},\"dblclick\":function($event){return _vm.view_page(index)}}}):_vm._e(),_c('ContentView',{key:r._id,attrs:{\"view_mode\":_vm.config.view_mode,\"paragraph\":r,\"item_width\":200,\"item_height\":200}}),_c('div',{staticClass:\"mt-10 operations\"},[_c('v-btn',{on:{\"click\":function($event){return _vm.view_page(index)}}},[_c('v-icon',[_vm._v(\"mdi-eye\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"view\"))+\" \")],1),_c('v-btn',{attrs:{\"href\":`/view/${r.mongocollection}/${\n              r.source.file ? r.source.file + '/' + r.source.page : r._id\n            }`,\"target\":\"_blank\"}},[_c('v-icon',[_vm._v(\"mdi-dock-window\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"browse\"))+\" \")],1),_c('v-btn',{on:{\"click\":function($event){_vm.dialogs.info.target = r;\n              _vm.dialogs.info.visible = true;}}},[_c('v-icon',[_vm._v(\"mdi-information\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"metadata\"))+\" \")],1),_c('v-btn',{on:{\"click\":function($event){_vm.dialogs.edit.target = r;\n              _vm.dialogs.edit.visible = true;}}},[_c('v-icon',[_vm._v(\"mdi-file-edit-outline\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"edit\"))+\" \")],1),_c('v-menu',{attrs:{\"offset-y\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function({ on, attrs }){return [_c('v-btn',_vm._g(_vm._b({staticClass:\"d-inline-block\"},'v-btn',attrs,false),on),[_c('v-icon',[_vm._v(\"mdi-send\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"send-task\"))+\" \")],1)]}}],null,true)},[_c('v-list',_vm._l((_vm.dialogs.send_task.quicktasks),function(item,index){return _c('v-list-item',{key:index,staticClass:\"pointer\"},[_c('v-list-item-title',{on:{\"click\":function($event){_vm.set_selection([r]);\n                    _vm.send_task(item.value);}}},[_vm._v(_vm._s(item.text))])],1)}),1)],1),_c('v-divider',{staticClass:\"mt-5 mb-5\"})],1)],1)]})],2):_c('v-sheet',[_c('table',[_c('thead',[_c('tr',_vm._l((_vm.columns),function(col){return _c('th',{key:col},[_vm._v(_vm._s(col))])}),0)]),_c('tbody',_vm._l((_vm.visible_data),function(r,index){return _c('tr',{key:index},_vm._l((_vm.columns),function(col){return _c('td',{key:col + index},[(Array.isArray(r[col]))?_c('div',[_c('v-btn',{on:{\"click\":function($event){return _vm.show_embedded(r, col)}}},[_c('v-icon',[_vm._v(\"mdi-file\")])],1)],1):_c('div',[_vm._v(\" \"+_vm._s(r[col])+\" \")])])}),0)}),0)])]),_c('v-row',{staticClass:\"mt-5\"},[_c('v-pagination',{attrs:{\"length\":_vm.pages.length},model:{value:(_vm.page),callback:function ($$v) {_vm.page=$$v},expression:\"page\"}}),_c('div',[_c('label',[_vm._v(\" \"+_vm._s(_vm.$t(\"pagenum\")))]),_c('v-text-field',{staticClass:\"d-inline-block ml-1\",staticStyle:{\"max-width\":\"40px\"},attrs:{\"type\":\"number\",\"dense\":\"\"},on:{\"change\":function($event){_vm.page = parseInt($event) || _vm.page}}})],1),_c('div',[_c('label',[_vm._v(_vm._s(_vm.$t(\"page-size\")))]),_c('v-select',{staticClass:\"d-inline-block ml-1\",staticStyle:{\"max-width\":\"50px\"},attrs:{\"items\":[20, 50, 100, 200],\"dense\":\"\"},model:{value:(_vm.config.page_size),callback:function ($$v) {_vm.$set(_vm.config, \"page_size\", $$v)},expression:\"config.page_size\"}})],1)],1),_c('PageView',{ref:\"page_view\",staticClass:\"page-view\",attrs:{\"paragraphs\":_vm.visible_data,\"view_mode\":_vm.config.view_mode,\"start_index\":_vm.dialogs.paragraph.start_index,\"plugin_pages\":_vm.plugin_pages},on:{\"next\":function($event){return _vm.turn_page(_vm.page + 1)},\"prev\":function($event){return _vm.turn_page(_vm.page - 1)},\"browse\":function($event){_vm.browsing = $event},\"info\":function($event){_vm.dialogs.info.visible = true;\n      _vm.dialogs.info.target = $event;},\"rating\":_vm.rating},model:{value:(_vm.dialogs.paragraph.visible),callback:function ($$v) {_vm.$set(_vm.dialogs.paragraph, \"visible\", $$v)},expression:\"dialogs.paragraph.visible\"}}),_c('v-dialog',{model:{value:(_vm.dialogs.info.visible),callback:function ($$v) {_vm.$set(_vm.dialogs.info, \"visible\", $$v)},expression:\"dialogs.info.visible\"}},[_c('v-card',[_c('v-card-title',[_c('v-btn',{staticStyle:{\"margin-right\":\"12px\"},attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.dialogs.info.visible = false}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1),_vm._v(\" \"+_vm._s(_vm.$t(\"metadata\")))],1),_c('v-card-text',_vm._l((_vm.dialogs.info.target),function(v,k){return _c('v-row',{key:k},[_c('v-col',{attrs:{\"cols\":\"4\"}},[_vm._v(_vm._s(k))]),_c('v-col',{attrs:{\"cols\":\"8\"}},[_vm._v(_vm._s(v))])],1)}),1),_c('v-card-actions',[_c('v-btn',{on:{\"click\":function($event){_vm.dialogs.info.visible = false}}},[_vm._v(\" \"+_vm._s(_vm.$t(\"ok\"))+\" \")])],1)],1)],1),_c('v-dialog',{model:{value:(_vm.dialogs.edit.visible),callback:function ($$v) {_vm.$set(_vm.dialogs.edit, \"visible\", $$v)},expression:\"dialogs.edit.visible\"}},[_c('v-card',[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"edit-paragraph\"))+\" \"+_vm._s(_vm.dialogs.edit.target._id)+\" \"),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.dialogs.edit.visible = false}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1)],1),_c('v-card-text',[_c('v-list',[_vm._l((_vm.dialogs.edit.target),function(field,key){return _c('v-list-item',{key:key},[_c('v-list-item-content',[(\n                  !(\n                    ['_id', 'matched_content'].includes(key) ||\n                    typeof field == 'object'\n                  )\n                )?_c('ParamInput',{attrs:{\"arg\":{ type: typeof field, name: key, default: '\\'\\'' }},model:{value:(_vm.dialogs.edit.target[key]),callback:function ($$v) {_vm.$set(_vm.dialogs.edit.target, key, $$v)},expression:\"dialogs.edit.target[key]\"}}):_vm._e()],1)],1)}),_c('v-list-item',[_c('v-list-item-content',[_c('ParamInput',{attrs:{\"arg\":{ type: 'string', name: '新字段', default: '' }},model:{value:(_vm.dialogs.edit.new_field),callback:function ($$v) {_vm.$set(_vm.dialogs.edit, \"new_field\", $$v)},expression:\"dialogs.edit.new_field\"}}),_c('v-btn',{on:{\"click\":function($event){_vm.dialogs.edit.target[_vm.dialogs.edit.new_field] = '';\n                  _vm.$forceUpdate();}}},[_c('v-icon',[_vm._v(\"mdi-plus\")])],1)],1)],1)],2)],1),_c('v-card-actions',[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.save()}}},[_vm._v(_vm._s(_vm.$t(\"save\")))]),_c('v-btn',{on:{\"click\":function($event){_vm.dialogs.edit.visible = false}}},[_vm._v(_vm._s(_vm.$t(\"cancel\")))])],1)],1)],1),_c('v-dialog',{model:{value:(_vm.dialogs.embedded.visible),callback:function ($$v) {_vm.$set(_vm.dialogs.embedded, \"visible\", $$v)},expression:\"dialogs.embedded.visible\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\" \"+_vm._s(_vm.$t(\"view\"))+\" \"+_vm._s(_vm.querify(_vm.dialogs.embedded.target.source))+\" \"),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.dialogs.embedded.visible = false}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1)],1),_c('v-card-text',[_c('ResultsView',{attrs:{\"total\":(_vm.dialogs.embedded.target.arr || []).length},on:{\"load\":(a) =>\n              a.callback({ offset: 0, result: _vm.dialogs.embedded.target.arr })}})],1)],1)],1),_c('v-dialog',{model:{value:(_vm.dialogs.send_task.visible),callback:function ($$v) {_vm.$set(_vm.dialogs.send_task, \"visible\", $$v)},expression:\"dialogs.send_task.visible\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\" \"+_vm._s(_vm.$t(\"send-task\"))+\" \"),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.dialogs.send_task.visible = false}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1)],1),_c('v-card-text',{staticClass:\"mt-5\"},[_c('v-row',[_c('v-col',[_c('v-autocomplete',{attrs:{\"dense\":\"\",\"label\":_vm.$t('send-to'),\"items\":_vm.dialogs.send_task.quicktasks},model:{value:(_vm.dialogs.send_task.pipeline),callback:function ($$v) {_vm.$set(_vm.dialogs.send_task, \"pipeline\", $$v)},expression:\"dialogs.send_task.pipeline\"}}),_c('v-btn',{attrs:{\"color\":\"primary\",\"dense\":\"\"},on:{\"click\":function($event){return _vm.$refs.quicktask_results.start(1)}}},[_c('v-icon',[_vm._v(\"mdi-fast-forward\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"run-now\")))],1)],1)],1),_c('v-sheet',[_c('ResultsView',{ref:\"quicktask_results\",attrs:{\"total\":_vm.dialogs.send_task.results_count},on:{\"load\":_vm.quicktask}})],1)],1)],1)],1),_c('tagging-shortcuts-dialog',{attrs:{\"choices\":_vm.dialogs.tagging_shortcuts.list,\"initial\":_vm.dialogs.tagging_shortcuts.initial,\"multiple\":false,\"match_initials\":true},on:{\"submit\":function($event){return _vm.tag($event, true)}},model:{value:(_vm.dialogs.tagging_shortcuts.visible),callback:function ($$v) {_vm.$set(_vm.dialogs.tagging_shortcuts, \"visible\", $$v)},expression:\"dialogs.tagging_shortcuts.visible\"}}),_c('tagging-dialog',{ref:\"tagging_dialog\",attrs:{\"choices\":_vm.dialogs.tagging.choices,\"scope\":_vm.scope(_vm.selected_paragraphs())},on:{\"submit\":function($event){return _vm.tag($event, false)},\"author\":_vm.set_author}}),_c('QuickActionButtons',{attrs:{\"selection_count\":_vm.selection_count,\"playing_interval\":_vm.config.playing_interval},on:{\"toggle-selection\":_vm.toggle_selection,\"clear-selection\":_vm.clear_selection,\"delete\":_vm.delete_items,\"rating\":function($event){return _vm.rating(0.5)},\"group\":_vm.group,\"tag\":_vm.show_tagging_dialog,\"merge\":_vm.merge,\"split\":_vm.split,\"task\":_vm.send_task,\"play\":_vm.playing,\"reset-storage\":_vm.reset_storage}})],1):_c('v-sheet',{ref:\"results\"},[_vm._v(\"未找到匹配的结果。\")])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-dialog',{staticClass:\"white-bg\",attrs:{\"value\":_vm.value,\"fullscreen\":_vm.view_mode == 'file' || _vm.view_mode == 'gallery',\"persistent\":\"\"}},[_c('v-card',{directives:[{name:\"touch\",rawName:\"v-touch\",value:({\n      left: () => _vm._event_handler('left'),\n      right: () => _vm._event_handler('right'),\n      down: () => _vm.$emit('input', false),\n      up: () => _vm.$emit('rating', { item: _vm.active_item, inc: 1 }),\n    }),expression:\"{\\n      left: () => _event_handler('left'),\\n      right: () => _event_handler('right'),\\n      down: () => $emit('input', false),\\n      up: () => $emit('rating', { item: active_item, inc: 1 }),\\n    }\"}],style:(_vm.view_mode == 'gallery' ? { overflow: 'hidden', height: '100%' } : {}),attrs:{\"flat\":\"\"},on:{\"wheel\":_vm._wheel_handler}},[_c('v-card-text',[(_vm.view_mode == 'file')?_c('v-row',{staticClass:\"pt-3\"},[_c('v-col',{staticClass:\"heading\"},[_c('h3',[_vm._v(_vm._s(_vm.file)+\"  \")])]),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\",\"enabled\":_vm.page > 0},on:{\"click\":function($event){return _vm._event_handler('right')}}},[_c('v-icon',[_vm._v(\"mdi-chevron-left\")])],1),_c('v-text-field',{staticStyle:{\"max-width\":\"50px\"},attrs:{\"dense\":\"\",\"flat\":\"\",\"type\":\"number\",\"value\":_vm.page},on:{\"input\":_vm.try_page}}),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm._event_handler('left')}}},[_c('v-icon',[_vm._v(\"mdi-chevron-right\")])],1)],1):_c('v-btn',{staticClass:\"close\",attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.$emit('input', false)}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1),(_vm.active_paragraph && _vm.active_paragraph.source)?[(_vm.view_mode !== 'gallery')?_c('v-row',{staticClass:\"main\"},[_c('div',{staticClass:\"paragraphs\"},[_vm._l((_vm.shown_paragraphs),function(p){return _c('div',{key:p._id},[_c('ContentView',{attrs:{\"paragraph\":p,\"item_width\":\"100%\",\"view_mode\":_vm.view_mode}})],1)}),(_vm.active_paragraph)?_c('div',{staticClass:\"mt-5 meta\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"date\"))+\": \"+_vm._s(_vm._f(\"dateSafe\")(_vm.active_paragraph.pdate))),_c('br'),_vm._v(\" \"+_vm._s(_vm.$t(\"pagenum\"))+\": \"+_vm._s(_vm.active_paragraph.pagenum)+\" \"),_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.pagenum_editor.new_pagenum = _vm.active_paragraph.pagenum;\n                  _vm.pagenum_edit = true;}}},[_c('v-icon',{attrs:{\"small\":\"\"}},[_vm._v(\"mdi-form-textbox\")])],1),_c('br'),_vm._v(\" \"+_vm._s(_vm.$t(\"outline\"))+\": \"+_vm._s(_vm.active_paragraph.outline)),_c('br'),_vm._v(\" \"+_vm._s(_vm.$t(\"source\"))+\": \"),(_vm.active_paragraph.source.url)?_c('a',{attrs:{\"href\":_vm.active_paragraph.source.url,\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.active_paragraph.source.url))]):_vm._e(),_vm._v(\" \"+_vm._s(_vm.active_paragraph.source.file)+\" \"+_vm._s(_vm.active_paragraph.source.page)),_c('br')],1):_vm._e()],2),_c('div',{staticClass:\"image\",on:{\"click\":function($event){_vm.show_modal = !!_vm.pdf_image}}},[_c('img',{attrs:{\"src\":_vm.pdf_image,\"alt\":\"\"},on:{\"load\":function($event){$event.target.style.height =\n                  _vm.window_height - $event.target.offsetTop - 20 + 'px'}}})])]):_c('div',[(_vm.value)?_c('ImageBrowsing',{attrs:{\"paragraph\":_vm.active_paragraph,\"item\":_vm.active_item,\"plugin_pages\":_vm.plugin_pages},on:{\"info\":function($event){return _vm.$emit('info', $event)},\"browse\":_vm._event_handler}}):_vm._e()],1),_c('v-dialog',{attrs:{\"fullscreen\":\"\"},model:{value:(_vm.show_modal),callback:function ($$v) {_vm.show_modal=$$v},expression:\"show_modal\"}},[_c('v-btn',{staticClass:\"ma-10\",attrs:{\"fab\":\"\",\"fixed\":\"\",\"icon\":\"\",\"top\":\"\",\"right\":\"\"},on:{\"click\":function($event){_vm.show_modal = false}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1),_c('img',{ref:\"image\",staticStyle:{\"width\":\"100%\"},attrs:{\"src\":_vm.pdf_image,\"alt\":\"\"}})],1),_c('v-dialog',{attrs:{\"width\":\"unset\"},model:{value:(_vm.pagenum_edit),callback:function ($$v) {_vm.pagenum_edit=$$v},expression:\"pagenum_edit\"}},[_c('v-card',[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"edit-pagenum\"))+\" \"),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.pagenum_edit = false}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1)],1),_c('v-card-text',[_c('v-sheet',[_c('ParamInput',{attrs:{\"arg\":{ name: _vm.$t('pagenum'), type: 'int' }},model:{value:(_vm.pagenum_editor.new_pagenum),callback:function ($$v) {_vm.$set(_vm.pagenum_editor, \"new_pagenum\", $$v)},expression:\"pagenum_editor.new_pagenum\"}}),_c('ParamInput',{attrs:{\"arg\":{\n                    name: _vm.$t('modify-mode'),\n                    type: _vm.$t('pagenum-modes'),\n                  }},model:{value:(_vm.pagenum_editor.sequential),callback:function ($$v) {_vm.$set(_vm.pagenum_editor, \"sequential\", $$v)},expression:\"pagenum_editor.sequential\"}}),_c('ParamInput',{attrs:{\"arg\":{ name: _vm.$t('folio-mode'), type: 'bool' }},model:{value:(_vm.pagenum_editor.folio),callback:function ($$v) {_vm.$set(_vm.pagenum_editor, \"folio\", $$v)},expression:\"pagenum_editor.folio\"}})],1)],1),_c('v-card-actions',[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.save_pagenum}},[_vm._v(_vm._s(_vm.$t(\"ok\")))])],1)],1)],1)]:_vm._e()],2)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return (['file', 'list', 'page'].includes(_vm.view_mode))?_c('div',{staticClass:\"paragraph mt-5\"},[(_vm.is_html)?_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.content)}}):_c('p',[_vm._v(\" \"+_vm._s(_vm.content)+\" \"),_c('v-btn',{staticClass:\"fav-button\",attrs:{\"color\":_vm.favored ? 'orange' : '',\"dark\":_vm.favored,\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.fav();\n_vm.$forceUpdate();}}},[_c('v-icon',{attrs:{\"small\":\"\"}},[_vm._v(\"mdi-star\")])],1)],1),(_vm.paragraph.images && _vm.paragraph.images.length)?_c('div',[_c('v-row',{attrs:{\"float\":\"\"}},_vm._l((_vm.first_item_only\n          ? _vm.paragraph.images.slice(0, 1)\n          : _vm.paragraph.images),function(item){return _c('v-card',{key:item._id,staticClass:\"ma-5\",staticStyle:{\"overflow\":\"hidden\"},attrs:{\"width\":_vm.item_width}},[_c('v-img',{attrs:{\"contain\":_vm.contain,\"height\":_vm.item_height,\"src\":_vm.get_item_image(item)}})],1)}),1)],1):_vm._e()]):_c('div',{staticClass:\"gallery-item\"},[_c('div',{staticClass:\"gallery-description\"},[_c('span',{staticClass:\"nums\"},[_c('span',{staticClass:\"datetime\"},[_vm._v(_vm._s(_vm._f(\"dateSafe\")(_vm.paragraph.pdate)))]),_c('span',{staticClass:\"count\"},[_c('a',{staticClass:\"counter secondary--text chip\",attrs:{\"target\":\"_blank\",\"href\":(_vm.paragraph.group_url || `/?q=id%3DObjectId(${_vm.paragraph._id})`) + '=>expand()&groups=none'}},[_vm._v(_vm._s(_vm.paragraph.count || _vm.paragraph.images.length))])]),_c('v-btn',{staticClass:\"orig no-underline\",attrs:{\"href\":_vm.paragraph.source.url,\"target\":\"_blank\",\"icon\":\"\"}},[_c('v-icon',[_vm._v(\"mdi-web\")])],1)],1),_c('a',{staticClass:\"force-text break-anywhere\",attrs:{\"href\":'/?q=source.url%3D`' + (_vm.paragraph.source.url || '') + '`',\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.paragraph.source.url))]),_c('p',{staticClass:\"content\"},[_vm._v(_vm._s(_vm.text))]),_vm._l((_vm.tags),function(tag){return [(tag != '...')?_c('a',{key:`${_vm.paragraph._id}-${Math.random()}-${tag}`,class:['tag', 'chip', _vm.tag_class(tag)],attrs:{\"alt\":tag,\"href\":'/' + _vm.querystring_stringify({\n            groups: tag.match(/^\\*/) ? 'none' : (tag.match(/^@/) ? 'group' : ''),\n            q:\n              tag.match(/^[@*]/)\n                ? _vm.quote(tag)\n                : _vm.quote(tag) + ',' + _vm.scope(_vm.paragraph)\n          }),\"target\":\"_blank\"}},[_vm._v(_vm._s(tag))]):_c('v-btn',{key:tag,attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.show_all_tags = true}}},[_c('v-icon',[_vm._v(\"mdi-more\")])],1)]})],2)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"paragraph mt-5\" v-if=\"['file', 'list', 'page'].includes(view_mode)\">\n    <p v-html=\"content\" v-if=\"is_html\"></p>\n    <p v-else>\n      {{ content }}\n      <v-btn\n        class=\"fav-button\"\n        :color=\"favored ? 'orange' : ''\"\n        :dark=\"favored\"\n        icon\n        small\n        @click=\"\n  fav();\n$forceUpdate();\n        \"\n      >\n        <v-icon small>mdi-star</v-icon>\n      </v-btn>\n    </p>\n    <div v-if=\"paragraph.images && paragraph.images.length\">\n      <v-row float>\n        <v-card\n          v-for=\"item in first_item_only\n          ? paragraph.images.slice(0, 1)\n          : paragraph.images\"\n          :key=\"item._id\"\n          :width=\"item_width\"\n          style=\"overflow: hidden\"\n          class=\"ma-5\"\n        >\n          <v-img :contain=\"contain\" :height=\"item_height\" :src=\"get_item_image(item)\"></v-img>\n        </v-card>\n      </v-row>\n    </div>\n  </div>\n  <div class=\"gallery-item\" v-else>\n    <div class=\"gallery-description\">\n      <span class=\"nums\">\n        <span class=\"datetime\">{{ paragraph.pdate | dateSafe }}</span>\n        <span class=\"count\">\n          <a\n            class=\"counter secondary--text chip\"\n            target=\"_blank\"\n            :href=\"(paragraph.group_url || `/?q=id%3DObjectId(${paragraph._id})`) + '=>expand()&groups=none'\"\n          >{{ paragraph.count || paragraph.images.length }}</a>\n        </span>\n        <v-btn :href=\"paragraph.source.url\" target=\"_blank\" class=\"orig no-underline\" icon><v-icon>mdi-web</v-icon></v-btn>\n      </span>\n      <a\n        :href=\"'/?q=source.url%3D`' + (paragraph.source.url || '') + '`'\"\n        class=\"force-text break-anywhere\"\n        target=\"_blank\"\n      >{{ paragraph.source.url }}</a>\n      <p class=\"content\">{{ text }}</p>\n      <template v-for=\"tag in tags\">\n        <a\n          v-if=\"tag != '...'\"\n          :alt=\"tag\"\n          :key=\"`${paragraph._id}-${Math.random()}-${tag}`\"\n          :href=\"'/' + querystring_stringify({\n            groups: tag.match(/^\\*/) ? 'none' : (tag.match(/^@/) ? 'group' : ''),\n            q:\n              tag.match(/^[@*]/)\n                ? quote(tag)\n                : quote(tag) + ',' + scope(paragraph)\n          })\"\n          :class=\"['tag', 'chip', tag_class(tag)]\"\n          target=\"_blank\"\n        >{{ tag }}</a>\n        <v-btn icon v-else :key=\"tag\" @click=\"show_all_tags = true\">\n          <v-icon>mdi-more</v-icon>\n        </v-btn>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nimport api from \"../api\";\n\nexport default {\n  name: \"ContentView\",\n  props: [\n    \"paragraph\",\n    \"first_item_only\",\n    \"item_width\",\n    \"item_height\",\n    \"view_mode\",\n    \"contain\",\n  ],\n  data: () => ({\n    show_all_tags: false\n  }),\n  computed: {\n    is_html() {\n      return this.content.match(/<.*>/);\n    },\n    content() {\n      return this.paragraph.matched_content || this.paragraph.content;\n    },\n    favored() {\n      return api.favored(this.paragraph);\n    },\n    tags() {\n      var sorted = [...this.paragraph.keywords].filter((x) => x).sort();\n      if (!this.show_all_tags && sorted.length > 20) sorted = [...sorted.slice(0, 20), \"...\"];\n      return sorted;\n    },\n    text() {\n      return this.paragraph.content || \"\";\n    },\n  },\n  methods: {\n    _open_window(url) {\n      window.open(url);\n    },\n    get_item_image(i) {\n      return api.get_item_image(i);\n    },\n    fav() {\n      api.fav(this.paragraph);\n    },\n    quote(x) {\n      return JSON.stringify(\"\" + x);\n    },\n    tag_class(tag) {\n      return tag.startsWith(\"*\")\n        ? \"t_group\"\n        : tag == this.paragraph.author\n          ? \"t_author\"\n          : tag != 'author' && tag != 'group'?\n            \"t_\" + tag : '';\n    },\n    querystring_stringify: api.querystring_stringify,\n    scope: api.scope\n  },\n};\n</script>\n\n<style scoped>\n.fav-button {\n  opacity: 0;\n}\np:hover .fav-button,\n.fav-button.orange--text {\n  opacity: 1;\n}\n.gallery-description a {\n  margin-right: 5px;\n}\n\n.gallery-description .content {\n  max-height: 150px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.gallery-description a.tag.t_author,\n.gallery-description a.tag.t_group {\n  color: white !important;\n  border-radius: 5px;\n  text-decoration: none;\n}\n\n.gallery-description a.tag.t_author {\n  background-color: darkorange;\n}\n\n.gallery-description a.tag.t_group {\n  background-color: purple;\n}\n\n.gallery-description a {\n  text-decoration: none;\n}\n\n.gallery-description .break-anywhere {\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n  max-width: 100%;\n  display: inline-block;\n  line-height: 100%;\n  vertical-align: middle;\n}\n\n.gallery-description span.nums > * {\n  margin-right: 5px;\n}\n\n.gallery-description,\n.gallery-description .force-text {\n  color: rgba(0, 0, 0, 0.6);\n}\n\n.theme--dark .gallery-description,\n.theme--dark .gallery-description .force-text {\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.paragraph > p {\n  font-family: Georgia, \"Times New Roman\", Times, serif;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ContentView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ContentView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ContentView.vue?vue&type=template&id=588a05d0&scoped=true&\"\nimport script from \"./ContentView.vue?vue&type=script&lang=js&\"\nexport * from \"./ContentView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ContentView.vue?vue&type=style&index=0&id=588a05d0&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"588a05d0\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.item)?_c('div',{staticClass:\"browser\"},[(_vm.browsing_video)?_c('video-player',{ref:\"videoPlayer\",staticClass:\"video-player\",attrs:{\"src\":_vm.get_item_video(_vm.item),\"options\":{\n      muted: false,\n      autoplay: true,\n      style: {\n        width: '100%',\n        height: '100vh',\n      },\n    }}}):_c('div',{staticStyle:{\"width\":\"100%\",\"text-align\":\"center\"},on:{\"click\":_vm.toggle_fits}},[_c('div',{style:({\n        height: '100vh',\n        width: '100%',\n        overflow: 'hidden',\n      })},[(_vm.item)?_c('img',{ref:\"browsing_image\",attrs:{\"src\":_vm.get_item_image(_vm.item),\"alt\":\"Browsing Image\"},on:{\"load\":_vm.fit_image}}):_vm._e()])]),_c('div',{staticClass:\"browsing description\"},[_c('v-row',{attrs:{\"align\":\"end\"}},[_c('v-col',{attrs:{\"cols\":\"2\"}},[_c('v-pagination',{attrs:{\"length\":3,\"total-visible\":0},on:{\"previous\":_vm.browse_prev,\"next\":_vm.browse_next},model:{value:(_vm.browsing_page),callback:function ($$v) {_vm.browsing_page=$$v},expression:\"browsing_page\"}})],1),(_vm.item)?_c('v-col',{staticClass:\"item-description\",attrs:{\"cols\":\"10\"}},[_c('v-row',{staticClass:\"mt-3 mb-3\"},[(typeof _vm.item.rating == 'number')?_c('div',{staticClass:\"mr-3\"},[_c('v-rating',{staticStyle:{\"display\":\"inline-block\"},attrs:{\"background-color\":\"white\",\"color\":\"yellow accent-4\",\"half-increments\":\"\",\"hover\":\"\",\"size\":\"18\"},on:{\"input\":function($event){return _vm.$emit('rating', { item: _vm.item, val: $event })}},model:{value:(_vm.item.rating),callback:function ($$v) {_vm.$set(_vm.item, \"rating\", $$v)},expression:\"item.rating\"}}),_c('span',{staticClass:\"grey--text text--lighten-2\"},[_vm._v(\"(\"+_vm._s(_vm.item.rating.toFixed(1))+\") \")])],1):_vm._e(),_c('div',[_vm._l((_vm.plugin_pages),function(filter,page_name){return _c('v-btn',{key:page_name,staticClass:\"t_func sim\",attrs:{\"icon\":\"\",\"dense\":\"\",\"href\":'/' + _vm.querystring_stringify({\n                q: _vm.scope(_vm.paragraph) + `;plugin('${_vm.format(\n                filter.format,\n                {\n                  mediaitem: _vm.item,\n                  paragraph: _vm.paragraph,\n                })}')`\n              }),\"target\":\"_blank\"}},[_c('v-icon',[_vm._v(_vm._s(filter.icon))])],1)}),_c('v-btn',{attrs:{\"icon\":\"\",\"dense\":\"\",\"target\":\"_blank\",\"data-keybind\":\"i\"},on:{\"click\":function($event){return _vm.$emit('info', _vm.item)}}},[_c('v-icon',[_vm._v(\"mdi-information\")])],1)],2)]),_c('ContentView',{staticClass:\"browsing-content\",attrs:{\"paragraph\":_vm.paragraph,\"view_mode\":\"gallery-description\"}})],1):_vm._e()],1)],1)],1):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"video\"},[_c('video',{key:_vm.src,ref:\"videoPlayer\",staticClass:\"video__player\",style:(_vm.options.style || {}),attrs:{\"preload\":\"auto\",\"controls\":_vm.options.controls,\"autoplay\":_vm.options.autoplay,\"webkit-playsinline\":\"true\",\"playsinline\":\"true\",\"x-webkit-airplay\":\"allow\",\"x5-video-player-type\":\"h5-page\",\"x5-video-orientation\":\"portraint\"},domProps:{\"muted\":_vm.options.muted},on:{\"play\":_vm.handleVideoPlay,\"playing\":_vm.handleVideoPlaying,\"pause\":function($event){_vm.playing = false},\"dblclick\":_vm.requestFullscreen,\"mousedown\":_vm.handleMouse}},[_c('source',{attrs:{\"src\":_vm.src}})]),(!_vm.options.controls)?_c('div',{staticClass:\"controls\"},[_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":_vm.toggle_play}},[_c('v-icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.playing),expression:\"!playing\"}]},[_vm._v(\"mdi-play\")]),_c('v-icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.playing),expression:\"playing\"}]},[_vm._v(\"mdi-pause\")])],1),_c('select',{staticClass:\"rates\",domProps:{\"value\":_vm.vp.playbackRate},on:{\"change\":function($event){_vm.playbackRate = _vm.vp.playbackRate = +$event.target.value}}},[_c('option',{domProps:{\"value\":0.5}},[_vm._v(\"0.5x\")]),_c('option',{domProps:{\"value\":1}},[_vm._v(\"1.0x\")]),_c('option',{domProps:{\"value\":2}},[_vm._v(\"2.0x\")]),_c('option',{domProps:{\"value\":4}},[_vm._v(\"4.0x\")]),_c('option',{domProps:{\"value\":8}},[_vm._v(\"8.0x\")])]),_c('span',{ref:\"duration\"}),_c('v-slider',{ref:\"slider\",staticClass:\"d-inline-block\",attrs:{\"max\":_vm.vp.duration,\"min\":0,\"value\":_vm.currentTime,\"hide-details\":\"\",\"dark\":\"\",\"dense\":\"\",\"color\":\"white\"},on:{\"change\":function($event){_vm.vp.currentTime = $event}}}),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":_vm.fullscreen}},[_c('v-icon',[_vm._v(\"mdi-fullscreen\")])],1)],1):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"video\"\n  >\n    <!-- video player -->\n    <video\n      class=\"video__player\"\n      ref=\"videoPlayer\"\n      preload=\"auto\"\n      :controls=\"options.controls\"\n      :autoplay=\"options.autoplay\"\n      :muted=\"options.muted\"\n      webkit-playsinline=\"true\"\n      playsinline=\"true\"\n      x-webkit-airplay=\"allow\"\n      x5-video-player-type=\"h5-page\"\n      x5-video-orientation=\"portraint\"\n      :style=\"options.style || {}\"\n      @play=\"handleVideoPlay\"\n      @playing=\"handleVideoPlaying\"\n      @pause=\"playing = false\"\n      @dblclick=\"requestFullscreen\"\n      :key=\"src\"\n      @mousedown=\"handleMouse\"\n    >\n      <source :src=\"src\" />\n    </video>\n    <div class=\"controls\" v-if=\"!options.controls\">\n      <v-btn icon @click=\"toggle_play\"\n        ><v-icon v-show=\"!playing\">mdi-play</v-icon\n        ><v-icon v-show=\"playing\">mdi-pause</v-icon></v-btn\n      >\n      <select\n        class=\"rates\"\n        @change=\"playbackRate = vp.playbackRate = +$event.target.value\"\n        :value=\"vp.playbackRate\"\n      >\n        <option :value=\"0.5\">0.5x</option>\n        <option :value=\"1\">1.0x</option>\n        <option :value=\"2\">2.0x</option>\n        <option :value=\"4\">4.0x</option>\n        <option :value=\"8\">8.0x</option>\n      </select>\n      <span ref=\"duration\"></span>\n      <v-slider\n        :max=\"vp.duration\"\n        :min=\"0\"\n        :value=\"currentTime\"\n        ref=\"slider\"\n        hide-details\n        dark\n        dense\n        class=\"d-inline-block\"\n        @change=\"vp.currentTime = $event\"\n        color=\"white\"\n      ></v-slider>\n      <v-btn icon @click=\"fullscreen\"><v-icon>mdi-fullscreen</v-icon></v-btn>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"VideoPlayer\",\n  props: [\"src\", \"options\"],\n  data() {\n    return {\n      playing: false,\n      vp: {},\n      currentTime: 0,\n      playbackRate: 1,\n    };\n  },\n  methods: {\n    handleVideoPlay(e) {\n      this.$emit(\"play\", e);\n    },\n    handleVideoPlaying(e) {\n      this.playing = true;\n      this.vp = e.target;\n      this.vp.playbackRate = this.playbackRate;\n    },\n    handleMouse(e) {\n      var delta = null;\n      if (e.type && e.type == 'mousedown') {\n        e.cancelBubble = true;\n        if (e.clientX < window.innerWidth / 3) delta = -15;\n        else if (e.clientX > (window.innerWidth * 2) / 3) delta = 15;\n        else delta = 0\n      }\n      if (delta == null) return\n      if (delta == 0) this.toggle_play();\n      else {\n        this.vp.currentTime += delta\n      }\n    },\n    requestFullscreen(e) {\n      e.target.requestFullscreen();\n    },\n    toggle_play() {\n      if (this.playing) this.vp.pause();\n      else this.vp.play();\n    },\n    to_friendly_time(secs) {\n      function _lz(x) {\n        return x < 10 ? \"0\" + x : \"\" + x;\n      }\n      secs = secs | 0;\n      const mins = (secs / 60) % 60 | 0;\n      const hours = (secs / 3600) | 0;\n      secs = secs % 60;\n      if (hours > 0) return `${hours}:${_lz(mins)}:${_lz(secs)}`;\n      else return `${_lz(mins)}:${_lz(secs)}`;\n    },\n    fullscreen() {\n      this.vp.requestFullscreen();\n    },\n    handleKey(e) {\n      if (!this.playing) return\n      switch(e.key) {\n        case \",\":\n          this.vp.currentTime -= 15\n          break\n        case \".\":\n          this.vp.currentTime += 15\n          break\n        case \"/\":\n          this.vp.currentTime = this.vp.duration / 2\n          break\n      }\n    },\n  },\n  mounted() {\n    const vm = this;\n    setInterval(() => {\n      const span = vm.$refs.duration,\n          slider = vm.$refs.slider;\n      if (vm.playing && vm.vp.currentTime && document.activeElement != slider) {  \n        if (span) {\n          span.innerText = `${vm.to_friendly_time(\n            vm.vp.currentTime\n          )}/${vm.to_friendly_time(vm.vp.duration)}`;\n          slider.$el.style.width =\n            window.innerWidth - span.offsetLeft - span.offsetWidth - 70 + \"px\";\n        }\n        vm.currentTime = vm.vp.currentTime;\n      }\n    }, 500);\n  },\n  created() {\n    window.addEventListener('keydown', this.handleKey)\n  },\n  beforeDestroy() {\n    window.removeEventListener('keydown', this.handleKey)\n  }\n};\n</script>\n\n<style scoped>\n.controls {\n  z-index: 101;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  backdrop-filter: blur(5px);\n}\n\nselect.rates {\n  color: white;\n  margin: 5px;\n}\n\nselect.rates option {\n  background: black;\n}\n\n.v-input__slider {\n  margin-top: 2px;\n  margin-bottom: 2px;\n  vertical-align: middle;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoPlayer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoPlayer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./VideoPlayer.vue?vue&type=template&id=24f80ead&scoped=true&\"\nimport script from \"./VideoPlayer.vue?vue&type=script&lang=js&\"\nexport * from \"./VideoPlayer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./VideoPlayer.vue?vue&type=style&index=0&id=24f80ead&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"24f80ead\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"browser\" v-if=\"item\">\n    <video-player\n      :src=\"get_item_video(item)\"\n      :options=\"{\n        muted: false,\n        autoplay: true,\n        style: {\n          width: '100%',\n          height: '100vh',\n        },\n      }\"\n      class=\"video-player\"\n      ref=\"videoPlayer\"\n      v-if=\"browsing_video\"\n    />\n    <div style=\"width: 100%; text-align: center\" @click=\"toggle_fits\" v-else>\n      <div\n        :style=\"{\n          height: '100vh',\n          width: '100%',\n          overflow: 'hidden',\n        }\"\n      >\n        <img\n          v-if=\"item\"\n          :src=\"get_item_image(item)\"\n          alt=\"Browsing Image\"\n          ref=\"browsing_image\"\n          @load=\"fit_image\"\n        />\n      </div>\n    </div>\n    <div class=\"browsing description\">\n      <v-row align=\"end\">\n        <v-col cols=\"2\">\n          <v-pagination\n            v-model=\"browsing_page\"\n            :length=\"3\"\n            :total-visible=\"0\"\n            @previous=\"browse_prev\"\n            @next=\"browse_next\"\n          ></v-pagination>\n        </v-col>\n        <v-col cols=\"10\" class=\"item-description\" v-if=\"item\">\n          <v-row class=\"mt-3 mb-3\">\n            <div class=\"mr-3\" v-if=\"typeof item.rating == 'number'\">\n              <v-rating\n                style=\"display: inline-block\"\n                v-model=\"item.rating\"\n                background-color=\"white\"\n                color=\"yellow accent-4\"\n                half-increments\n                hover\n                size=\"18\"\n                @input=\"$emit('rating', { item: item, val: $event })\"\n              ></v-rating>\n              <span class=\"grey--text text--lighten-2\"\n                >({{ item.rating.toFixed(1) }})\n              </span>\n            </div>\n            <div>\n              <v-btn\n                v-for=\"(filter, page_name) in plugin_pages\"\n                :key=\"page_name\"\n                icon\n                dense\n                :href=\"'/' + querystring_stringify({\n                  q: scope(paragraph) + `;plugin('${format(\n                  filter.format,\n                  {\n                    mediaitem: item,\n                    paragraph: paragraph,\n                  })}')`\n                })\"\n                class=\"t_func sim\"\n                target=\"_blank\"\n                ><v-icon>{{ filter.icon }}</v-icon></v-btn\n              >\n              <v-btn\n                icon\n                dense\n                @click=\"$emit('info', item)\"\n                target=\"_blank\"\n                data-keybind=\"i\"\n                ><v-icon>mdi-information</v-icon></v-btn\n              >\n            </div>\n          </v-row>\n          <ContentView\n            class=\"browsing-content\"\n            :paragraph=\"paragraph\"\n            view_mode=\"gallery-description\"\n          />\n        </v-col>\n      </v-row>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ContentView from \"../components/ContentView.vue\";\nimport VideoPlayer from \"../components/VideoPlayer.vue\";\nimport api from \"../api\";\n\nexport default {\n  name: \"ImageBrowsing\",\n  components: {\n    ContentView,\n    VideoPlayer,\n  },\n  props: [\"paragraph\", \"item\", \"plugin_pages\"],\n  data() {\n    return {\n      browsing_page: 2,\n    };\n  },\n  watch: {\n    item(val) {\n      if (!val || !val.source) this.$emit(\"browse\", \"continue\");\n    },\n  },\n  computed: {\n    browsing_video() {\n      return this.item && this.item.item_type == \"video\";\n    },\n  },\n  methods: {\n    quote(x) {\n      return encodeURIComponent(api.quote(x));\n    },\n    format(str, bundle) {\n      function _replace(_, i) {\n        var b = bundle;\n        for (var k of i.split(\".\")) b = b[k] || \"\";\n        return b;\n      }\n      return (\n        (typeof str == \"string\" && str.replace(/\\{([\\w\\d._]+)\\}/g, _replace)) ||\n        \"\"\n      );\n    },\n    get_item_image(item) {\n      return api.get_item_image(item);\n    },\n    get_item_video(item) {\n      return api.get_item_video(item);\n    },\n    fit_image(e) {\n      const img = e.target,\n        wh = window.innerHeight,\n        ww = window.innerWidth,\n        imgr = img.naturalWidth / img.naturalHeight;\n      const scrr = ww / wh;\n      var nh = 0,\n        nw = 0,\n        transform = \"\",\n        mode = \"\",\n        offsetX = 0,\n        offsetY = 0,\n        rr = imgr < 1 != scrr < 1;\n\n      if (api.config.fit == \"both\" && rr) {\n        mode = 1 / imgr >= scrr ? \"fit-height\" : \"fit-width\";\n        switch (mode) {\n          case \"fit-width\":\n            nh = ww;\n            nw = nh * imgr;\n            offsetX = nh;\n            offsetY = (wh - nw) / 2;\n            break;\n          case \"fit-height\":\n            nw = wh;\n            nh = nw / imgr;\n            offsetX = (nh + ww) / 2;\n            offsetY = 0;\n            break;\n        }\n        transform = \"rotate(90deg)\";\n      } else {\n        switch (api.config.fit) {\n          case \"both\":\n          case \"maximize\":\n            mode = imgr >= scrr ? \"fit-height\" : \"fit-width\";\n            break;\n          default:\n            mode = scrr > 1 ? \"fit-height\" : \"fit-width\";\n        }\n        switch (mode) {\n          case \"fit-width\":\n            nw = ww;\n            nh = ww / imgr;\n            break;\n          case \"fit-height\":\n            nh = wh;\n            nw = nh * imgr;\n            break;\n        }\n        transform = `translate(${(ww - nw) / 2}px, ${(wh - nh) / 2}px)`;\n      }\n      Object.assign(img.style, {\n        height: nh + \"px\",\n        width: nw + \"px\",\n        transform: transform,\n        \"transform-origin\": \"left top\",\n        top: offsetY + \"px\",\n        left: offsetX + \"px\",\n        position: \"absolute\",\n        display: \"block\",\n      });\n    },\n    toggle_fits() {\n      const fits = [\"both\", \"visible\", \"maximize\"];\n      api.config.fit = fits[(fits.indexOf(api.config.fit) + 1) % fits.length];\n      this.fit_image({ target: this.$refs.browsing_image });\n      this.$forceUpdate();\n    },\n    browse_next() {\n      this.$emit(\"browse\", \"arrowright\");\n      this.browsing_page = 2;\n    },\n    browse_prev() {\n      this.$emit(\"browse\", \"arrowleft\");\n      this.browsing_page = 2;\n    },\n    querystring_stringify: api.querystring_stringify,\n    scope: api.scope\n  },\n};\n</script>\n\n<style scoped>\n.browser {\n  overflow: hidden;\n  height: 100vh;\n  width: 100%;\n}\n.description {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  backdrop-filter: blur(5px);\n  background-color: rgba(255, 255, 255, 0.5);\n  opacity: 0;\n}\n.theme--dark .description {\n  background-color: rgba(0, 0, 0, 0.5);\n}\n.description:hover {\n  opacity: 1;\n  z-index: 101;\n}\n</style>\n\n<style>\n.description {\n  border: hidden;\n  background: none;\n  box-shadow: none !important;\n}\n\n.browsing-content {\n  max-height: 30vh;\n  overflow-y: hidden;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageBrowsing.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageBrowsing.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ImageBrowsing.vue?vue&type=template&id=7462d287&scoped=true&\"\nimport script from \"./ImageBrowsing.vue?vue&type=script&lang=js&\"\nexport * from \"./ImageBrowsing.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ImageBrowsing.vue?vue&type=style&index=0&id=7462d287&prod&scoped=true&lang=css&\"\nimport style1 from \"./ImageBrowsing.vue?vue&type=style&index=1&id=7462d287&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7462d287\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <v-dialog :value=\"value\" :fullscreen=\"view_mode == 'file' || view_mode == 'gallery'\" persistent class=\"white-bg\">\n    <v-card\n      flat\n      v-touch=\"{\n        left: () => _event_handler('left'),\n        right: () => _event_handler('right'),\n        down: () => $emit('input', false),\n        up: () => $emit('rating', { item: active_item, inc: 1 }),\n      }\"\n      @wheel=\"_wheel_handler\"\n      :style=\"\n        view_mode == 'gallery' ? { overflow: 'hidden', height: '100%' } : {}\n      \"\n    >\n      <v-card-text>\n        <!-- operation buttons -->\n        <v-row v-if=\"view_mode == 'file'\" class=\"pt-3\">\n          <v-col class=\"heading\">\n            <h3>{{ file }} &nbsp;</h3>\n          </v-col>\n          <v-spacer></v-spacer>\n          <v-btn icon @click=\"_event_handler('right')\" :enabled=\"page > 0\">\n            <v-icon>mdi-chevron-left</v-icon>\n          </v-btn>\n          <v-text-field\n            dense\n            flat\n            type=\"number\"\n            style=\"max-width: 50px\"\n            :value=\"page\"\n            @input=\"try_page\"\n          ></v-text-field>\n          <v-btn icon @click=\"_event_handler('left')\">\n            <v-icon>mdi-chevron-right</v-icon>\n          </v-btn>\n        </v-row>\n        <v-btn v-else icon @click=\"$emit('input', false)\" class=\"close\"\n          ><v-icon>mdi-close</v-icon></v-btn\n        >\n\n        <!-- main view -->\n        <template v-if=\"active_paragraph && active_paragraph.source\">\n          <v-row class=\"main\" v-if=\"view_mode !== 'gallery'\">\n            <div class=\"paragraphs\">\n              <div v-for=\"p in shown_paragraphs\" :key=\"p._id\">\n                <ContentView\n                  :paragraph=\"p\"\n                  item_width=\"100%\"\n                  :view_mode=\"view_mode\"\n                />\n              </div>\n              <div class=\"mt-5 meta\" v-if=\"active_paragraph\">\n                {{ $t(\"date\") }}: {{ active_paragraph.pdate | dateSafe }}<br />\n                {{ $t(\"pagenum\") }}: {{ active_paragraph.pagenum }}\n                <v-btn\n                  icon\n                  small\n                  @click=\"\n                    pagenum_editor.new_pagenum = active_paragraph.pagenum;\n                    pagenum_edit = true;\n                  \"\n                  ><v-icon small>mdi-form-textbox</v-icon></v-btn\n                >\n                <br />\n                {{ $t(\"outline\") }}: {{ active_paragraph.outline }}<br />\n                {{ $t(\"source\") }}:\n                <a\n                  :href=\"active_paragraph.source.url\"\n                  v-if=\"active_paragraph.source.url\"\n                  target=\"_blank\"\n                  >{{ active_paragraph.source.url }}</a\n                >\n                {{ active_paragraph.source.file }}\n                {{ active_paragraph.source.page }}<br />\n              </div>\n            </div>\n            <div class=\"image\" @click=\"show_modal = !!pdf_image\">\n              <img\n                :src=\"pdf_image\"\n                alt=\"\"\n                @load=\"\n                  $event.target.style.height =\n                    window_height - $event.target.offsetTop - 20 + 'px'\n                \"\n              />\n            </div>\n          </v-row>\n          <!-- gallery view, image browser -->\n          <div v-else>\n            <ImageBrowsing\n              :paragraph=\"active_paragraph\"\n              :item=\"active_item\"\n              :plugin_pages=\"plugin_pages\"\n              v-if=\"value\"\n              @info=\"$emit('info', $event)\"\n              @browse=\"_event_handler\"\n            />\n          </div>\n\n          <!-- fullscreen image view -->\n          <v-dialog v-model=\"show_modal\" fullscreen>\n            <v-btn\n              fab\n              fixed\n              icon\n              top\n              right\n              class=\"ma-10\"\n              @click=\"show_modal = false\"\n              ><v-icon>mdi-close</v-icon></v-btn\n            >\n            <img :src=\"pdf_image\" alt=\"\" style=\"width: 100%\" ref=\"image\" />\n          </v-dialog>\n          <v-dialog v-model=\"pagenum_edit\" width=\"unset\">\n            <v-card>\n              <v-card-title\n                >{{ $t(\"edit-pagenum\") }}\n                <v-spacer></v-spacer>\n                <v-btn icon @click=\"pagenum_edit = false\"\n                  ><v-icon>mdi-close</v-icon></v-btn\n                >\n              </v-card-title>\n              <v-card-text>\n                <v-sheet>\n                  <ParamInput\n                    :arg=\"{ name: $t('pagenum'), type: 'int' }\"\n                    v-model=\"pagenum_editor.new_pagenum\"\n                  />\n                  <ParamInput\n                    :arg=\"{\n                      name: $t('modify-mode'),\n                      type: $t('pagenum-modes'),\n                    }\"\n                    v-model=\"pagenum_editor.sequential\"\n                  />\n                  <ParamInput\n                    :arg=\"{ name: $t('folio-mode'), type: 'bool' }\"\n                    v-model=\"pagenum_editor.folio\"\n                  />\n                </v-sheet>\n              </v-card-text>\n              <v-card-actions>\n                <v-btn color=\"primary\" @click=\"save_pagenum\">{{\n                  $t(\"ok\")\n                }}</v-btn>\n              </v-card-actions>\n            </v-card>\n          </v-dialog>\n        </template>\n      </v-card-text>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script>\nimport api from \"../api\";\nimport ParamInput from \"../components/ParamInput.vue\";\nimport ContentView from \"../components/ContentView.vue\";\nimport ImageBrowsing from \"../components/ImageBrowsing.vue\";\n\nexport default {\n  name: \"PageView\",\n  components: {\n    ParamInput,\n    ContentView,\n    ImageBrowsing,\n  },\n  data() {\n    return {\n      file: \"\",\n      page: 0,\n      pdf_image: \"\",\n      show_modal: false,\n      pagenum_edit: false,\n      pagenum_editor: {\n        new_pagenum: 0,\n        sequential: \"all\",\n        folio: false,\n      },\n      fetched_paragraphs: [],\n      mongocollection: \"paragraph\",\n      loading_image: require(\"../../public/assets/loading.png\"),\n      paragraph_index: 0,\n      item_index: 0,\n\n      playing_timer: 0,\n      playing_interval: 1000,\n      last_inc: 1,\n      last_wheel: new Date()\n    };\n  },\n  props: {\n    view_mode: {\n      default: \"file\",\n    },\n    paragraphs: {\n      default: () => [],\n    },\n    start_index: {\n      default: 0,\n    },\n    value: {\n      default: true,\n    },\n    plugin_pages: {\n      default: []\n    }\n  },\n  computed: {\n    window_height() {\n      return window.innerHeight;\n    },\n    active_paragraph() {\n      if (this.view_mode == \"file\") return this.fetched_paragraphs[0];\n      else return Object.assign({}, this.paragraphs[this.paragraph_index]);\n    },\n    active_item() {\n      return (this.active_paragraph_images || [])[this.item_index];\n    },\n    shown_paragraphs() {\n      return this.view_mode !== \"file\"\n        ? [this.active_paragraph]\n        : this.fetched_paragraphs;\n    },\n    active_paragraph_images() {\n      if (\n        this.active_paragraph &&\n        this.active_paragraph.images &&\n        this.active_paragraph.images.length\n      )\n        return this.active_paragraph.images;\n      if (\n        this.active_paragraph &&\n        this.active_paragraph.source &&\n        this.active_paragraph.source.file &&\n        this.active_paragraph.source.file.endsWith(\".pdf\")\n      )\n        return [this.active_paragraph];\n      return [];\n    },\n  },\n  beforeDestroy() {\n    window.removeEventListener(\"keyup\", this._event_handler);\n  },\n  created() {\n    window.addEventListener(\"keyup\", this._event_handler);\n  },\n  mounted() {\n    this.$el.focus();\n    if (!this.paragraph) {\n      let params = window.location.href.split(\"/\");\n      if (!params.includes(\"view\")) return;\n      params = params.slice(params.indexOf(\"view\") + 1);\n      this.mongocollection = params[0];\n      if (params.length > 2) {\n        this.file = decodeURIComponent(params.slice(1, -1).join(\"/\"));\n        this.page = +params.slice(-1)[0];\n      }\n    }\n    this.update_pdfpage();\n  },\n  watch: {\n    value(val) {\n      if (val) {\n        this.paragraph_index = this.start_index;\n        this.item_index = 0;\n        this.update_pdfpage();\n      } else {\n        if (this.playing_timer) window.clearInterval(this.playing_timer);\n      }\n    },\n    paragraphs() {\n      if (this.paragraph_index < 0) {\n        this.paragraph_index = this.paragraphs.length - 1;\n        if (this.view_mode == \"gallery\")\n          this.item_index = this.paragraphs.slice(-1)[0].images.length - 1;\n      }\n    },\n  },\n  methods: {\n    _wheel_handler(e) {\n      if (this.view_mode !== \"gallery\") return;\n      if (new Date() - this.last_wheel > 100) {\n        this._event_handler(e.deltaY > 0 ? \"arrowright\" : \"arrowleft\");\n        this.last_wheel = new Date();\n      }\n      e.preventDefault();\n    },\n    update_pdfpage() {\n      if (this.view_mode == \"file\" && this.file) {\n        var path = location.href.split(\"/\");\n        path.pop();\n        path.push(\"\" + this.page);\n        history.pushState(null, null, path.join(\"/\"));\n      }\n      this.pdf_image = this.loading_image;\n\n      if (this.view_mode == \"file\" && this.file) {\n        api\n          .call(\"quicktask\", {\n            query:\n              \"?\" +\n              api.querify(\n                this.paragraph_id\n                  ? { id: this.paragraph_id }\n                  : { source: { file: this.file, page: this.page } }\n              ),\n            mongocollection: this.mongocollection,\n          })\n          .then((data) => {\n            this.fetched_paragraphs = data.result;\n            if (!data.result.length) {\n              this.fetched_paragraphs = [\n                {\n                  source: {\n                    file: this.file,\n                    page: this.page,\n                  },\n                  keywords: [],\n                  content: \"\",\n                  _id: \"\",\n                },\n              ];\n            }\n          });\n      }\n\n      var src =\n        this.view_mode == \"file\"\n          ? { file: this.file, page: this.page }\n          : this.active_paragraph.source;\n      if (src && src.file && typeof src.page !== \"undefined\") {\n        var image_url = api.get_image_url(src);\n        var image_element = new Image();\n        image_element.src = image_url;\n        image_element.onload = () => {\n          this.pdf_image = image_element.src;\n        };\n      } else {\n        this.pdf_image = \"\";\n      }\n    },\n    playing(interval) {\n      if (this.view_mode !== 'gallery') return\n      if (interval) this.playing_interval = interval;\n      this.playing_timer = setInterval(() => {\n        this._event_handler(\"arrowright\");\n      }, this.playing_interval);\n    },\n    _event_handler(direction) {\n      if (document.getSelection().toString() || !this.value) return;\n\n      if (typeof direction !== \"string\") {\n        // key stroke\n        const e = direction;\n        if (e.target.tagName == \"INPUT\" || e.target.tagName == \"TEXTAREA\")\n          return;\n        if (this.playing_timer) clearInterval(this.playing_timer);\n        direction = e.key.toLowerCase();\n        if (e.shiftKey) direction += 'shift';\n      }\n\n      var inc = 0;\n      switch (direction) {\n        case \"right\":\n        case \"arrowleft\":\n          inc = -1;\n          break;\n        case \"left\":\n        case \"arrowright\":\n          inc = 1;\n          break;\n        case \"arrowleftshift\":\n          inc = -this.item_index - 1;\n          break;\n        case \"arrowrightshift\":\n          inc = this.active_paragraph_images.length - this.item_index;\n          break;\n        case \"continue\":\n          inc = this.last_inc;\n          break;\n        case \"g\":\n          document.querySelector(\".browsing.description a.t_group\").click();\n          break;\n        case \"enter\":\n          this.playing();\n          break;\n        default:\n          var btn = document.querySelector(`[data-keybind=\"${direction}\"]`);\n          if (btn) btn.click();\n          break;\n      }\n\n      if (inc == 0) return;\n      this.last_inc = Math.sign(inc);\n\n      const _paragraph = (inc) => {\n        // paragraph\n        if (\n          this.paragraph_index + inc >= 0 &&\n          this.paragraph_index + inc < this.paragraphs.length\n        ) {\n          this.paragraph_index += inc;\n          if (this.item_index < 0)\n            this.item_index = this.active_paragraph_images.length - 1;\n          else this.item_index = 0;\n          if (\n            this.view_mode == \"gallery\" &&\n            (!this.active_paragraph_images ||\n              this.active_paragraph_images.length == 0)\n          )\n            this._event_handler(direction);\n        } else {\n          this.$emit(inc < 0 ? \"prev\" : \"next\");\n          this.paragraph_index = inc > 0 ? 0 : -1;\n        }\n        this.update_pdfpage();\n      };\n\n      switch (this.view_mode) {\n        case \"file\":\n          this.page = +this.page + inc;\n          this.update_pdfpage();\n          break;\n        case \"gallery\":\n          // previous item\n          if (\n            this.active_paragraph_images &&\n            this.item_index + inc >= 0 &&\n            this.item_index + inc < this.active_paragraph_images.length\n          ) {\n            this.item_index += inc;\n            break;\n          } else {\n            this.item_index = inc > 0 ? 0 : -1;\n            inc = Math.sign(inc)\n          }\n          _paragraph(inc);\n          break;\n        default:\n          _paragraph(inc);\n          break;\n      }\n    },\n    try_page(e) {\n      e = e | 0;\n      this.page = e;\n      this.update_pdfpage();\n    },\n    save_pagenum() {\n      api.call(\n        `collections/${this.mongocollection || \"paragraph\"}/${\n          this.active_paragraph._id\n        }/pagenum`,\n        this.pagenum_editor\n      );\n      this.pagenum_edit = false;\n    },\n  },\n};\n</script>\n\n<style scoped>\n.paragraphs {\n  line-height: 200%;\n}\n\n.main > div {\n  width: 100%;\n}\n\n@media screen and (min-width: 800px) {\n  .main > div {\n    width: 50%;\n  }\n}\n\n.browsing {\n  overflow: hidden;\n}\n\n.close {\n  position: absolute;\n  z-index: 400;\n  right: 30px;\n  top: 30px;\n  border-radius: 20px;\n  border: 0px;\n  background: rgba(255, 255, 255, 0.5);\n}\n\n.theme--dark .close {\n  background: rgba(0, 0, 0, 0.5);\n}\n\n.white-bg {\n  background: white;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PageView.vue?vue&type=template&id=a5c961f0&scoped=true&\"\nimport script from \"./PageView.vue?vue&type=script&lang=js&\"\nexport * from \"./PageView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PageView.vue?vue&type=style&index=0&id=a5c961f0&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a5c961f0\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"fabs\"},[_c('v-badge',{attrs:{\"bordered\":\"\",\"color\":\"green darken-2\",\"content\":'' + _vm.selection_count,\"value\":_vm.selection_count > 0,\"overlap\":\"\"}},[_c('v-btn',{attrs:{\"fab\":\"\",\"small\":\"\"},on:{\"click\":function($event){return _vm.$emit('toggle-selection')},\"dblclick\":function($event){return _vm.$emit('clear-selection')}}},[_c('v-icon',[_vm._v(\"mdi-select-all\")])],1)],1),_c('v-btn',{attrs:{\"fab\":\"\",\"small\":\"\"},on:{\"click\":function($event){return _vm.$emit('tag')}}},[_c('v-icon',[_vm._v(\"mdi-tag\")])],1),_c('v-btn',{attrs:{\"fab\":\"\",\"small\":\"\"},on:{\"click\":function($event){return _vm.$emit('rating')}}},[_c('v-icon',[_vm._v(\"mdi-heart\")])],1),_c('v-btn',{attrs:{\"fab\":\"\",\"small\":\"\"},on:{\"click\":function($event){return _vm.$emit('group')}}},[_c('v-icon',[_vm._v(\"mdi-group\")])],1),_c('v-menu',{attrs:{\"top\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function({ on, attrs }){return [_c('v-btn',_vm._g(_vm._b({attrs:{\"fab\":\"\",\"small\":\"\"}},'v-btn',attrs,false),on),[_c('v-icon',[_vm._v(\"mdi-dots-horizontal\")])],1)]}}])},[_c('v-list',{staticClass:\"pointer\"},[_vm._l((['play', 'merge', 'split', 'reset-storage', 'task']),function(item){return _c('v-list-item',{key:item},[_c('v-list-item-title',{on:{\"click\":function($event){return _vm.$emit(item)}}},[_vm._v(_vm._s(_vm.$t(item)))])],1)}),_c('v-list-item',[_c('v-list-item-title',{on:{\"click\":function($event){return _vm.$emit('delete')}}},[_c('v-icon',[_vm._v(\"mdi-delete\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"delete\"))+\" \")],1)],1)],2)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"fabs\">\n    <v-badge\n      bordered\n      color=\"green darken-2\"\n      :content=\"'' + selection_count\"\n      :value=\"selection_count > 0\"\n      overlap\n    >\n      <v-btn\n        fab\n        small\n        @click=\"$emit('toggle-selection')\"\n        @dblclick=\"$emit('clear-selection')\"\n      >\n        <v-icon>mdi-select-all</v-icon>\n      </v-btn>\n    </v-badge>\n\n    <v-btn fab small @click=\"$emit('tag')\">\n      <v-icon>mdi-tag</v-icon>\n    </v-btn>\n\n    <v-btn fab small @click=\"$emit('rating')\">\n      <v-icon>mdi-heart</v-icon>\n    </v-btn>\n\n    <v-btn fab small @click=\"$emit('group')\">\n      <v-icon>mdi-group</v-icon>\n    </v-btn>\n\n    <v-menu top>\n      <template v-slot:activator=\"{ on, attrs }\">\n        <v-btn fab small v-bind=\"attrs\" v-on=\"on\">\n          <v-icon>mdi-dots-horizontal</v-icon>\n        </v-btn>\n      </template>\n\n      <v-list class=\"pointer\">\n        <v-list-item\n          v-for=\"item in ['play', 'merge', 'split', 'reset-storage', 'task']\"\n          :key=\"item\"\n        >\n          <v-list-item-title @click=\"$emit(item)\">{{\n            $t(item)\n          }}</v-list-item-title>\n        </v-list-item>\n        <v-list-item>\n          <v-list-item-title @click=\"$emit('delete')\">\n            <v-icon>mdi-delete</v-icon>\n            {{ $t(\"delete\") }}\n          </v-list-item-title>\n        </v-list-item>\n      </v-list>\n    </v-menu>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"QuickActionButtons\",\n  props: {\n    selection_count: {\n      type: Number,\n      default: 0,\n    },\n    playing_interval: {\n      default: 1000,\n    },\n  },\n};\n</script>\n\n<style scoped>\n.fabs {\n  position: fixed;\n  z-index: 300;\n  bottom: 50px;\n  right: 10px;\n}\n.fabs > * {\n  margin: 5px;\n  clear: both;\n  display: block;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QuickActionButtons.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QuickActionButtons.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./QuickActionButtons.vue?vue&type=template&id=0bda02b7&scoped=true&\"\nimport script from \"./QuickActionButtons.vue?vue&type=script&lang=js&\"\nexport * from \"./QuickActionButtons.vue?vue&type=script&lang=js&\"\nimport style0 from \"./QuickActionButtons.vue?vue&type=style&index=0&id=0bda02b7&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0bda02b7\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-dialog',{attrs:{\"content-class\":\"dialog-limit\"},model:{value:(_vm.visible),callback:function ($$v) {_vm.visible=$$v},expression:\"visible\"}},[_c('v-card',[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"tagging\")))]),_c('v-card-text',[_c('v-combobox',{ref:\"ac\",attrs:{\"autofocus\":\"\",\"items\":_vm.tag_choices,\"search-input\":_vm.tag_typing,\"loading\":_vm.cancel !== null,\"flat\":\"\",\"multiple\":\"\",\"chips\":\"\",\"deletable-chips\":\"\",\"hide-selected\":\"\",\"auto-select-first\":\"\",\"label\":\"标签\",\"filter\":_vm.match_pattern,\"max-height\":\"180\"},on:{\"update:searchInput\":function($event){_vm.tag_typing=$event},\"update:search-input\":function($event){_vm.tag_typing=$event},\"keyup\":[(e) => (e.key != 'Enter' && (_vm.enter_hit = 0)),function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return (() => (++_vm.enter_hit == 2 ? _vm.do_submit() : null)).apply(null, arguments)}]},model:{value:(_vm.tag_new),callback:function ($$v) {_vm.tag_new=$$v},expression:\"tag_new\"}}),_c('v-expansion-panels',[_c('v-expansion-panel',{key:\"batched\",attrs:{\"dense\":\"\"}},[_c('v-expansion-panel-header',[_vm._v(_vm._s(_vm.$t(\"tag-batch\")))]),_c('v-expansion-panel-content',[_c('v-text-field',{attrs:{\"label\":_vm.$t('text')},model:{value:(_vm.batch),callback:function ($$v) {_vm.batch=$$v},expression:\"batch\"}}),_c('v-text-field',{attrs:{\"label\":_vm.$t('delimiter')},model:{value:(_vm.batch_delim),callback:function ($$v) {_vm.batch_delim=$$v},expression:\"batch_delim\"}}),_c('v-text-field',{attrs:{\"label\":_vm.$t('prefix')},model:{value:(_vm.batch_prefix),callback:function ($$v) {_vm.batch_prefix=$$v},expression:\"batch_prefix\"}})],1)],1),_c('v-expansion-panel',{key:\"author\",attrs:{\"dense\":\"\"}},[_c('v-expansion-panel-header',[_vm._v(_vm._s(_vm.$t(\"author\")))]),_c('v-expansion-panel-content',[_c('v-combobox',{attrs:{\"label\":_vm.$t('text'),\"items\":_vm.author_candidates},model:{value:(_vm.author),callback:function ($$v) {_vm.author=$$v},expression:\"author\"}})],1)],1)],1)],1),_c('v-card-actions',[_c('div',{staticStyle:{\"margin-top\":\"250px\"}},[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.do_submit();}}},[_vm._v(\" \"+_vm._s(_vm.$t(\"ok\"))+\" \")]),_c('v-btn',{on:{\"click\":function($event){_vm.$emit('cancel');\n          _vm.visible = false;}}},[_vm._v(\" \"+_vm._s(_vm.$t(\"cancel\"))+\" \")])],1)])],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-dialog v-model=\"visible\" content-class=\"dialog-limit\">\r\n    <v-card>\r\n      <v-card-title>{{ $t(\"tagging\") }}</v-card-title>\r\n      <v-card-text>\r\n        <v-combobox\r\n          autofocus\r\n          v-model=\"tag_new\"\r\n          :items=\"tag_choices\"\r\n          :search-input.sync=\"tag_typing\"\r\n          :loading=\"cancel !== null\"\r\n          flat\r\n          multiple\r\n          chips\r\n          deletable-chips\r\n          hide-selected\r\n          auto-select-first\r\n          label=\"标签\"\r\n          ref=\"ac\"\r\n          :filter=\"match_pattern\"\r\n          @keyup=\"(e) => (e.key != 'Enter' && (enter_hit = 0))\"\r\n          @keyup.enter=\"() => (++enter_hit == 2 ? do_submit() : null)\"\r\n          max-height=\"180\"\r\n        ></v-combobox>\r\n        <v-expansion-panels>\r\n          <v-expansion-panel dense key=\"batched\">\r\n            <v-expansion-panel-header>{{\r\n              $t(\"tag-batch\")\r\n            }}</v-expansion-panel-header>\r\n            <v-expansion-panel-content>\r\n              <v-text-field v-model=\"batch\" :label=\"$t('text')\"></v-text-field>\r\n              <v-text-field\r\n                v-model=\"batch_delim\"\r\n                :label=\"$t('delimiter')\"\r\n              ></v-text-field>\r\n              <v-text-field\r\n                v-model=\"batch_prefix\"\r\n                :label=\"$t('prefix')\"\r\n              ></v-text-field>\r\n            </v-expansion-panel-content>\r\n          </v-expansion-panel>\r\n          <v-expansion-panel dense key=\"author\">\r\n            <v-expansion-panel-header>{{\r\n              $t(\"author\")\r\n            }}</v-expansion-panel-header>\r\n            <v-expansion-panel-content>\r\n              <v-combobox v-model=\"author\" :label=\"$t('text')\" :items=\"author_candidates\"></v-combobox>\r\n            </v-expansion-panel-content>\r\n          </v-expansion-panel>\r\n        </v-expansion-panels>\r\n      </v-card-text>\r\n      <v-card-actions>\r\n        <div style=\"margin-top: 250px\">        \r\n        <v-btn\r\n          color=\"primary\"\r\n          @click=\"\r\n            do_submit();\r\n          \"\r\n        >\r\n          {{ $t(\"ok\") }}\r\n        </v-btn>\r\n        <v-btn\r\n          @click=\"\r\n            $emit('cancel');\r\n            visible = false;\r\n          \"\r\n        >\r\n          {{ $t(\"cancel\") }}\r\n        </v-btn></div>\r\n      </v-card-actions>\r\n    </v-card>\r\n  </v-dialog>\r\n</template>\r\n\r\n<script>\r\nimport api from \"../api\";\r\n\r\nexport default {\r\n  name: \"TaggingDialog\",\r\n  data() {\r\n    return {\r\n      tag_choices: [],\r\n      cancel: null,\r\n      tag_new: [],\r\n      tag_typing: \"\",\r\n      visible: false,\r\n      batch: \"\",\r\n      batch_delim: \"\",\r\n      batch_prefix: \"\",\r\n      enter_hit: 0,\r\n      author: \"\"\r\n    };\r\n  },\r\n  props: {\r\n    prompt: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    value: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    scope: {\r\n      type: String,\r\n      default: \"\"\r\n    }\r\n  },\r\n  watch: {\r\n    tag_typing(val) {\r\n      val && this.search_tag(val);\r\n    },\r\n    tag_new() {\r\n      if (this.tag_typing) this.tag_typing = \"\";\r\n    },\r\n  },\r\n  computed: {\r\n    author_candidates() {\r\n      return this.tag_new.filter(x => !(x.value || x).startsWith('*')).sort()\r\n    }\r\n  },\r\n  mounted() {\r\n    Object.assign(this, api.config.tagging);\r\n  },\r\n  methods: {\r\n    show(values) {\r\n      var sorted = [...values].sort();\r\n      this.visible = true;\r\n      this.tag_new = sorted;\r\n      this.tag_choices = sorted;\r\n      this.batch = \"\";\r\n      this.author = \"\";\r\n      if (this.scope) {\r\n        api.call(\"term/keywords\", {\r\n          scope: this.scope\r\n        }).then(data=> {\r\n          this.tag_choices = [...sorted, ... data.result]\r\n        })\r\n      }\r\n    },\r\n    escape_search(search) {\r\n      if (search.match(/^[@*]/))\r\n        search = '\\\\' + search[0] + '.*' + api.escape_regex(search.substr(1));\r\n      else\r\n        search = api.escape_regex(search);\r\n      return search\r\n    },\r\n    match_pattern(item, query, item_text) {\r\n      return item_text.match(new RegExp(this.escape_search(query), \"i\"))\r\n    },\r\n    search_tag(search) {\r\n      if (this.cancel) this.cancel.cancel();\r\n      if (search.length == 0 || search == \"*\" || search == \"@\") return;\r\n      this.tag_choices = [...this.tag_new];\r\n      this.cancel = api.cancel_source();\r\n      api\r\n        .call(\r\n          \"term/keywords\",\r\n          {\r\n            pattern: this.escape_search(search),\r\n            regex: true,\r\n          },\r\n          this.cancel\r\n        )\r\n        .then((data) => {\r\n          this.cancel = null;\r\n          this.tag_choices = this.tag_new\r\n            .map((x) => ({\r\n              text: x,\r\n              value: x,\r\n            }))\r\n            .concat(\r\n              data.result.map((x) => ({\r\n                text: x.term,\r\n                value: x.term,\r\n              }))\r\n            );\r\n        })\r\n        .catch((err) => {\r\n          this.cancel = null;\r\n          console.log(err);\r\n          this.tag_choices = [...this.tag_new];\r\n        });\r\n    },\r\n    do_submit() {\r\n      this.enter_hit = 0;\r\n      if (this.author) {\r\n        this.$emit(\"author\", this.author)\r\n        this.author = ''\r\n      }\r\n      if (this.batch)\r\n        this.tag_new.push(\r\n          ...this.batch\r\n            .split(this.batch_delim || \", \")\r\n            .map((x) => x.trim())\r\n            .filter((x) => x)\r\n            .map((x) => this.batch_prefix + x)\r\n        );\r\n      api.config.tagging = {\r\n        batch_delim: this.batch_delim,\r\n        batch_prefix: this.batch_prefix,\r\n      };\r\n      this.$emit(\r\n        \"submit\",\r\n        this.tag_new.map((x) => x.value || x) || [this.tag_typing]\r\n      );\r\n      this.visible = false;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scope>\r\n.dialog-limit {\r\n  max-width: 800px !important;\r\n  width: 75% !important;\r\n  margin: auto;\r\n}\r\n.v-select__selections {\r\n  overflow-x: hidden;\r\n  max-height: 200px;\r\n  overflow-y: auto;\r\n}\r\n.v-chip {\r\n  overflow: initial;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaggingDialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaggingDialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TaggingDialog.vue?vue&type=template&id=003e8633&\"\nimport script from \"./TaggingDialog.vue?vue&type=script&lang=js&\"\nexport * from \"./TaggingDialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TaggingDialog.vue?vue&type=style&index=0&id=003e8633&prod&scope=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-dialog',{attrs:{\"width\":\"unset\"},model:{value:(_vm.show),callback:function ($$v) {_vm.show=$$v},expression:\"show\"}},[_c('v-card',[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"tagging\")))]),_c('v-card-text',{staticStyle:{\"height\":\"150px\"}},[_c('v-autocomplete',{ref:\"ac\",staticClass:\"mx-4\",attrs:{\"autofocus\":\"\",\"items\":_vm.tag_choices,\"loading\":_vm.loading,\"search-input\":_vm.tag_typing,\"multiple\":\"\",\"flat\":\"\",\"hide-no-data\":\"\",\"hide-details\":\"\",\"label\":_vm.$t('tag')},on:{\"update:searchInput\":function($event){_vm.tag_typing=$event},\"update:search-input\":function($event){_vm.tag_typing=$event},\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.do_submit.apply(null, arguments)},\"change\":function($event){_vm.tag_typing = ''}},model:{value:(_vm.tag_new),callback:function ($$v) {_vm.tag_new=$$v},expression:\"tag_new\"}})],1),_c('v-card-actions',[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.do_submit}},[_vm._v(\" \"+_vm._s(_vm.$t(\"ok\"))+\" \")]),_c('v-btn',{on:{\"click\":function($event){return _vm.$emit('input', false)}}},[_vm._v(\" \"+_vm._s(_vm.$t(\"cancel\"))+\" \")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-dialog v-model=\"show\" width=\"unset\">\r\n    <v-card>\r\n      <v-card-title>{{ $t(\"tagging\") }}</v-card-title>\r\n      <v-card-text style=\"height: 150px\">\r\n        <v-autocomplete\r\n          autofocus\r\n          ref=\"ac\"\r\n          v-model=\"tag_new\"\r\n          :items=\"tag_choices\"\r\n          :loading=\"loading\"\r\n          :search-input.sync=\"tag_typing\"\r\n          class=\"mx-4\"\r\n          multiple\r\n          flat\r\n          hide-no-data\r\n          hide-details\r\n          :label=\"$t('tag')\"\r\n          @keyup.enter=\"do_submit\"\r\n          @change=\"tag_typing = ''\"\r\n        ></v-autocomplete>\r\n      </v-card-text>\r\n      <v-card-actions>\r\n        <v-btn color=\"primary\" @click=\"do_submit\"> {{ $t(\"ok\") }} </v-btn>\r\n        <v-btn @click=\"$emit('input', false)\"> {{ $t(\"cancel\") }} </v-btn>\r\n      </v-card-actions>\r\n    </v-card>\r\n  </v-dialog>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"TaggingShortcutsDialog\",\r\n  data() {\r\n    return {\r\n      tag_choices: [],\r\n      loading: false,\r\n      tag_new: [],\r\n      tag_typing: \"\",\r\n      show: false,\r\n    };\r\n  },\r\n  props: {\r\n    choices: {\r\n      default: null,\r\n    },\r\n    bundle: {\r\n      default: () => ({}),\r\n    },\r\n    prompt: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    value: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    multiple: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    initial: String,\r\n    match_initials: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  watch: {\r\n    tag_typing(val) {\r\n      val && this.search_tag(val);\r\n    },\r\n    choices(val) {\r\n      this.tag_choices = val || [];\r\n    },\r\n    value(val) {\r\n      this.show = val;\r\n      if (val) {\r\n        this.tag_new = [];\r\n        this.tag_typing = this.initial;\r\n      }\r\n    },\r\n    show(val) {\r\n      if (!val) this.$emit(\"input\", false);\r\n    },\r\n  },\r\n  mounted() {\r\n    this.tag_choices = this.choices || [];\r\n  },\r\n  methods: {\r\n    search_tag(search) {\r\n      if (!search) return;\r\n      var matched = this.choices.filter((x) => x.text.startsWith(search));\r\n      if (matched.length > 0) {\r\n        if (matched[0].text.startsWith(search + \" \"))\r\n          this.tag_new = Array.from(new Set(this.tag_new.concat(matched[0])));\r\n        if (matched.length > 1) this.tag_typing = search;\r\n        else this.tag_typing = \"\";\r\n      }\r\n      return matched;\r\n    },\r\n    do_submit() {\r\n      this.$emit(\r\n        \"submit\",\r\n        this.tag_new.map((x) => x.value).filter((x) => x)\r\n      );\r\n      this.$emit(\"input\", false);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.v-toolbar {\r\n  position: fixed;\r\n  top: 0;\r\n  z-index: 210;\r\n  width: 100%;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaggingShortcutsDialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaggingShortcutsDialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TaggingShortcutsDialog.vue?vue&type=template&id=736d6737&scoped=true&\"\nimport script from \"./TaggingShortcutsDialog.vue?vue&type=script&lang=js&\"\nexport * from \"./TaggingShortcutsDialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TaggingShortcutsDialog.vue?vue&type=style&index=0&id=736d6737&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"736d6737\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <v-sheet v-if=\"total !== 0\" ref=\"results\" :class=\"config.view_mode\">\r\n    <div class=\"tools\">\r\n      <v-btn-toggle\r\n        mandatory\r\n        class=\"view-mode-toggler\"\r\n        dense\r\n        v-model=\"config.view_mode\"\r\n        @change=\"update_view_mode\"\r\n      >\r\n        <v-btn value=\"list\">\r\n          <v-icon>mdi-view-list</v-icon>\r\n        </v-btn>\r\n        <v-btn value=\"page\">\r\n          <v-icon>mdi-text-long</v-icon>\r\n        </v-btn>\r\n        <v-btn value=\"gallery\">\r\n          <v-icon>mdi-view-module</v-icon>\r\n        </v-btn>\r\n      </v-btn-toggle>\r\n    </div>\r\n    <!-- total results count -->\r\n    <div class=\"count\" v-show=\"total !== null\">\r\n      {{ $t(\"found-results\", { total }) }}\r\n    </div>\r\n    <!-- divider -->\r\n    <v-divider class=\"mt-5 mb-5\"></v-divider>\r\n    <!-- show content -->\r\n    <div class=\"wrapper-container\" ref=\"all_items\" v-if=\"columns.includes('content')\">\r\n      <template v-for=\"(r, index) in visible_data\">\r\n        <div class=\"spacer\" v-if=\"r.spacer\" :key=\"'spacer' + index\"></div>\r\n        <div class=\"paragraph\" :data-id=\"r._id\" v-else :key=\"index\">\r\n          <div class=\"meta\">\r\n            <v-checkbox\r\n              v-model=\"r.selected\"\r\n              dense\r\n              hide-details\r\n              class=\"d-inline-block\"\r\n              @change=\"update_selection(r, null, index)\"\r\n            ></v-checkbox>\r\n            {{ $t(\"dataset\") }}:\r\n            <a\r\n              :href=\"\r\n                '/' +\r\n                querystring_stringify({\r\n                  q: current_q(),\r\n                  selected_datasets: [r.dataset],\r\n                  groups: 'none'\r\n                })\r\n              \"\r\n              target=\"_blank\"\r\n              >{{ r.dataset }}</a\r\n            >\r\n            {{ $t(\"outline\") }}: {{ r.outline }} {{ $t(\"source\") }}:\r\n            <a\r\n              :href=\"\r\n                '/' +\r\n                querystring_stringify({\r\n                  q: `(${current_q()}),source.file=${quote(\r\n                    r.source.file\r\n                  )}`,\r\n                  selected_datasets: [r.dataset],\r\n                  groups: 'none',\r\n                })\r\n              \"\r\n              target=\"_blank\"\r\n              >{{ r.source.file }}</a\r\n            >\r\n            <a :href=\"r.source.url\" target=\"_blank\">{{ r.source.url }}</a>\r\n            {{ $t(\"pagenum\") }}: {{ r.pagenum }} {{ $t(\"date\") }}:\r\n            {{ r.pdate | dateSafe }}\r\n            <v-divider class=\"mt-5\"></v-divider>\r\n          </div>\r\n          <v-img\r\n            v-if=\"config.view_mode == 'gallery'\"\r\n            :class=\"{ selected: r.selected }\"\r\n            @click=\"update_selection(r, $event, index)\"\r\n            @dblclick=\"view_page(index)\"\r\n            :contain=\"config.contain\"\r\n            :height=\"240\"\r\n            :src=\"get_paragraph_image(r)\"\r\n          ></v-img>\r\n          <ContentView\r\n            :key=\"r._id\"\r\n            :view_mode=\"config.view_mode\"\r\n            :paragraph=\"r\"\r\n            :item_width=\"200\"\r\n            :item_height=\"200\"\r\n          />\r\n          <div class=\"mt-10 operations\">\r\n            <v-btn @click=\"view_page(index)\">\r\n              <v-icon>mdi-eye</v-icon> {{ $t(\"view\") }}\r\n            </v-btn>\r\n            <v-btn\r\n              :href=\"`/view/${r.mongocollection}/${\r\n                r.source.file ? r.source.file + '/' + r.source.page : r._id\r\n              }`\"\r\n              target=\"_blank\"\r\n            >\r\n              <v-icon>mdi-dock-window</v-icon> {{ $t(\"browse\") }}\r\n            </v-btn>\r\n            <v-btn\r\n              @click=\"\r\n                dialogs.info.target = r;\r\n                dialogs.info.visible = true;\r\n              \"\r\n            >\r\n              <v-icon>mdi-information</v-icon>\r\n              {{ $t(\"metadata\") }}\r\n            </v-btn>\r\n            <v-btn\r\n              @click=\"\r\n                dialogs.edit.target = r;\r\n                dialogs.edit.visible = true;\r\n              \"\r\n            >\r\n              <v-icon>mdi-file-edit-outline</v-icon>\r\n              {{ $t(\"edit\") }}\r\n            </v-btn>\r\n            <v-menu offset-y>\r\n              <template v-slot:activator=\"{ on, attrs }\">\r\n                <v-btn class=\"d-inline-block\" v-on=\"on\" v-bind=\"attrs\">\r\n                  <v-icon>mdi-send</v-icon>\r\n                  {{ $t(\"send-task\") }}\r\n                </v-btn>\r\n              </template>\r\n              <v-list>\r\n                <v-list-item\r\n                  class=\"pointer\"\r\n                  v-for=\"(item, index) in dialogs.send_task.quicktasks\"\r\n                  :key=\"index\"\r\n                >\r\n                  <v-list-item-title\r\n                    @click=\"\r\n                      set_selection([r]);\r\n                      send_task(item.value);\r\n                    \"\r\n                    >{{ item.text }}</v-list-item-title\r\n                  >\r\n                </v-list-item>\r\n              </v-list>\r\n            </v-menu>\r\n            <v-divider class=\"mt-5 mb-5\"></v-divider>\r\n          </div>\r\n        </div>\r\n      </template>\r\n    </div>\r\n    <!-- show array info -->\r\n    <v-sheet v-else>\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th v-for=\"col in columns\" :key=\"col\">{{ col }}</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"(r, index) in visible_data\" :key=\"index\">\r\n            <td v-for=\"col in columns\" :key=\"col + index\">\r\n              <div v-if=\"Array.isArray(r[col])\">\r\n                <v-btn @click=\"show_embedded(r, col)\">\r\n                  <v-icon>mdi-file</v-icon>\r\n                </v-btn>\r\n              </div>\r\n              <div v-else>\r\n                {{ r[col] }}\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </v-sheet>\r\n    <!-- pagination -->\r\n    <v-row class=\"mt-5\">\r\n      <v-pagination v-model=\"page\" :length=\"pages.length\"></v-pagination>\r\n      <div>\r\n        <label> {{ $t(\"pagenum\") }}</label>\r\n        <v-text-field\r\n          class=\"d-inline-block ml-1\"\r\n          style=\"max-width: 40px\"\r\n          type=\"number\"\r\n          dense\r\n          @change=\"page = parseInt($event) || page\"\r\n        ></v-text-field>\r\n      </div>\r\n      <div>\r\n        <label>{{ $t(\"page-size\") }}</label>\r\n        <v-select\r\n          :items=\"[20, 50, 100, 200]\"\r\n          dense\r\n          class=\"d-inline-block ml-1\"\r\n          style=\"max-width: 50px\"\r\n          v-model=\"config.page_size\"\r\n        ></v-select>\r\n      </div>\r\n    </v-row>\r\n    <!-- dialogs -->\r\n    <PageView\r\n      v-model=\"dialogs.paragraph.visible\"\r\n      class=\"page-view\"\r\n      ref=\"page_view\"\r\n      :paragraphs=\"visible_data\"\r\n      :view_mode=\"config.view_mode\"\r\n      :start_index=\"dialogs.paragraph.start_index\"\r\n      :plugin_pages=\"plugin_pages\"\r\n      @next=\"turn_page(page + 1)\"\r\n      @prev=\"turn_page(page - 1)\"\r\n      @browse=\"browsing = $event\"\r\n      @info=\"\r\n        dialogs.info.visible = true;\r\n        dialogs.info.target = $event;\r\n      \"\r\n      @rating=\"rating\"\r\n    />\r\n    <v-dialog v-model=\"dialogs.info.visible\">\r\n      <v-card>\r\n        <v-card-title>\r\n          <v-btn\r\n            icon\r\n            @click=\"dialogs.info.visible = false\"\r\n            style=\"margin-right: 12px\"\r\n          >\r\n            <v-icon>mdi-close</v-icon>\r\n          </v-btn>\r\n          {{ $t(\"metadata\") }}</v-card-title\r\n        >\r\n        <v-card-text>\r\n          <v-row v-for=\"(v, k) in dialogs.info.target\" :key=\"k\">\r\n            <v-col cols=\"4\">{{ k }}</v-col>\r\n            <v-col cols=\"8\">{{ v }}</v-col>\r\n          </v-row>\r\n        </v-card-text>\r\n        <v-card-actions>\r\n          <v-btn @click=\"dialogs.info.visible = false\"> {{ $t(\"ok\") }} </v-btn>\r\n        </v-card-actions>\r\n      </v-card>\r\n    </v-dialog>\r\n\r\n    <v-dialog v-model=\"dialogs.edit.visible\">\r\n      <v-card>\r\n        <v-card-title\r\n          >{{ $t(\"edit-paragraph\") }} {{ dialogs.edit.target._id }}\r\n          <v-spacer></v-spacer>\r\n          <v-btn icon @click=\"dialogs.edit.visible = false\"\r\n            ><v-icon>mdi-close</v-icon></v-btn\r\n          ></v-card-title\r\n        >\r\n        <v-card-text>\r\n          <v-list>\r\n            <v-list-item v-for=\"(field, key) in dialogs.edit.target\" :key=\"key\">\r\n              <v-list-item-content>\r\n                <ParamInput\r\n                  v-model=\"dialogs.edit.target[key]\"\r\n                  :arg=\"{ type: typeof field, name: key, default: '\\'\\'' }\"\r\n                  v-if=\"\r\n                    !(\r\n                      ['_id', 'matched_content'].includes(key) ||\r\n                      typeof field == 'object'\r\n                    )\r\n                  \"\r\n                />\r\n              </v-list-item-content>\r\n            </v-list-item>\r\n            <v-list-item>\r\n              <v-list-item-content>\r\n                <ParamInput\r\n                  v-model=\"dialogs.edit.new_field\"\r\n                  :arg=\"{ type: 'string', name: '新字段', default: '' }\"\r\n                />\r\n                <v-btn\r\n                  @click=\"\r\n                    dialogs.edit.target[dialogs.edit.new_field] = '';\r\n                    $forceUpdate();\r\n                  \"\r\n                >\r\n                  <v-icon>mdi-plus</v-icon>\r\n                </v-btn>\r\n              </v-list-item-content>\r\n            </v-list-item>\r\n          </v-list>\r\n        </v-card-text>\r\n        <v-card-actions>\r\n          <v-btn color=\"primary\" @click=\"save()\">{{ $t(\"save\") }}</v-btn>\r\n          <v-btn @click=\"dialogs.edit.visible = false\">{{\r\n            $t(\"cancel\")\r\n          }}</v-btn>\r\n        </v-card-actions>\r\n      </v-card>\r\n    </v-dialog>\r\n\r\n    <v-dialog v-model=\"dialogs.embedded.visible\">\r\n      <v-card>\r\n        <v-card-title>\r\n          {{ $t(\"view\") }} {{ querify(dialogs.embedded.target.source) }}\r\n          <v-spacer></v-spacer>\r\n          <v-btn icon @click=\"dialogs.embedded.visible = false\"\r\n            ><v-icon>mdi-close</v-icon></v-btn\r\n          >\r\n        </v-card-title>\r\n        <v-card-text>\r\n          <ResultsView\r\n            @load=\"\r\n              (a) =>\r\n                a.callback({ offset: 0, result: dialogs.embedded.target.arr })\r\n            \"\r\n            :total=\"(dialogs.embedded.target.arr || []).length\"\r\n          />\r\n        </v-card-text>\r\n      </v-card>\r\n    </v-dialog>\r\n\r\n    <v-dialog v-model=\"dialogs.send_task.visible\">\r\n      <v-card>\r\n        <v-card-title>\r\n          {{ $t(\"send-task\") }}\r\n          <v-spacer></v-spacer>\r\n          <v-btn icon @click=\"dialogs.send_task.visible = false\"\r\n            ><v-icon>mdi-close</v-icon></v-btn\r\n          >\r\n        </v-card-title>\r\n        <v-card-text class=\"mt-5\">\r\n          <v-row>\r\n            <v-col>\r\n              <v-autocomplete\r\n                dense\r\n                :label=\"$t('send-to')\"\r\n                :items=\"dialogs.send_task.quicktasks\"\r\n                v-model=\"dialogs.send_task.pipeline\"\r\n              ></v-autocomplete>\r\n              <v-btn\r\n                color=\"primary\"\r\n                dense\r\n                @click=\"$refs.quicktask_results.start(1)\"\r\n                ><v-icon>mdi-fast-forward</v-icon> {{ $t(\"run-now\") }}</v-btn\r\n              >\r\n            </v-col>\r\n          </v-row>\r\n          <v-sheet>\r\n            <ResultsView\r\n              @load=\"quicktask\"\r\n              ref=\"quicktask_results\"\r\n              :total=\"dialogs.send_task.results_count\"\r\n            />\r\n          </v-sheet>\r\n        </v-card-text>\r\n      </v-card>\r\n    </v-dialog>\r\n\r\n    <tagging-shortcuts-dialog\r\n      v-model=\"dialogs.tagging_shortcuts.visible\"\r\n      :choices=\"dialogs.tagging_shortcuts.list\"\r\n      :initial=\"dialogs.tagging_shortcuts.initial\"\r\n      :multiple=\"false\"\r\n      :match_initials=\"true\"\r\n      @submit=\"tag($event, true)\"\r\n    ></tagging-shortcuts-dialog>\r\n\r\n    <tagging-dialog\r\n      ref=\"tagging_dialog\"\r\n      :choices=\"dialogs.tagging.choices\"\r\n      :scope=\"scope(selected_paragraphs())\"\r\n      @submit=\"tag($event, false)\"\r\n      @author=\"set_author\"\r\n    ></tagging-dialog>\r\n\r\n    <QuickActionButtons\r\n      :selection_count=\"selection_count\"\r\n      @toggle-selection=\"toggle_selection\"\r\n      @clear-selection=\"clear_selection\"\r\n      @delete=\"delete_items\"\r\n      @rating=\"rating(0.5)\"\r\n      @group=\"group\"\r\n      @tag=\"show_tagging_dialog\"\r\n      @merge=\"merge\"\r\n      @split=\"split\"\r\n      @task=\"send_task\"\r\n      @play=\"playing\"\r\n      :playing_interval=\"config.playing_interval\"\r\n      @reset-storage=\"reset_storage\"\r\n    />\r\n  </v-sheet>\r\n  <v-sheet v-else ref=\"results\">未找到匹配的结果。</v-sheet>\r\n</template>\r\n\r\n<script>\r\nimport ParamInput from \"./ParamInput\";\r\nimport PageView from \"../views/PageView.vue\";\r\nimport ContentView from \"./ContentView.vue\";\r\nimport QuickActionButtons from \"./QuickActionButtons\";\r\nimport TaggingDialog from \"./TaggingDialog.vue\";\r\nimport TaggingShortcutsDialog from \"./TaggingShortcutsDialog.vue\";\r\nimport api from \"../api\";\r\nexport default {\r\n  name: \"ResultsView\",\r\n  props: {\r\n    load: {},\r\n  },\r\n  components: {\r\n    ParamInput,\r\n    PageView,\r\n    ContentView,\r\n    QuickActionButtons,\r\n    TaggingDialog,\r\n    TaggingShortcutsDialog,\r\n  },\r\n  data() {\r\n    return {\r\n      total: 0,\r\n      page: 1,\r\n      value: [],\r\n      token: null,\r\n      page_range: [0, 0],\r\n      plugin_pages: [],\r\n      sticky: [],\r\n      config: new Proxy(api.config, {\r\n        get(target, name) {\r\n          return target[name];\r\n        },\r\n        set(target, name, val) {\r\n          target[name] = val;\r\n          this.$forceUpdate();\r\n        },\r\n      }),\r\n      // dialog bools\r\n      dialogs: {\r\n        embedded: {\r\n          visible: false,\r\n          target: {},\r\n        },\r\n        edit: {\r\n          visible: false,\r\n          target: {},\r\n          new_field: \"\",\r\n        },\r\n        paragraph: {\r\n          visible: false,\r\n          start_index: 0,\r\n          item: {},\r\n        },\r\n        info: {\r\n          visible: false,\r\n          target: {},\r\n        },\r\n        send_task: {\r\n          visible: false,\r\n          quicktasks: [],\r\n          pipeline: [],\r\n          results_count: null,\r\n        },\r\n        tagging_shortcuts: {\r\n          visible: false,\r\n          list: [],\r\n          initial: \"\",\r\n        },\r\n        tagging: {\r\n          visible: false,\r\n          choices: [],\r\n        },\r\n      },\r\n      // selection\r\n      selection: [],\r\n      browsing_item: {},\r\n      selection_count: 0,\r\n      select_index: -1,\r\n      last_key: \"\",\r\n    };\r\n  },\r\n  watch: {\r\n    page(val) {\r\n      this.turn_page(val);\r\n    },\r\n    'dialogs.paragraph.visible': function (val) {\r\n      if (!val && this.$refs.page_view.active_paragraph) {\r\n        var ele = document.querySelector(`[data-id=\"${this.$refs.page_view.active_paragraph._id}\"]`)\r\n        window.scrollTo(0, ele.offsetTop)\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    pages() {\r\n      var p = [];\r\n      var total = (this.total || this.value.length);\r\n      if (this.total == -1) total = 1000 * 200;\r\n      for (\r\n        let index = 0, i = 1;\r\n        index < total && i <= 1000;\r\n        index += api.config.page_size, i++\r\n      ) {\r\n        p.push(i);\r\n      }\r\n      return p;\r\n    },\r\n    visible_data() {\r\n      return [\r\n        ...this.sticky,\r\n        ...this.value\r\n          .slice(this.offset - this.page_range[0])\r\n          .slice(0, api.config.page_size),\r\n      ];\r\n    },\r\n    offset() {\r\n      return (this.page - 1) * api.config.page_size;\r\n    },\r\n    columns() {\r\n      var cols = new Set();\r\n      for (var r of this.visible_data) {\r\n        for (var k in r) cols.add(k);\r\n      }\r\n      return Array.from(cols).sort();\r\n    },\r\n  },\r\n  mounted() {\r\n    this.start();\r\n\r\n    api.call(\"plugins/shortcuts\").then((data) => {\r\n      data = data.result;\r\n      for (var k in data)\r\n        this.dialogs.tagging_shortcuts.list.push({\r\n          text: `${k} ${data[k]}`,\r\n          value: data[k],\r\n        });\r\n    });\r\n\r\n    api.call(\"tasks/shortcuts\").then(\r\n      (data) =>\r\n        (this.dialogs.send_task.quicktasks = data.result.map((task) => ({\r\n          text: task.name,\r\n          value: task.pipeline,\r\n        })))\r\n    );\r\n\r\n    api\r\n      .call(\"plugins/filters\")\r\n      .then((data) => (this.plugin_pages = data.result));\r\n  },\r\n  created() {\r\n    window.addEventListener(\"keyup\", this._keyup_handler);\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener(\"keyup\", this._keyup_handler);\r\n  },\r\n  methods: {\r\n    _fetched() {\r\n      return (\r\n        this.page_range[0] <= this.offset && this.page_range[1] > this.offset\r\n      );\r\n    },\r\n    current_q() {\r\n      return api.querystring_parse(location.search).q || '';\r\n    },\r\n    start(page) {\r\n      this.page_range = [0, 0];\r\n      let params = api.querystring_parse(location.search);\r\n      if (!page)\r\n        if (params.page) page = params.page | 0;\r\n        else page = 1;\r\n      this.turn_page(page);\r\n    },\r\n    querify: api.querify,\r\n    turn_page(p, cb) {\r\n      if (p === 0) return;\r\n      \r\n      function _preload(items) {\r\n      // preload images for every item\r\n        items.map((x) => {\r\n          if (x.images) {\r\n            [... x.images.slice(0, 5), ... x.images.slice(-1)].map((i) => {\r\n              if (i.item_type == 'image') {\r\n                let image = new Image()\r\n                image.src = api.get_item_image(i)\r\n              }\r\n            })\r\n          }\r\n        })\r\n      }\r\n      \r\n      history.pushState(\r\n        \"\",\r\n        \"\",\r\n        api.querystring_stringify(\r\n          Object.assign(api.querystring_parse(location.search), {\r\n            page: this.page,\r\n          })\r\n        )\r\n      );\r\n      if (this.page !== p) this.page = p;\r\n      window.scroll({ top: this.$refs.results.offsetTop - 64 });\r\n      if (!this._fetched()) {\r\n        this.total = null;\r\n        this.$emit(\"load\", {\r\n          offset: this.offset,\r\n          limit: api.config.page_size * 5,\r\n          callback: (data) => {\r\n            if (this.token > data.token) return;\r\n            this.token = data.token;\r\n\r\n            if (typeof data.result !== \"undefined\") {\r\n\r\n              if (Array.isArray(data.result) && !data.result.length) {\r\n                if (this.page > 1) this.page = 1;\r\n                return\r\n              }\r\n\r\n              this.selection = [];\r\n              this.page_range = [data.offset, data.offset + data.result.length];\r\n              var items = data.result.map((x) =>\r\n                Object.assign(x, { selected: false })\r\n              );\r\n\r\n              var has_sticky = items.filter((x) => x.spacer).length > 0;\r\n              if (has_sticky) {\r\n                var sticky_flag = true;\r\n                this.sticky = [];\r\n                this.value = [];\r\n                for (var item of items) {\r\n                  (sticky_flag ? this.sticky : this.value).push(item);\r\n                  if (item.spacer) sticky_flag = false;\r\n                }\r\n              } else {\r\n                this.sticky = [];\r\n                this.value = items;\r\n              }\r\n\r\n              _preload(this.visible_data)\r\n              if (typeof cb == \"function\") cb();\r\n            }\r\n\r\n            if (typeof data.total !== \"undefined\") this.total = data.total;\r\n\r\n            this.$forceUpdate();\r\n          },\r\n        });\r\n      } else {\r\n        _preload(this.visible_data)\r\n        if (typeof cb == \"function\") cb();\r\n      }\r\n    },\r\n    update_view_mode() {\r\n      this.start()\r\n    },\r\n    show_embedded(r, col) {\r\n      var source = Object.assign({}, r);\r\n      delete source[col];\r\n      this.embedded = { arr: r[col], source };\r\n    },\r\n    view_page(index) {\r\n      this.dialogs.paragraph.visible = true;\r\n      this.dialogs.paragraph.start_index = index;\r\n      this.clear_selection();\r\n    },\r\n    playing() {\r\n      if (api.config.view_mode != \"gallery\") return;\r\n      this.view_page(0);\r\n      this.$refs.page_view.playing(api.config.playing_interval);\r\n    },\r\n    _keyup_handler(e) {\r\n      if (e.target.tagName == \"INPUT\" || e.target.tagName == \"TEXTAREA\") return;\r\n      \r\n      var selection_inc = 0, ele;\r\n      var selection_line_number;\r\n      if(this.$refs.all_items && document.querySelector('.paragraph'))\r\n        selection_line_number = parseInt( this.$refs.all_items.clientWidth / document.querySelector('.paragraph').clientWidth)\r\n          \r\n      switch (e.key.toLowerCase()) {\r\n        case \"arrowleft\":\r\n          if (!this.dialogs.paragraph.visible) this.turn_page(this.page - 1);\r\n          break;\r\n        case \"arrowright\":\r\n          if (!this.dialogs.paragraph.visible) this.turn_page(this.page + 1);\r\n          break;\r\n        case \"f\":\r\n          this.toggle_selection();\r\n          break;\r\n        case \"g\":\r\n          this.group(e.altKey || e.ctrlKey);\r\n          break;\r\n        case \"p\":\r\n          e.altKey || e.ctrlKey ? this.split() : this.merge();\r\n          break;\r\n        case \"t\":\r\n        case \"@\":\r\n          this.show_tagging_dialog();\r\n          break;\r\n        case \"n\":\r\n          this.tag([`noted:${new Date().toISOString()}`]);\r\n          break;\r\n        case \"d\":\r\n        case \"-\":\r\n        case \"delete\":\r\n          if (this.last_key == e.key && this.selected_paragraphs().length > 0) {\r\n            this.delete_items();\r\n            this.last_key = null;\r\n          }\r\n          break;\r\n        case \"q\":\r\n        case \"`\":\r\n        case \"escape\":\r\n          this.dialogs.paragraph.visible = false;\r\n          this.clear_selection();\r\n          break;\r\n        case \"a\":\r\n        case \"arrowup\":\r\n        case \"arrowdown\":\r\n          if (this.selected_items().length)\r\n            this.rating(e.key != \"ArrowDown\" ? 0.5 : -0.5);\r\n          break;\r\n        case \"r\":\r\n          if (this.last_key == e.key && this.selected_paragraphs().length > 0) {\r\n            this.reset_storage();\r\n            this.last_key = null;\r\n          }\r\n          break;\r\n        case \"c\":\r\n        case \"z\":\r\n        case \"o\":\r\n        case \"i\":\r\n          if (e.ctrlKey || e.metaKey) return;\r\n          if (this.selected_paragraphs().length > 0) {\r\n            var _album = this.selected_paragraphs()[0];\r\n            switch (e.key.toLowerCase()) {\r\n              case \"o\":\r\n                this._open_window(_album.source.url);\r\n                break;\r\n              case \"c\":\r\n                if (e.ctrlKey) return;\r\n                this._open_window({\r\n                  q: `author=${\r\n                    api.quote(_album.author) ||\r\n                    _album.keywords.filter((x) => x.startsWith(\"@\"))[0] ||\r\n                    \"\"\r\n                  }`,\r\n                  groups: 'none'\r\n                });\r\n                break;\r\n              case \"z\":\r\n                this._open_window(\r\n                  !e.shiftKey\r\n                    ? `/?q=id%3D${_album._id}=>expand()&groups=none`\r\n                    : `/?q=source.url%25%27${api\r\n                        .escape_regex(_album.source.url)\r\n                        .replace(/\\/\\d+\\//, \"/.*/\")}'`\r\n                );\r\n                break;\r\n              case \"i\":\r\n                this.dialogs.info.visible = !this.dialogs.info.visible;\r\n                this.dialogs.info.target = this.selected_paragraphs()[0];\r\n                break;\r\n            }\r\n          }\r\n          break;\r\n        case \"h\":\r\n        case \"j\":\r\n        case \"k\":\r\n        case \"l\":\r\n        case \";\":\r\n          // move selection in vim favor\r\n          switch (e.key.toLowerCase()) {\r\n            case \"h\":\r\n              selection_inc = -1;\r\n              break\r\n            case \"j\":\r\n              selection_inc = selection_line_number;\r\n              break\r\n            case \"k\":\r\n              selection_inc = -selection_line_number;\r\n              break\r\n            case \"l\":\r\n              selection_inc = 1;\r\n              break;\r\n            case \";\":\r\n              selection_inc = 0;\r\n              break;\r\n          }\r\n          if (this.select_index < 0) selection_inc = 0;\r\n          else selection_inc = Math.min(Math.max(0, this.select_index + selection_inc), this.visible_data.length);\r\n          if (!e.ctrlKey && !e.shiftKey) {\r\n            this.clear_selection();\r\n          }\r\n          this.update_selection(this.visible_data[selection_inc], e, selection_inc);\r\n          ele = document.querySelector(`[data-id=\"${this.visible_data[selection_inc]._id}\"]`);\r\n          window.scrollTo(0, ele.offsetTop - ele.clientHeight)\r\n          this.select_index = selection_inc;\r\n          break;\r\n        case \"0\":\r\n        case \"1\":\r\n        case \"2\":\r\n        case \"3\":\r\n        case \"4\":\r\n        case \"5\":\r\n        case \"6\":\r\n        case \"7\":\r\n        case \"8\":\r\n        case \"9\":\r\n          this.dialogs.tagging_shortcuts.visible =\r\n            this.selected_paragraphs().length > 0;\r\n          this.dialogs.tagging_shortcuts.initial = e.key;\r\n          break;\r\n        default:\r\n          var pages = Object.values(this.plugin_pages).filter(\r\n            (x) => x.keybind == e.key\r\n          );\r\n          if (pages.length) {\r\n            this._open_window({\r\n              archive: true,\r\n              q: `${this.scope(this.selected_paragraphs()[0])};plugin('${this.format(pages[0].format, {\r\n                mediaitem: this.selected_items()[0],\r\n                paragraph: this.selected_paragraphs()[0],\r\n              })}')`,\r\n            });\r\n          }\r\n          break;\r\n      }\r\n\r\n      this.last_key = this.last_key === null ? \"\" : e.key;\r\n    },\r\n    save() {\r\n      api\r\n        .call(\r\n          `collections/${\r\n            this.dialogs.edit.target.mongocollection || \"paragraph\"\r\n          }/${this.dialogs.edit.target._id}`,\r\n          this.dialogs.edit.target\r\n        )\r\n        .then(() => {\r\n          this.dialogs.edit.target = null;\r\n          api.notify({ title: this.$t(\"saved\") });\r\n        });\r\n    },\r\n    send_task(target) {\r\n      this.dialogs.send_task.visible = true;\r\n      if (target) {\r\n        this.dialogs.send_task.pipeline = target;\r\n        this.$refs.quicktask_results.start(1);\r\n      }\r\n    },\r\n    format(str, bundle) {\r\n      function _replace(_, i) {\r\n        var b = bundle;\r\n        for (var k of i.split(\".\")) b = b[k] || \"\";\r\n        return b;\r\n      }\r\n      return (\r\n        (typeof str == \"string\" && str.replace(/\\{([\\w\\d._]+)\\}/g, _replace)) ||\r\n        \"\"\r\n      );\r\n    },\r\n    quicktask(e) {\r\n      api\r\n        .call(\"quicktask\", {\r\n          pipeline: [\r\n            [\r\n              \"JSONDataSource\",\r\n              {\r\n                content: JSON.stringify(\r\n                  this.selected_paragraphs().map((x) =>\r\n                    Object.assign({}, x, { matched_content: null })\r\n                  )\r\n                ),\r\n              },\r\n            ],\r\n            ...this.dialogs.send_task.pipeline.slice(1),\r\n          ],\r\n        })\r\n        .then((data) => {\r\n          e.callback({\r\n            result: data.result,\r\n            offset: 0,\r\n            total: data.result.length,\r\n            token: new Date().getTime(),\r\n          });\r\n        });\r\n    },\r\n    _open_window(url) {\r\n      if (typeof url === \"object\") url = \"/\" + api.querystring_stringify(url);\r\n      window.open(url);\r\n    },\r\n    _show_dialog(dialog) {\r\n      this.drawer = false;\r\n      this.dialogs[dialog] = true;\r\n    },\r\n    fav(r) {\r\n      api.fav(r);\r\n    },\r\n    favored(r) {\r\n      return api.favored(r);\r\n    },\r\n    quote: api.quote,\r\n    selected_paragraphs() {\r\n      if (this.dialogs.paragraph.visible) {\r\n        return this.visible_data.filter(\r\n          (x) => x._id == this.$refs.page_view.active_paragraph._id\r\n        );\r\n      } else {\r\n        return [...this.selection];\r\n      }\r\n    },\r\n    selected_items() {\r\n      if (this.dialogs.paragraph.visible) {\r\n        return [\r\n          Object.assign({}, this.$refs.page_view.active_item, {\r\n            paragraph_id: this.selected_paragraphs()[0]._id,\r\n          }),\r\n        ];\r\n      } else {\r\n        return this.selected_paragraphs().reduce(\r\n          (y, e) =>\r\n            y.concat(\r\n              e.images.map((i) => {\r\n                if (!i.paragraph_id) i.paragraph_id = e._id;\r\n                return i;\r\n              })\r\n            ),\r\n          []\r\n        );\r\n      }\r\n    },\r\n    selected_ids() {\r\n      return this.selected_paragraphs().map((x) => x._id);\r\n    },\r\n    // api calls\r\n    update_selection(r, e, index) {\r\n      var s = [];\r\n      if (e && e.shiftKey && this.select_index >= 0) {\r\n        document.getSelection().removeAllRanges();\r\n        let sel_start = Math.min(this.select_index, index),\r\n          sel_end = Math.max(this.select_index, index);\r\n        for (var i = sel_start; i <= sel_end; ++i) {\r\n          if (i == this.select_index || this.visible_data[i].spacer) continue;\r\n          s.push(this.visible_data[i]);\r\n        }\r\n      } else {\r\n        s = [r];\r\n      }\r\n\r\n      this.select_index = index;\r\n      for (var it of s) {\r\n        if (e) it.selected = !it.selected;\r\n        if (it._id && it.selected) this.selection.push(it);\r\n        else this.selection.splice(this.selection.indexOf(it), 1);\r\n      }\r\n\r\n      this.selection_count = this.selection.length;\r\n    },\r\n    set_selection(sel) {\r\n      this.clear_selection();\r\n      sel.forEach((x) => (x.selected = true));\r\n      this.selection = sel;\r\n      this.selection_count = this.selection.length;\r\n    },\r\n    toggle_selection() {\r\n      this.visible_data.forEach((x) => (x.selected = !x.selected));\r\n      this.selection = this.visible_data.filter((x) => x._id && x.selected);\r\n      this.selection_count = this.selection.length;\r\n    },\r\n    clear_selection(s) {\r\n      if (typeof s === \"undefined\") s = this.visible_data;\r\n      s.forEach((x) => {\r\n        x.selected = false;\r\n        this.selection.splice(this.selection.indexOf(x), 1);\r\n      });\r\n      this.selection_count = this.selection.length;\r\n    },\r\n    show_tagging_dialog() {\r\n      if (this.selected_paragraphs().length > 0) {\r\n        var existing_tags = new Set(\r\n          this.selected_paragraphs().reduce((a, e) => a.concat(e.keywords), [])\r\n        );\r\n        this.$refs.tagging_dialog.show(Array.from(existing_tags));\r\n      }\r\n    },\r\n    set_author(author) {\r\n      var s = this.selected_paragraphs();\r\n      if (!s || !s.length) return;\r\n      api\r\n        .call(\r\n          `collections/${s[0].mongocollection || \"paragraph\"}/batch`,\r\n          {\r\n            ids: this.selected_ids(),\r\n            author,\r\n            $push: {keywords: author}\r\n          }\r\n        )\r\n        .then((data) => {\r\n          this.clear_selection(s);\r\n          s.forEach((p) => {\r\n            data.result[p._id] && (p.author = data.result[p._id].author);\r\n          });\r\n        });\r\n    },\r\n    tag(e, append = true) {\r\n      var s = this.selected_paragraphs();\r\n      if (!s || !s.length) return;\r\n\r\n      var existing_tags = new Set(\r\n        this.selected_paragraphs().reduce((a, e) => a.concat(e.keywords), [])\r\n      );\r\n      var push = append ? e : e.filter((x) => !existing_tags.has(x)),\r\n        pull = append\r\n          ? []\r\n          : Array.from(existing_tags).filter((x) => !e.includes(x));\r\n      var updates = {\r\n        ids: this.selected_ids(),\r\n        $push: { keywords: push },\r\n        $pull: { keywords: pull },\r\n      };\r\n      if (push.filter((x) => x.startsWith(\"@\")))\r\n        updates.author = push.filter((x) => x.startsWith(\"@\"))[0];\r\n      else if (pull.filter((x) => x.startsWith(\"@\"))) updates.author = \"\";\r\n\r\n      api\r\n        .call(\r\n          `collections/${s[0].mongocollection || \"paragraph\"}/batch`,\r\n          updates\r\n        )\r\n        .then((data) => {\r\n          this.clear_selection(s);\r\n          s.forEach((p) => {\r\n            data.result[p._id] && (p.keywords = data.result[p._id].keywords);\r\n          });\r\n        });\r\n    },\r\n    select_paragraph_item_objects(s) {\r\n\r\n      var album_items = {},\r\n        visible_album_items = {};\r\n\r\n      this.selected_items().forEach((item) => {\r\n        if (!album_items[item.paragraph_id])\r\n          album_items[item.paragraph_id] = [];\r\n        album_items[item.paragraph_id].push(item._id);\r\n      });\r\n\r\n      s.forEach((p) => {\r\n        if (!visible_album_items[p._id]) visible_album_items[p._id] = [];\r\n        visible_album_items[p._id].splice(\r\n          0,\r\n          0,\r\n          ...(this.dialogs.paragraph.visible\r\n            ? this.selected_items().map((i) => i._id)\r\n            : p.images.map((i) => i._id))\r\n        );\r\n      });\r\n\r\n      return {\r\n        album_items, visible_album_items\r\n      }\r\n\r\n    },\r\n    delete_items() {\r\n      var s = this.selected_paragraphs();\r\n      var objs = this.select_paragraph_item_objects(s);\r\n      api\r\n        .call(\"mediaitem/delete\", {\r\n          album_items: objs.album_items,\r\n        })\r\n        .then(() => {\r\n          s.forEach((x) => {\r\n            x.images = x.images.filter(\r\n              (i) => !objs.visible_album_items[x._id].includes(i._id)\r\n            );\r\n          });\r\n          this.clear_selection(s);\r\n        });\r\n    },\r\n    rating(val) {\r\n      var s = this.selected_paragraphs();\r\n      if (typeof val === \"number\") {\r\n        val = {\r\n          inc: val,\r\n          least: val > 0 ? 1 : -1,\r\n        };\r\n      }\r\n      val.ids = (val.item ? [val.item] : this.selected_items()).map(\r\n        (x) => x._id\r\n      );\r\n      if (val.item) delete val.item;\r\n      if (api.config.view_mode == \"gallery\") {\r\n        api.call(\"mediaitem/rating\", val).then((data) => {\r\n          data = data.result || {};\r\n          this.clear_selection(s);\r\n          s.forEach((p) =>\r\n            p.images.forEach(\r\n              (i) =>\r\n                typeof data[i._id] !== \"undefined\" && (i.rating = data[i._id])\r\n            )\r\n          );\r\n        });\r\n      } else {\r\n        // fav paragraphs\r\n        s.forEach((x) => this.fav(x));\r\n        this.clear_selection(s);\r\n      }\r\n    },\r\n    group(del) {\r\n      var s = this.selected_paragraphs();\r\n      if (!s || !s.length) return;\r\n      var bundle = {\r\n          ids: this.selected_ids(),\r\n          ungroup: del,\r\n        }\r\n      if (!del && s.length == this.visible_data.length && s.map(x => x.keywords.filter(x => x.match(/^\\*[^0]/))).reduce((p, c) => p.concat(c)).length == 0) {\r\n        var cond = this.current_q().replace(/[()\"`'%^@\\\\]/g, '').split(/[,|]/)[0]\r\n        bundle.group = (prompt(this.$t('group'), cond) || '').replace(/^\\*/, '')\r\n      }\r\n      api\r\n        .call(`collections/${s[0].mongocollection || \"paragraph\"}/group`, bundle)\r\n        .then((data) => {\r\n          this.clear_selection(s);\r\n          s.forEach(\r\n            (p) =>\r\n              (p.keywords = p.keywords\r\n                .filter((x) => !x.startsWith(\"*\") && x !== data.result)\r\n                .concat(data.result ? [data.result] : []))\r\n          );\r\n        });\r\n    },\r\n    merge() {\r\n      var s = this.selected_paragraphs();\r\n      var objs = this.select_paragraph_item_objects(s);\r\n      if (!s || !s.length) return;\r\n      api\r\n        .call(`collections/${s[0].mongocollection || \"paragraph\"}/merge`, {\r\n          paragraphs: objs.album_items,\r\n        })\r\n        .then(() => this.clear_selection(s));\r\n    },\r\n    split() {\r\n      var s = this.selected_paragraphs();\r\n      var objs = this.select_paragraph_item_objects(s);\r\n      if (!s || !s.length) return;\r\n      api\r\n        .call(`collections/${s[0].mongocollection || \"paragraph\"}/split`, {\r\n          paragraphs: objs.album_items,\r\n        })\r\n        .then(() => this.clear_selection(s));\r\n    },\r\n    reset_storage() {\r\n      var s = this.selected_paragraphs();\r\n      api\r\n        .call(\"mediaitem/reset_storage\", {\r\n          ids: this.selected_items().map((x) => x._id),\r\n        })\r\n        .then(() => this.clear_selection(s));\r\n    },\r\n    get_paragraph_image(i) {\r\n      return api.get_paragraph_image(i);\r\n    },\r\n    querystring_stringify: api.querystring_stringify,\r\n    scope: api.scope\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.page .paragraph p,\r\n.list .paragraph p {\r\n  max-width: 960px;\r\n}\r\n</style>\r\n\r\n<style scoped>\r\n.v-btn {\r\n  margin-right: 12px;\r\n}\r\n.page-view {\r\n  overflow-y: auto;\r\n  max-height: 100%;\r\n}\r\n.v-dialog .v-card__title .v-btn {\r\n  margin-right: 50px;\r\n  position: fixed;\r\n  z-index: 200;\r\n  right: 20px;\r\n}\r\n.meta a {\r\n  text-decoration: none;\r\n}\r\n\r\n.count {\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.page .operations,\r\n.page .meta,\r\n.gallery .operations,\r\n.gallery .meta {\r\n  display: none;\r\n}\r\n\r\n.wrapper-container {\r\n  clear: both;\r\n  margin: 0;\r\n  padding: 0;\r\n  width: 100%;\r\n}\r\n\r\n.gallery .wrapper-container {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.gallery .wrapper-container .paragraph {\r\n  padding: 5px;\r\n  width: 250px;\r\n  \r\n}\r\n\r\n.spacer {\r\n  margin-right: 100%;\r\n}\r\n\r\n.tools > .v-btn {\r\n  margin-right: 12px;\r\n}\r\n\r\n.tools {\r\n  padding-right: 12px;\r\n  padding-bottom: 12px;\r\n  text-align: right;\r\n}\r\n\r\n.view-mode-toggler {\r\n  vertical-align: middle;\r\n}\r\n\r\n.view-mode-toggler > * {\r\n  margin: 0;\r\n}\r\n\r\n.v-image.selected::before {\r\n  content: \"\\F012C\";\r\n  color: green;\r\n  font-family: \"Material Design Icons\";\r\n  display: block;\r\n  z-index: 4;\r\n  position: absolute;\r\n  margin: 0;\r\n  font-size: 40px;\r\n  opacity: 1;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(255, 255, 255, 0.5);\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResultsView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResultsView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ResultsView.vue?vue&type=template&id=7d00bbc8&scoped=true&\"\nimport script from \"./ResultsView.vue?vue&type=script&lang=js&\"\nexport * from \"./ResultsView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ResultsView.vue?vue&type=style&index=0&id=7d00bbc8&prod&lang=css&\"\nimport style1 from \"./ResultsView.vue?vue&type=style&index=1&id=7d00bbc8&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7d00bbc8\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <v-card flat>\r\n    <v-card-title>{{ $t(\"search\") }}</v-card-title>\r\n    <v-card-text @drop.prevent=\"drop_json_file\" @dragover.prevent>\r\n      <form autocapitalize=\"off\" autocorrect=\"off\" spellcheck=\"false\">\r\n        <v-row>\r\n          <v-col>\r\n            <ParamInput :arg=\"{name: $t('query'), type: 'QUERY'}\" v-model=\"q\" v-if=\"expert\"\r\n              ref=\"search_code\"\r\n              @submit=\"search\"\r\n              class=\"mb-5 d-inline-block cond-width\"></ParamInput>\r\n            <v-text-field v-else\r\n              class=\"d-inline-block selector cond-width\"\r\n              dense\r\n              v-model=\"q\"\r\n              @keyup.enter=\"search\"\r\n              :label=\"$t('query')\"\r\n            ></v-text-field>\r\n            <v-combobox\r\n              class=\"d-inline-block ml-5 selector\"\r\n              v-model=\"sort\"\r\n              :label=\"$t('sort')\"\r\n              dense\r\n              :style=\"{ width: '100px' }\"\r\n              :items=\"[\r\n                { text: $t('default'), value: 'id' },\r\n                { text: $t('pdate'), value: 'pdate' },\r\n                { text: $t('pdate-rev'), value: '-pdate' },\r\n                { text: $t('source'), value: 'source' },\r\n                { text: $t('latest-imported'), value: '-id' },\r\n                { text: $t('random'), value: 'random' },\r\n              ]\"\r\n            ></v-combobox>\r\n          </v-col>\r\n        </v-row>\r\n        <v-row style=\"margin-top: -24px\">\r\n          <v-col>\r\n            <treeselect\r\n              :multiple=\"true\"\r\n              :options=\"datasets\"\r\n              v-model=\"selected_datasets\"\r\n              :placeholder=\"$t('dataset')\"\r\n            />\r\n          </v-col>\r\n        </v-row>\r\n        <v-row class=\"ml-0 mb-3\">\r\n          <v-btn @click=\"search\" color=\"primary\">{{ $t(\"search\") }}</v-btn>\r\n          <span class=\"ml-5\" style=\"line-height: 100%; vertical-align: middle\">\r\n            {{ $t(\"grouping\") }}\r\n            <v-combobox\r\n              class=\"d-inline-block ml-1\"\r\n              style=\"width: 80px\"\r\n              dense\r\n              flat\r\n              :items=\"[\r\n                { text: $t('none'), value: 'none' },\r\n                { text: $t('group'), value: 'group' },\r\n                { text: $t('source'), value: 'source' },\r\n                { text: $t('author'), value: 'author' },\r\n              ]\"\r\n              v-model=\"groups\"\r\n            />\r\n          </span>\r\n          <v-spacer></v-spacer>\r\n          <v-btn @click=\"export_query\" class=\"exports\">\r\n            <v-icon>mdi-clipboard-outline</v-icon>\r\n            {{ $t(\"export-task\") }}\r\n          </v-btn>\r\n          <v-btn @click=\"export_file('xlsx')\" class=\"exports\">\r\n            <v-icon>mdi-file-excel</v-icon>\r\n            {{ $t(\"export-excel\") }}\r\n          </v-btn>\r\n          <v-btn @click=\"export_file('json')\" class=\"exports\">\r\n            <v-icon>mdi-download</v-icon>\r\n            {{ $t(\"export-json\") }}\r\n          </v-btn>\r\n        </v-row>\r\n      </form>\r\n      <ResultsView class=\"mt-5\" :page_size=\"page_size\" @load=\"load_search\" ref=\"results\" />\r\n    </v-card-text>\r\n  </v-card>\r\n</template>\r\n    \r\n<script>\r\nimport api from \"../api\";\r\nimport ResultsView from \"../components/ResultsView\";\r\nimport ParamInput from \"../components/ParamInput.vue\";\r\n\r\nexport default {\r\n  name: \"SearchForm\",\r\n  components: { ResultsView, ParamInput },\r\n  data() {\r\n    return {\r\n      datasets: [],\r\n      selected_datasets: [],\r\n      open_datasets: [],\r\n      selected_mongocollections: [],\r\n      q: \"\",\r\n      groups: \"none\",\r\n      sort: \"\",\r\n      querystr: \"\",\r\n      req: \"\",\r\n      selection_bundles: {},\r\n      external_json: null,\r\n      page_size: 50,\r\n      cancel_source: api.cancel_source(),\r\n      expert: api.config.expert\r\n    };\r\n  },\r\n  mounted() {\r\n    let config = api.config;\r\n    if (config.page_size) this.page_size = config.page_size;\r\n    if (config.sort) this.sort = config.sort;\r\n    if (config.groups) this.groups = config.groups;\r\n\r\n    let search_params = api.querystring_parse(location.search);\r\n    if (config.expert && search_params.q && search_params.q.startsWith('? ')) search_params.q = search_params.q.replace(/^\\? /, '')\r\n    for (var k of [\"q\", \"sort\", \"groups\"])\r\n      if (search_params[k]) this[k] = search_params[k];\r\n    if (api.config.expert) this.$refs.search_code.refresh(this.q);\r\n\r\n    api.get_datasets_hierarchy().then((data) => {\r\n      this.datasets = data.hierarchy;\r\n      this.selection_bundles = data.bundles;\r\n      this.selected_datasets =\r\n        search_params.selected_datasets || config.selected_datasets || [];\r\n      if (this.q) this.search(true);\r\n    });\r\n  },\r\n  methods: {\r\n    datasets_req() {\r\n      var selected = this.selected_datasets.map(\r\n        (sid) => this.selection_bundles[sid]\r\n      ),\r\n        req = \"\";\r\n\r\n      if (selected.length > 0) {\r\n        var datasets = selected\r\n          .filter((x) => !x.source)\r\n          .map((x) => api.escape_regex(x.dataset_name)),\r\n          sourcefiles = selected\r\n            .filter((x) => x.source)\r\n            .map((x) => ({\r\n              file: x.source.split(\":\", 2).pop(),\r\n              dataset: x.dataset_name,\r\n            })),\r\n          req_datasets = \"\",\r\n          req_sourcefiles = \"\";\r\n        this.selected_mongocollections = Array.from(\r\n          new Set(selected.map((x) => x.mongocollection))\r\n        );\r\n\r\n        if (datasets.length > 0) {\r\n          req_datasets = \"dataset%`^\" + datasets.map(x => x == '' ? '$' : api.escape_regex(x)).join(\"|^\") + \"`\";\r\n        }\r\n        if (sourcefiles.length > 0) {\r\n          req_sourcefiles = sourcefiles\r\n            .map((sf) => `(dataset='${sf.dataset}',source.file='${sf.file}')`)\r\n            .join(\"|\");\r\n        }\r\n        req =\r\n          \"(\" +\r\n          [req_datasets, req_sourcefiles]\r\n            .filter((x) => x.length > 0)\r\n            .join(\"|\") +\r\n          \")\";\r\n      }\r\n\r\n      if (api.config.view_mode == \"gallery\") {\r\n        req += (req ? ',' : '') + 'images!=[]'\r\n      }\r\n      return req;\r\n    },\r\n    search(pagenum_preserve) {\r\n      this.external_json = null;\r\n\r\n      if (this.selected_datasets.length == 0)\r\n        this.selected_datasets = this.datasets.map((s) => s.id);\r\n\r\n      this.req = this.datasets_req();\r\n\r\n      if (pagenum_preserve !== true)\r\n        history.pushState(\r\n          \"\",\r\n          \"\",\r\n          api.querystring_stringify(\r\n            Object.assign(api.querystring_parse(location.search), {\r\n              q: this.q,\r\n              selected_datasets: this.selected_datasets,\r\n              sort: this.sort,\r\n              groups: this.groups,\r\n              selected_mongocollections: this.selected_mongocollections,\r\n            })\r\n          )\r\n        );\r\n\r\n      this.$refs.results.start(pagenum_preserve === true ? undefined : 1);\r\n    },\r\n    load_search(e) {\r\n      var token = new Date().getTime() + Math.random();\r\n\r\n      if (this.external_json) {\r\n        e.callback({\r\n          result: this.external_json.slice(\r\n            e.offset,\r\n            e.offset + e.limit\r\n          ),\r\n          offset: e.offset,\r\n          total: this.external_json.length,\r\n          token,\r\n        });\r\n        return;\r\n      }\r\n      if (!this.q && !this.req) return;\r\n\r\n      if (this.q.startsWith('file:')) {\r\n        this.load_remote_file(this.q.substring(5).trim())\r\n        return\r\n      }\r\n\r\n      if (this.cancel_source) this.cancel_source.cancel();\r\n\r\n      this.cancel_source = api.cancel_source();\r\n\r\n      var params = {\r\n        q: (this.expert ? '? ' : '') + this.q,\r\n        req: this.req,\r\n        sort: typeof this.sort === \"object\" ? this.sort.value : this.sort,\r\n        mongocollections: this.selected_mongocollections,\r\n        offset: e.offset,\r\n        limit: e.limit,\r\n        groups:\r\n          typeof this.groups === \"object\" ? this.groups.value : this.groups,\r\n      };\r\n\r\n      if (params.sort !== \"random\") api.config.sort = params.sort;\r\n      api.config.groups = params.groups\r\n\r\n      api.call(\"search\", params, this.cancel_source).then((data) => {\r\n        if (!data) {\r\n          console.log(\"WARNING: no data returned.\");\r\n          return;\r\n        }\r\n        if (data.result.query) {\r\n          var reg = new RegExp(\r\n            \"(\" +\r\n            this.keyword_patterns(data.result.query)\r\n              .filter((x) => x)\r\n              .join(\"|\") +\r\n            \")\",\r\n            \"gi\"\r\n          );\r\n          this.results = data.result.results;\r\n          if (reg != \"/()/gi\") {\r\n            this.results = this.results.map((x) => {\r\n              x.matched_content = (x.content || \"\").replace(reg, \"<em>$1</em>\");\r\n              return x;\r\n            });\r\n          }\r\n        }\r\n        this.querystr = api.querify(data.result.query).replace(/^\\(|\\)$/g, \"\");\r\n        e.callback({\r\n          token,\r\n          result: data.result.results,\r\n          offset: e.offset,\r\n        });\r\n      });\r\n\r\n      api\r\n        .call(\r\n          \"search\",\r\n          Object.assign({ count: true }, params, this.cancel_source)\r\n        )\r\n        .then((data) => {\r\n          if (data.result) e.callback({ token, total: data.result });\r\n        });\r\n    },\r\n    keyword_patterns(query) {\r\n      if (Array.isArray(query))\r\n        return query\r\n          .map((x) => this.keyword_patterns(x))\r\n          .reduce((prev, curr) => (prev = prev.concat(curr)), []);\r\n      if ([\"string\", \"number\", \"boolean\"].includes(typeof query)) return [];\r\n      return Object.entries(query)\r\n        .map((kvpair) => {\r\n          let key = kvpair[0],\r\n            val = kvpair[1];\r\n          if (key == \"keywords\") {\r\n            if (typeof val == \"string\") return [api.escape_regex(val)];\r\n            else if (typeof val.$regex == \"string\") return [val.$regex];\r\n          }\r\n          return this.keyword_patterns(val);\r\n        })\r\n        .reduce((prev, curr) => (prev = prev.concat(curr)), []);\r\n    },\r\n    export_query(format, callback) {\r\n      if (typeof callback !== \"function\")\r\n        callback = (data) =>\r\n          this.$router.push(\"/tasks/\" + data.result).catch(() => { });\r\n      api\r\n        .put(\"tasks/\", {\r\n          name: this.$t(\"search\") + \" \" + new Date().toLocaleString().replace(/[^\\d]/g, ''),\r\n          pipeline: [\r\n            [\r\n              \"DBQueryDataSource\",\r\n              {\r\n                query: this.q,\r\n                req: this.req,\r\n                mongocollections: this.selected_mongocollections,\r\n              },\r\n            ],\r\n            [\"AccumulateParagraphs\", {}],\r\n            [\"Export\", { output_format: format }],\r\n          ],\r\n        })\r\n        .then(callback);\r\n    },\r\n    export_file(fmt) {\r\n      this.export_query(fmt, (data) => {\r\n        api.put(\"queue/\", { id: data.result }).then((ret) =>\r\n          api.notify({\r\n            title: this.$t(\"task-enqueued\", { task: ret.result }),\r\n          })\r\n        );\r\n      });\r\n    },\r\n    drop_json_file(e) {\r\n      let droppedFiles = Array.from(e.dataTransfer.files).filter((x) =>\r\n        x.name.match(/\\.json$/)\r\n      );\r\n      if (!droppedFiles.length) return;\r\n      let file = droppedFiles[0];\r\n      let reader = new FileReader();\r\n      reader.onload = (f) => {\r\n        this.external_json = JSON.parse(f.target.result);\r\n        this.$refs.results.start();\r\n      };\r\n      reader.readAsText(file);\r\n    },\r\n    load_remote_file(path) {\r\n      api.call('image?file=' + path).then((data) => {\r\n        this.external_json = data\r\n        this.$refs.results.start()\r\n    })\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.clear {\r\n  clear: both;\r\n}\r\n\r\n.vue-treeselect__control {\r\n  border-radius: 0;\r\n}\r\n.theme--dark .vue-treeselect {\r\n  color: rgba(0, 0, 0, 0.7) !important;\r\n}\r\n\r\n.selector {\r\n  vertical-align: bottom;\r\n}\r\n\r\n.exports {\r\n  margin-right: 12px;\r\n}\r\n\r\n.cond-width {\r\n  width: calc(100% - 120px);\r\n  min-width: 200px;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SearchForm.vue?vue&type=template&id=4e85c642&scoped=true&\"\nimport script from \"./SearchForm.vue?vue&type=script&lang=js&\"\nexport * from \"./SearchForm.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SearchForm.vue?vue&type=style&index=0&id=4e85c642&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4e85c642\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-text',[_c('ParamInput',{attrs:{\"arg\":{ name: _vm.$t('name'), type: '' }},model:{value:(_vm.task.name),callback:function ($$v) {_vm.$set(_vm.task, \"name\", $$v)},expression:\"task.name\"}}),_c('span',[_vm._v(\"ID: \"+_vm._s(_vm.task._id)+\" \"+_vm._s(_vm.$t(\"created-by\"))+\": \"+_vm._s(_vm.task.creator))]),_c('v-row',[_c('v-col',[_c('v-checkbox',{staticClass:\"d-inline-block\",attrs:{\"label\":_vm.$t('shared'),\"disabled\":_vm.task.creator !== _vm.user},model:{value:(_vm.task.shared),callback:function ($$v) {_vm.$set(_vm.task, \"shared\", $$v)},expression:\"task.shared\"}}),_c('v-checkbox',{staticClass:\"d-inline-block ml-5\",attrs:{\"label\":_vm.$t('resume-next')},model:{value:(_vm.task.resume_next),callback:function ($$v) {_vm.$set(_vm.task, \"resume_next\", $$v)},expression:\"task.resume_next\"}}),_c('v-text-field',{staticClass:\"d-inline-block ml-5\",attrs:{\"label\":_vm.$t('concurrent'),\"type\":\"number\",\"rules\":[\n              (v) =>\n                (v >= 1 && v <= 10 && v == parseInt(v)) || _vm.$t('number-1-10'),\n            ]},on:{\"input\":(v) => (_vm.task.concurrent = parseInt(v))},model:{value:(_vm.task.concurrent),callback:function ($$v) {_vm.$set(_vm.task, \"concurrent\", $$v)},expression:\"task.concurrent\"}})],1)],1),_c('v-row',[_c('v-col',[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.enqueue}},[_c('v-icon',[_vm._v(\"mdi-play\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"run-background\"))+\" \")],1)],1)],1),_c('v-divider',{staticClass:\"mt-5 mb-5\"}),_c('div',{attrs:{\"id\":\"pipeline\"}},[_c('h2',[_vm._v(\" \"+_vm._s(_vm.$t(\"pipeline\"))+\" \"),(_vm.pipelines)?_c('v-btn',{staticClass:\"ml-5\",on:{\"click\":function($event){_vm.blockly = true}}},[_c('v-icon',[_vm._v(\"mdi-layers\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"design-view\")))],1):_vm._e()],1),_c('Pipeline',{staticStyle:{\"margin-left\":\"0 !important\"},attrs:{\"map_id\":'pipeline'},on:{\"shortcut\":_vm.update_shortcut,\"validation\":function($event){return _vm.update_valid('pipeline_main', $event)}},model:{value:(_vm.task.pipeline),callback:function ($$v) {_vm.$set(_vm.task, \"pipeline\", $$v)},expression:\"task.pipeline\"}})],1),_c('div',{attrs:{\"id\":\"shortcut_map\"}},[_c('h2',[_vm._v(_vm._s(_vm.$t(\"shortcut-params\")))]),_c('div',_vm._l((_vm.task.shortcut_map),function(v,k){return _c('div',{key:k},[_c('ParamInput',{attrs:{\"arg\":{ name: k, type: 'str', default: '\\'\\'' }},model:{value:(_vm.task.shortcut_map[k]),callback:function ($$v) {_vm.$set(_vm.task.shortcut_map, k, $$v)},expression:\"task.shortcut_map[k]\"}})],1)}),0)])],1),_c('v-card-actions',[_c('v-btn',{staticClass:\"ml-5\",attrs:{\"color\":\"primary\"},on:{\"click\":function($event){_vm.save().then(() => _vm.notify(_vm.$t('saved')))}}},[_c('v-icon',[_vm._v(\"mdi-check\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"save\"))+\" \")],1),_c('v-btn',{staticClass:\"ml-3\",attrs:{\"color\":\"error\"},on:{\"click\":function($event){return _vm.delete_task()}}},[_c('v-icon',[_vm._v(\"mdi-delete\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"delete\"))+\" \")],1),_c('v-btn',{staticClass:\"ml-3\",on:{\"click\":function($event){_vm.show_code = !_vm.show_code}}},[_c('v-icon',[_vm._v(\"mdi-code-braces\")])],1)],1),_c('v-row',{staticClass:\"ma-10\"},[_c('v-textarea',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.show_code),expression:\"show_code\"}],attrs:{\"value\":_vm.querify(_vm.task),\"readonly\":\"\"}})],1)],1),(_vm.pipelines)?_c('BlocklyComponent',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.blockly),expression:\"blockly\"}],attrs:{\"json\":_vm.task.pipeline,\"pipelines\":_vm.pipelines,\"tasks\":_vm.tasks},on:{\"save\":function($event){_vm.task.pipeline = $event;\n      _vm.blockly = false;},\"cancel\":function($event){_vm.blockly = false}}}):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',{ref:\"blocklyDiv\",staticClass:\"blocklyDiv\",attrs:{\"id\":\"blocklyDiv\"}}),_c('xml',{ref:\"blocklyToolbox\",staticStyle:{\"display\":\"none\"}}),_c('div',{staticClass:\"options\"},[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(_vm._s(_vm.$t(\"save\")))]),_c('v-btn',{staticClass:\"ml-5\",on:{\"click\":function($event){return _vm.$emit('cancel')}}},[_vm._v(_vm._s(_vm.$t(\"cancel\")))])],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <div id=\"blocklyDiv\" class=\"blocklyDiv\" ref=\"blocklyDiv\"></div>\n    <xml ref=\"blocklyToolbox\" style=\"display: none\"></xml>\n    <div class=\"options\">\n      <v-btn color=\"primary\" @click=\"save\">{{ $t(\"save\") }}</v-btn>\n      <v-btn class=\"ml-5\" @click=\"$emit('cancel')\">{{ $t(\"cancel\") }}</v-btn>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Blockly from \"blockly\";\n\nexport default {\n  name: \"BlocklyComponent\",\n  props: [\"json\", \"pipelines\", \"tasks\"],\n  data() {\n    return {\n      workspace: null,\n      blocks_dict: {},\n    };\n  },\n  mounted() {\n    var interval = setInterval(() => {\n      if (\n        !this.pipelines ||\n        !this.json ||\n        !this.tasks.length ||\n        !this.$refs.blocklyDiv\n      )\n        return;\n\n      var options = {\n        media: \"media/\",\n        toolbox: this.load_toolbox(),\n      };\n      console.log(options.toolbox);\n\n      this.workspace = Blockly.inject(this.$refs.blocklyDiv, options);\n      this.workspace.clear();\n      var xml = document.createElement(\"xml\");\n      this.to_xml(xml, this.json);\n      console.log(xml);\n      Blockly.Xml.domToWorkspace(xml, this.workspace);\n      clearInterval(interval);\n    }, 1000);\n  },\n  methods: {\n    auto_parse(val) {\n      if (typeof val !== \"string\") return val;\n      if (val === \"FALSE\" || val === \"TRUE\") return val === \"TRUE\";\n      if (val.match(/^[+-]?\\d+\\.?\\d*[Ee]?[+-]?\\d*$/)) return +val;\n      return val;\n    },\n    load_toolbox() {\n      var toolbox = {\n        kind: \"categoryToolbox\",\n        contents: [],\n      };\n\n      toolbox.contents.push({\n        kind: \"category\",\n        name: \"过程处理\",\n        contents: [],\n      });\n      for (var group in this.pipelines) {\n        toolbox.contents.push({\n          kind: \"category\",\n          name: group,\n          colour: 160,\n          contents: [],\n        });\n        let toolbox_contents = toolbox.contents.slice(-1)[0].contents;\n        let items = this.pipelines[group];\n        for (var item_key in items) {\n          let item = items[item_key];\n          let obj = {\n            previousStatement: null,\n            nextStatement: null,\n            colour: 160,\n            message0: `${item.name} ${item.doc}`,\n          };\n          this.blocks_dict[item.name] = item;\n          for (var i = 0; i < item.args.length; ++i) {\n            let arg = item.args[i];\n            arg.description = arg.description || arg.name;\n            obj[`message${i + 1}`] = arg.description.includes(\"%1\")\n              ? arg.description\n              : `${arg.description}：%1`;\n            obj[`args${i + 1}`] = [\n              arg.type.includes(\"|\")\n                ? {\n                    type: \"field_dropdown\",\n                    name: arg.name,\n                    options: arg.type\n                      .split(\"|\")\n                      .map((x) => (x.includes(\":\") ? x.split(\":\") : [x, x])),\n                  }\n                : [\"float\", \"int\"].includes(arg.type)\n                ? {\n                    type: \"field_number\",\n                    name: arg.name,\n                  }\n                : \"bool\" == arg.type\n                ? {\n                    type: \"field_checkbox\",\n                    name: arg.name,\n                  }\n                : \"TASK\" == arg.type\n                ? {\n                    type: \"field_dropdown\",\n                    name: arg.name,\n                    options: this.tasks.map((x) => [x.name, x._id]),\n                  }\n                : \"pipeline\" == arg.type\n                ? {\n                    type: \"input_statement\",\n                    name: arg.name,\n                  }\n                : {\n                    type: \"input_value\",\n                    name: arg.name,\n                  },\n            ];\n          }\n          Blockly.Blocks[item.name] = {\n            init() {\n              this.jsonInit(obj);\n            },\n          };\n          toolbox_contents.push({\n            kind: \"block\",\n            type: item.name,\n          });\n        }\n      }\n\n      toolbox.contents.push({\n        kind: \"category\",\n        name: \"常量\",\n        contents: [\n          { kind: \"block\", type: \"text\" },\n          { kind: \"block\", type: \"text_multiline\" },\n          { kind: \"block\", type: \"math_number\" },\n        ],\n      });\n\n      var query_blocks = [\n        {\n          type: \"function_size\",\n          name: \"数组长度\",\n          message0: \"数组 %1 的长度\",\n          args0: [\n            {\n              type: \"input_value\",\n              name: \"VALUE\",\n            },\n          ],\n          output: \"Number\",\n          colour: 160,\n          tooltip: \"Returns number of array element.\",\n        },\n        {\n          type: \"function_strlenCP\",\n          name: \"字符串长度\",\n          message0: \"字符串 %1 的长度\",\n          args0: [\n            {\n              type: \"input_value\",\n              name: \"VALUE\",\n            },\n          ],\n          output: \"Number\",\n          colour: 160,\n          tooltip: \"Returns number of letters in the provided text.\",\n        },\n      ];\n\n      const constants = Object.entries({\n        文件来源: \"source__file\",\n        网页来源: \"source__url\",\n        文件页码: \"source__page\",\n        页码: \"pagenum\",\n        日期: \"pdate\",\n        关键词和标签: \"keywords\",\n        内容: \"content\",\n        语言: \"lang\",\n        数据集: \"dataset\",\n        大纲: \"outline\",\n        图像: \"images\",\n      });\n\n      toolbox.contents.push({\n        kind: \"category\",\n        name: `查询`,\n        contents: [\n          {\n            kind: \"block\",\n            type: \"logic_compare\",\n          },\n          {\n            kind: \"block\",\n            type: \"logic_operation\",\n          },\n          {\n            kind: \"block\",\n            type: \"logic_boolean\",\n          },\n          ...constants.map((cst) => {\n            var item = {\n              kind: \"block\",\n              type: `constant_${cst[1]}`,\n              name: cst[0],\n              message0: cst[0],\n              args0: [],\n              output: \"String\",\n              color: 160,\n            };\n            Blockly.Blocks[item.type] = {\n              init() {\n                this.jsonInit(item);\n              },\n            };\n            return { kind: \"block\", type: item.type };\n          }),\n          ...query_blocks.map((item) => {\n            Blockly.Blocks[item.type] = {\n              init() {\n                this.jsonInit(item);\n              },\n            };\n            return { kind: \"block\", type: item.type };\n          }),\n        ],\n      });\n      return toolbox;\n    },\n    to_xml(parent, tuples) {\n      var index = 0;\n\n      for (var tup of tuples) {\n        if (index > 0) {\n          var next = document.createElement(\"next\");\n          parent.appendChild(next);\n          parent = next;\n        }\n\n        let name = tup[0],\n          args = tup[1];\n        var block = document.createElement(\"block\");\n        block.setAttribute(\"type\", name);\n        if (!this.blocks_dict[name]) {\n          console.log(\"?unknown block\", name);\n          continue;\n        }\n        for (var argname in args) {\n          let argvalue = args[argname],\n            arg = this.blocks_dict[name].args.filter(\n              (x) => x.name == argname\n            )[0];\n          if (!arg) {\n            console.log(\"?arg\", argname);\n            continue;\n          }\n          let argtype = arg.type;\n          var field = \"\";\n          if (\n            [\"bool\", \"float\", \"int\", \"TASK\"].includes(argtype) ||\n            argtype.includes(\"|\")\n          ) {\n            field = document.createElement(\"field\");\n            field.setAttribute(\"name\", argname);\n            argvalue = \"\" + argvalue;\n            if (argtype == \"bool\") argvalue = argvalue.toUpperCase();\n            field.innerHTML = argvalue;\n            block.appendChild(field);\n          } else if (argtype == \"pipeline\") {\n            field = document.createElement(\"statement\");\n            field.setAttribute(\"name\", argname);\n            this.to_xml(field, argvalue);\n            block.appendChild(field);\n          } else {\n            var valuenode = document.createElement(\"value\");\n            valuenode.setAttribute(\"name\", argname);\n            var valueblock = document.createElement(\"block\");\n            valueblock.setAttribute(\n              \"type\",\n              (argvalue || \"\").includes(\"\\n\") ? \"text_multiline\" : \"text\"\n            );\n            var valueblockfield = document.createElement(\"field\");\n            valueblockfield.setAttribute(\"name\", \"TEXT\");\n            valueblockfield.innerHTML = argvalue;\n            valueblock.appendChild(valueblockfield);\n            valuenode.appendChild(valueblock);\n            block.appendChild(valuenode);\n          }\n        }\n\n        parent.append(block);\n        parent = block;\n        ++index;\n      }\n    },\n    from_field_expr(block) {\n      var op = \"\";\n      block.type = block.getAttribute(\"type\");\n      switch (block.type) {\n        case \"math_number\":\n        case \"text\":\n        case \"text_multiline\":\n          return this.auto_parse(\n            block.getElementsByTagName(\"field\")[0].innerHTML\n          );\n        case \"logic_compare\":\n          op = block.querySelector('field[name=\"OP\"]').textContent;\n          return (\n            this.from_field_expr(block.querySelector(\"[name=A]\")) +\n            {\n              EQ: \"=\",\n              LT: \"<\",\n              LE: \"<=\",\n              GT: \">\",\n              GE: \">=\",\n              NE: \"!=\",\n            }[op] +\n            this.from_field_expr(block.querySelector(\"[name=B]\"))\n          );\n        default:\n          if (block.type.startsWith(\"constant_\"))\n            return block.type.split(\"_\", 2)[1].replace(/__/g, \".\");\n          if (block.type.startsWith(\"function_\"))\n            return (\n              block.type.split(\"_\", 2)[1] +\n              \"(\" +\n              this.from_field_expr(block.type.querySelector(\"[name=VALUE]\")) +\n              \")\"\n            );\n          break;\n      }\n      return \"\";\n    },\n    from_xml(block) {\n      var j = [];\n      while (block) {\n        // iterative through 'next' tags to get a sequence of blocks\n        var next = null,\n          obj = {\n            name: block.getAttribute(\"type\"),\n            args: {},\n          };\n        for (var child of block.children) {\n          switch (child.tagName) {\n            case \"next\":\n              next = child.children[0];\n              break;\n            case \"field\":\n            case \"value\":\n              obj.args[child.getAttribute(\"name\")] = this.from_field_expr(\n                child.children[0]\n              );\n              break;\n            case \"statement\":\n              obj.args[child.getAttribute(\"name\")] = this.from_xml(\n                child.children[0]\n              );\n              break;\n          }\n        }\n        j.push([obj.name, obj.args]);\n        block = next;\n      }\n      return j;\n    },\n    save() {\n      var xml = Blockly.Xml.workspaceToDom(this.workspace);\n      if (!xml.children.length) return;\n\n      var block = xml.children[0];\n      var j = this.from_xml(block);\n\n      console.log(j);\n\n      this.$emit(\"save\", j);\n    },\n  },\n};\n</script>\n\n<style scoped>\n.blocklyDiv {\n  height: 100%;\n  width: 100%;\n  text-align: left;\n  background: white;\n  color: black;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 200;\n}\n\n.options {\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 200;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BlocklyComponent.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BlocklyComponent.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BlocklyComponent.vue?vue&type=template&id=350904c4&scoped=true&\"\nimport script from \"./BlocklyComponent.vue?vue&type=script&lang=js&\"\nexport * from \"./BlocklyComponent.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BlocklyComponent.vue?vue&type=style&index=0&id=350904c4&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"350904c4\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div>\r\n    <v-card flat>\r\n      <v-card-text>\r\n        <ParamInput v-model=\"task.name\" :arg=\"{ name: $t('name'), type: '' }\" />\r\n        <span\r\n          >ID: {{ task._id }} {{ $t(\"created-by\") }}: {{ task.creator }}</span\r\n        >\r\n        <v-row>\r\n          <v-col>\r\n            <v-checkbox\r\n              class=\"d-inline-block\"\r\n              :label=\"$t('shared')\"\r\n              v-model=\"task.shared\"\r\n              :disabled=\"task.creator !== user\"\r\n            ></v-checkbox>\r\n            <v-checkbox\r\n              class=\"d-inline-block ml-5\"\r\n              :label=\"$t('resume-next')\"\r\n              v-model=\"task.resume_next\"\r\n            ></v-checkbox>\r\n            <v-text-field\r\n              class=\"d-inline-block ml-5\"\r\n              :label=\"$t('concurrent')\"\r\n              v-model=\"task.concurrent\"\r\n              type=\"number\"\r\n              :rules=\"[\r\n                (v) =>\r\n                  (v >= 1 && v <= 10 && v == parseInt(v)) || $t('number-1-10'),\r\n              ]\"\r\n              @input=\"(v) => (task.concurrent = parseInt(v))\"\r\n            >\r\n            </v-text-field>\r\n          </v-col>\r\n        </v-row>\r\n        <v-row>\r\n          <v-col>\r\n            <v-btn color=\"primary\" @click=\"enqueue\">\r\n              <v-icon>mdi-play</v-icon> {{ $t(\"run-background\") }}\r\n            </v-btn></v-col\r\n          ></v-row\r\n        >\r\n        <v-divider class=\"mt-5 mb-5\"></v-divider>\r\n        <div id=\"pipeline\">\r\n          <h2>\r\n            {{ $t(\"pipeline\") }}\r\n            <v-btn @click=\"blockly = true\" class=\"ml-5\" v-if=\"pipelines\"\r\n              ><v-icon>mdi-layers</v-icon> {{ $t(\"design-view\") }}</v-btn\r\n            >\r\n          </h2>\r\n          <Pipeline\r\n            v-model=\"task.pipeline\"\r\n            @shortcut=\"update_shortcut\"\r\n            :map_id=\"'pipeline'\"\r\n            @validation=\"update_valid('pipeline_main', $event)\"\r\n            style=\"margin-left: 0 !important\"\r\n          />\r\n        </div>\r\n\r\n        <div id=\"shortcut_map\">\r\n          <h2>{{ $t(\"shortcut-params\") }}</h2>\r\n          <div>\r\n            <div v-for=\"(v, k) in task.shortcut_map\" :key=\"k\">\r\n              <ParamInput\r\n                :arg=\"{ name: k, type: 'str', default: '\\'\\'' }\"\r\n                v-model=\"task.shortcut_map[k]\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </v-card-text>\r\n      <v-card-actions>\r\n        <v-btn\r\n          @click=\"save().then(() => notify($t('saved')))\"\r\n          class=\"ml-5\"\r\n          color=\"primary\"\r\n        >\r\n          <v-icon>mdi-check</v-icon> {{ $t(\"save\") }}\r\n        </v-btn>\r\n        <v-btn class=\"ml-3\" color=\"error\" @click=\"delete_task()\">\r\n          <v-icon>mdi-delete</v-icon> {{ $t(\"delete\") }}\r\n        </v-btn>\r\n        <v-btn class=\"ml-3\" @click=\"show_code = !show_code\">\r\n          <v-icon>mdi-code-braces</v-icon>\r\n        </v-btn>\r\n      </v-card-actions>\r\n      <v-row class=\"ma-10\">\r\n        <v-textarea\r\n          v-show=\"show_code\"\r\n          :value=\"querify(task)\"\r\n          readonly\r\n        ></v-textarea>\r\n      </v-row>\r\n    </v-card>\r\n    <!-- <v-dialog fullscreen persistent v-model=\"blockly\"> -->\r\n    <BlocklyComponent\r\n      :json=\"task.pipeline\"\r\n      :pipelines=\"pipelines\"\r\n      :tasks=\"tasks\"\r\n      @save=\"\r\n        task.pipeline = $event;\r\n        blockly = false;\r\n      \"\r\n      @cancel=\"blockly = false\"\r\n      v-show=\"blockly\"\r\n      v-if=\"pipelines\"\r\n    />\r\n    <!-- </v-dialog> -->\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport api from \"../api\";\r\nimport ParamInput from \"../components/ParamInput.vue\";\r\nimport Pipeline from \"../components/Pipeline\";\r\nimport BlocklyComponent from \"../components/BlocklyComponent.vue\";\r\n\r\nexport default {\r\n  name: \"TaskDetail\",\r\n  components: {\r\n    Pipeline,\r\n    BlocklyComponent,\r\n    ParamInput,\r\n  },\r\n  props: [\"id\"],\r\n  data() {\r\n    return {\r\n      task: {\r\n        _id: \"\",\r\n        name: \"\",\r\n        shortcut_map: {},\r\n        pipeline: [],\r\n      },\r\n      blockly: false,\r\n      pipelines: null,\r\n      valid: [],\r\n      show_code: false,\r\n      tasks: [],\r\n    };\r\n  },\r\n  mounted() {\r\n    api.call(\"tasks/\" + this.id).then((data) => {\r\n      this.task = data.result;\r\n    });\r\n    api.call(\"tasks/\").then((data) => (this.tasks = data.result));\r\n    api.help_pipelines().then((data) => (this.pipelines = data));\r\n  },\r\n  computed: {\r\n    user() {\r\n      return api.user;\r\n    },\r\n  },\r\n  methods: {\r\n    update_valid(name, valid) {\r\n      var l = this.valid.indexOf(name);\r\n      if (l >= 0) this.valid.splice(l, 1);\r\n      if (!valid) this.valid.push(name);\r\n    },\r\n    delete_task() {\r\n      if (!confirm(this.$t(\"confirm-delete\"))) return;\r\n      api.delete(\"tasks/\" + this.task._id).then((data) => {\r\n        if (data.result.ok) {\r\n          api.notify(this.$t(\"deleted\"));\r\n          this.$router.push(\"/tasks\").catch(() => {});\r\n        }\r\n      });\r\n    },\r\n    save() {\r\n      if (this.valid.length > 0) {\r\n        alert(this.$t(\"invalid-input\"));\r\n        return;\r\n      }\r\n      for (var k in this.task.shortcut_map) {\r\n        if (\r\n          this.task.shortcut_map[k] === \"\" ||\r\n          this.task.shortcut_map[k] === null\r\n        )\r\n          delete this.task.shortcut_map[k];\r\n      }\r\n      return api.call(\"tasks/\" + this.task._id, this.task).then((data) => {\r\n        var id = this.task._id;\r\n        this.task = data.result.updated;\r\n        this.task._id = id;\r\n        return id;\r\n      });\r\n    },\r\n    notify(title) {\r\n      api.notify({ title });\r\n    },\r\n    enqueue() {\r\n      this.save().then((id) =>\r\n        api.put(\"queue/\", { id }).then((data) => {\r\n          this.notify(this.$t(\"task-enqueued\", { task: data.result }));\r\n        })\r\n      );\r\n    },\r\n    update_shortcut(shortcut_name, shortcut_description) {\r\n      this.task.shortcut_map[shortcut_name] =\r\n        shortcut_description || shortcut_name.split(\".\").slice(-1)[0];\r\n      this.$forceUpdate();\r\n    },\r\n    querify() {\r\n      return this.task.pipeline\r\n        .map((kv) => {\r\n          var o = {};\r\n          o[\"$\" + kv[0]] = kv[1];\r\n          return api.querify(o).replace(/^\\(|\\)$/g, \"\");\r\n        })\r\n        .join(\";\\n\");\r\n    },\r\n  },\r\n};\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskDetail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskDetail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TaskDetail.vue?vue&type=template&id=0548e6c9&\"\nimport script from \"./TaskDetail.vue?vue&type=script&lang=js&\"\nexport * from \"./TaskDetail.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-sheet',[_c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"quick-task\"))+\" \"+_vm._s(_vm.task.name))]),_c('v-card-text',[_c('v-list',_vm._l((_vm.task.shortcut_map),function(k,v){return _c('v-list-item',{key:k},[_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(_vm._s(k))]),_c('v-list-item-subtitle',[_c('ParamInput',{attrs:{\"arg\":_vm.get_map_arg(v)},on:{\"validation\":function($event){return _vm.update_valid('shortcut_param_' + v, $event)},\"input\":function($event){return _vm.$forceUpdate()}},model:{value:(_vm.shortcut_params[v]),callback:function ($$v) {_vm.$set(_vm.shortcut_params, v, $$v)},expression:\"shortcut_params[v]\"}})],1)],1)],1)}),1)],1),_c('v-card-actions',[_c('v-btn',{staticClass:\"ml-4\",on:{\"click\":_vm.quicktask}},[_c('v-icon',[_vm._v(\"mdi-fast-forward\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"run-now\"))+\" \")],1),_c('v-btn',{on:{\"click\":_vm.enqueue}},[_c('v-icon',[_vm._v(\"mdi-play\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"run-background\"))+\" \")],1),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.$router.push('/tasks/' + _vm.id)}}},[_c('v-icon',[_vm._v(\"mdi-file-edit-outline\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"edit\"))+\" \")],1)],1)],1),_c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"results\")))]),_c('v-card-text',[_c('ResultsView',{ref:\"results\",attrs:{\"view_mode\":_vm.view_mode},on:{\"load\":_vm.load_search}}),_vm._v(\" \"+_vm._s(_vm.result_plain)+\" \")],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-sheet>\r\n    <v-card flat>\r\n      <v-card-title>{{ $t(\"quick-task\") }} {{ task.name }}</v-card-title>\r\n      <v-card-text>\r\n        <v-list>\r\n          <v-list-item v-for=\"(k, v) in task.shortcut_map\" :key=\"k\">\r\n            <v-list-item-content>\r\n              <v-list-item-title>{{ k }}</v-list-item-title>\r\n              <v-list-item-subtitle>\r\n                <ParamInput\r\n                  :arg=\"get_map_arg(v)\"\r\n                  v-model=\"shortcut_params[v]\"\r\n                  @validation=\"update_valid('shortcut_param_' + v, $event)\"\r\n                  @input=\"$forceUpdate()\"\r\n              /></v-list-item-subtitle>\r\n            </v-list-item-content>\r\n          </v-list-item>\r\n        </v-list>\r\n      </v-card-text>\r\n      <v-card-actions>\r\n        <v-btn @click=\"quicktask\" class=\"ml-4\">\r\n          <v-icon>mdi-fast-forward</v-icon>\r\n          {{ $t(\"run-now\") }}\r\n        </v-btn>\r\n        <v-btn @click=\"enqueue\">\r\n          <v-icon>mdi-play</v-icon> {{ $t(\"run-background\") }}\r\n        </v-btn>\r\n        <v-btn color=\"primary\" @click=\"$router.push('/tasks/' + id)\">\r\n          <v-icon>mdi-file-edit-outline</v-icon>\r\n          {{ $t(\"edit\") }}\r\n        </v-btn>\r\n      </v-card-actions>\r\n    </v-card>\r\n    <v-card flat>\r\n      <v-card-title>{{ $t(\"results\") }}</v-card-title>\r\n      <v-card-text>\r\n        <ResultsView @load=\"load_search\" ref=\"results\" :view_mode=\"view_mode\" />\r\n        {{ result_plain }}\r\n      </v-card-text>\r\n    </v-card>\r\n  </v-sheet>\r\n</template>\r\n\r\n\r\n<script>\r\nimport api from \"../api\";\r\nimport ParamInput from \"../components/ParamInput.vue\";\r\nimport ResultsView from \"../components/ResultsView.vue\";\r\n\r\nexport default {\r\n  name: \"TaskShortcut\",\r\n  components: {\r\n    ParamInput,\r\n    ResultsView,\r\n  },\r\n  props: [\"id\"],\r\n  data() {\r\n    return {\r\n      stages: {},\r\n      task: {\r\n        _id: \"\",\r\n        name: \"\",\r\n        shortcut_map: {},\r\n        pipeline: [],\r\n      },\r\n      view_mode: \"list\",\r\n      shortcut_params: {},\r\n      results: [],\r\n      result_plain: \"\",\r\n      valid: [],\r\n    };\r\n  },\r\n  watch: {\r\n    id() {\r\n      this.shortcut_params = {};\r\n      this.results = [];\r\n      this.valid = [];\r\n      this.result_plain = \"\";\r\n    },\r\n  },\r\n  mounted() {\r\n    api.help_pipelines().then((data) => {\r\n      for (var k in data) {\r\n        Object.assign(this.stages, data[k]);\r\n      }\r\n      api.call(\"tasks/\" + this.id).then((data) => {\r\n        this.task = data.result;\r\n        for (var k in this.task.shortcut_map) {\r\n          this.shortcut_params[k] = this.get_map_val(k);\r\n        }\r\n      });\r\n    });\r\n  },\r\n  methods: {\r\n    update_valid(name, valid) {\r\n      var l = this.valid.indexOf(name);\r\n      if (l >= 0) this.valid.splice(l, 1);\r\n      if (!valid) this.valid.push(name);\r\n    },\r\n    notify(title) {\r\n      api.notify({ title });\r\n    },\r\n    update_params() {\r\n      for (var k in this.shortcut_params) {\r\n        const v = this.shortcut_params[k];\r\n        const mapped_to = k.split(\".\");\r\n        var target = this.task.pipeline;\r\n        for (var seg of mapped_to.slice(1, -1)) {\r\n          target = seg.match(/^\\d+$/) ? target[+seg][1] : target[seg];\r\n        }\r\n        target[mapped_to.slice(-1)[0]] = v;\r\n      }\r\n    },\r\n    quicktask() {\r\n      this.update_params();\r\n      this.result_plain = \"\";\r\n      api\r\n        .call(\"quicktask\", {\r\n          pipeline: this.task.pipeline,\r\n        })\r\n        .then((data) => {\r\n          if (Array.isArray(data.result)) {\r\n            this.results = data.result;\r\n            this.$refs.results.start(1);\r\n            this.result_plain = \"\";\r\n          } else if (\r\n            typeof data.result === \"object\" &&\r\n            data.result !== null &&\r\n            data.result.__file_ext__\r\n          ) {\r\n            const b64toBlob = (b64Data, contentType = \"\", sliceSize = 512) => {\r\n              const byteCharacters = atob(b64Data);\r\n              const byteArrays = [];\r\n\r\n              for (\r\n                let offset = 0;\r\n                offset < byteCharacters.length;\r\n                offset += sliceSize\r\n              ) {\r\n                const slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n                const byteNumbers = new Array(slice.length);\r\n                for (let i = 0; i < slice.length; i++) {\r\n                  byteNumbers[i] = slice.charCodeAt(i);\r\n                }\r\n\r\n                const byteArray = new Uint8Array(byteNumbers);\r\n                byteArrays.push(byteArray);\r\n              }\r\n\r\n              const blob = new Blob(byteArrays, { type: contentType });\r\n              return blob;\r\n            };\r\n            api.blob_download(\r\n              b64toBlob(data.result.data),\r\n              this.task.name + \".\" + data.result.__file_ext__\r\n            );\r\n          } else {\r\n            this.result_plain = JSON.stringify(data.result);\r\n            this.results = [];\r\n            this.$refs.results.start(1);\r\n          }\r\n        });\r\n    },\r\n    enqueue() {\r\n      this.update_params();\r\n\r\n      if (this.valid.length > 0) {\r\n        alert(this.$t(\"invalid-input\"));\r\n        return;\r\n      }\r\n      for (var k in this.task.shortcut_map) {\r\n        if (\r\n          typeof this.task.shortcut_map[k] === \"undefined\" ||\r\n          this.task.shortcut_map[k] === \"\" ||\r\n          this.task.shortcut_map[k] === null\r\n        )\r\n          delete this.task.shortcut_map[k];\r\n      }\r\n\r\n      api\r\n        .call(\"tasks/\" + this.task._id, this.task)\r\n        .then((data) => {\r\n          var id = this.task._id;\r\n          this.task = data.result.updated;\r\n          this.task._id = id;\r\n          return id;\r\n        })\r\n        .then((id) =>\r\n          api.put(\"queue/\", { id }).then((data) => {\r\n            this.notify(this.$t(\"task-enqueued\", { task: data.result }));\r\n          })\r\n        );\r\n    },\r\n    querify() {\r\n      var s = api.querify(this.task.pipeline, \"\");\r\n      if (this.task.pipeline.length == 1) return \"[];\" + s;\r\n      return s;\r\n    },\r\n    get_map_arg(v) {\r\n      v = v.split(\".\");\r\n      var arg = {},\r\n        target = this.task.pipeline;\r\n      for (var seg of v.slice(1, -1)) {\r\n        target = seg.match(/^\\d+$/) ? target[+seg] : target[1][seg];\r\n      }\r\n      var argname = v.pop();\r\n      arg = this.stages[target[0]].args.filter((x) => x.name == argname)[0];\r\n      return arg;\r\n    },\r\n    get_map_val(v) {\r\n      v = v.split(\".\");\r\n      var target = this.task.pipeline;\r\n      for (var seg of v.slice(1)) {\r\n        target = seg.match(/^\\d+$/) ? target[+seg][1] : target[seg];\r\n      }\r\n      return target;\r\n    },\r\n    load_search(e) {\r\n      var token = new Date().getTime() + Math.random();\r\n      e.callback({\r\n        result: this.results,\r\n        offset: 0,\r\n        total: this.results.length,\r\n        token,\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskShortcut.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskShortcut.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TaskShortcut.vue?vue&type=template&id=0d4f2c41&\"\nimport script from \"./TaskShortcut.vue?vue&type=script&lang=js&\"\nexport * from \"./TaskShortcut.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"task\"))+\" \"),_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.create_task()}}},[_c('v-icon',[_vm._v(\"mdi-plus\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"new-task\"))+\" \")],1)],1),_c('v-card-text',_vm._l((_vm.tasks),function(task){return _c('v-row',{key:task._id,staticClass:\"ma-3\"},[_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(task.name))]),_c('span',{staticClass:\"opers\"},[_c('v-btn',{attrs:{\"to\":`/tasks/${task._id}`}},[_c('v-icon',[_vm._v(\"mdi-file-edit-outline\")])],1),_c('v-btn',{on:{\"click\":function($event){return _vm.duplicate_task(task)}}},[_c('v-icon',[_vm._v(\"mdi-content-copy\")])],1),_c('v-btn',{on:{\"click\":function($event){return _vm.enqueue_task(task)}}},[_c('v-icon',[_vm._v(\"mdi-play\")])],1)],1),_c('br'),_c('span',{staticClass:\"id\"},[_vm._v(_vm._s(task._id))])])}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-card flat>\r\n    <v-card-title\r\n      >{{ $t(\"task\") }}\r\n      <v-spacer></v-spacer>\r\n      <v-btn color=\"primary\" @click=\"create_task()\">\r\n        <v-icon>mdi-plus</v-icon> {{ $t(\"new-task\") }}\r\n      </v-btn>\r\n    </v-card-title>\r\n    <v-card-text>\r\n      <v-row v-for=\"task in tasks\" :key=\"task._id\" class=\"ma-3\">\r\n        <span class=\"name\">{{ task.name }}</span>\r\n        <span class=\"opers\">\r\n          <v-btn :to=\"`/tasks/${task._id}`\">\r\n            <v-icon>mdi-file-edit-outline</v-icon>\r\n          </v-btn>\r\n\r\n          <v-btn @click=\"duplicate_task(task)\">\r\n            <v-icon>mdi-content-copy</v-icon>\r\n          </v-btn>\r\n\r\n          <v-btn @click=\"enqueue_task(task)\">\r\n            <v-icon>mdi-play</v-icon>\r\n          </v-btn> </span\r\n        ><br />\r\n        <span class=\"id\">{{ task._id }}</span>\r\n      </v-row>\r\n    </v-card-text>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\nimport api from \"../api\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      tasks: [],\r\n    };\r\n  },\r\n  methods: {\r\n    create_task() {\r\n      api\r\n        .put(\"tasks/\", { name: this.$t(\"new-task\") + \" \" + new Date() })\r\n        .then((data) => this.$router.push(\"/tasks/\" + data.result));\r\n    },\r\n    duplicate_task(task) {\r\n      var otask = Object.assign({}, task);\r\n      otask._id = null;\r\n      otask.name += \" \" + this.$t(\"copy\");\r\n      api\r\n        .put(\"tasks/\", otask)\r\n        .then((data) => this.$router.push(\"/tasks/\" + data.result));\r\n    },\r\n    delete_task(task) {\r\n      api\r\n        .delete(\"tasks/\" + task._id)\r\n        .then(() => (this.tasks = this.tasks.filter((x) => x._id != task._id)));\r\n    },\r\n    enqueue_task(task) {\r\n      api.put(\"queue/\", { id: task._id }).then((data) => {\r\n        api.notify(this.$t(\"task-enqueued\", {task: data.result}));\r\n      });\r\n    },\r\n  },\r\n  mounted() {\r\n    api.call(\"tasks/\").then((data) => (this.tasks = data.result));\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nspan.name {\r\n  display: inline-block;\r\n  font-size: 20px;\r\n  padding-right: 20px;\r\n  min-width: 300px;\r\n}\r\n\r\nol {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\n\r\nspan.id::before {\r\n  content: \"ID: \";\r\n}\r\n\r\n.opers .v-btn {\r\n  margin-right: 12px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TaskList.vue?vue&type=template&id=1d2bdd0c&scoped=true&\"\nimport script from \"./TaskList.vue?vue&type=script&lang=js&\"\nexport * from \"./TaskList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TaskList.vue?vue&type=style&index=0&id=1d2bdd0c&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1d2bdd0c\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"datasets\")))]),_c('v-card-text',[_c('v-list',{attrs:{\"two-line\":\"\"}},[_c('draggable',{model:{value:(_vm.datasets),callback:function ($$v) {_vm.datasets=$$v},expression:\"datasets\"}},[_vm._l((_vm.datasets),function(ds){return [_c('v-list-item',{key:ds._id},[_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\" \"+_vm._s(ds.display_name || ds.name)+\" \"),(ds.display_name)?_c('span',[_vm._v(\"(\"+_vm._s(ds.name)+\")\")]):_vm._e(),_c('v-btn',{staticClass:\"oper\",attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.rename_collection(ds, _vm.prompt(_vm.$t('raname-to'), ds.name))}}},[_c('v-icon',[_vm._v(\"mdi-form-textbox\")])],1),_c('v-btn',{staticClass:\"oper\",attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.refresh_sources(ds)}}},[_c('v-icon',[_vm._v(\"mdi-sync\")])],1)],1)],1)],1)]})],2)],1),_c('v-row',[_c('v-col',{staticClass:\"opers\",attrs:{\"cols\":\"2\"}},[_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":_vm.append_dataset}},[_c('v-icon',[_vm._v(\"mdi-plus\")])],1)],1),_c('v-col',[_c('ParamInput',{attrs:{\"arg\":{ name: _vm.$t('name'), type: '', default: '' }},model:{value:(_vm.input_coll.name),callback:function ($$v) {_vm.$set(_vm.input_coll, \"name\", $$v)},expression:\"input_coll.name\"}})],1),_c('v-col',[_c('ParamInput',{attrs:{\"arg\":{ name: _vm.$t('display-name'), type: '', default: '' }},model:{value:(_vm.input_coll.display_name),callback:function ($$v) {_vm.$set(_vm.input_coll, \"display_name\", $$v)},expression:\"input_coll.display_name\"}})],1),_c('v-col',[_c('ParamInput',{attrs:{\"arg\":{ name: _vm.$t('mongocollection'), type: '', default: '' }},model:{value:(_vm.input_coll.mongocollection),callback:function ($$v) {_vm.$set(_vm.input_coll, \"mongocollection\", $$v)},expression:\"input_coll.mongocollection\"}})],1)],1),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.save}},[_c('v-icon',[_vm._v(\"mdi-check\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"save\"))+\" \")],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-card flat>\r\n    <v-card-title>{{ $t(\"datasets\") }}</v-card-title>\r\n    <v-card-text>\r\n      <v-list two-line>\r\n        <draggable v-model=\"datasets\">\r\n          <template v-for=\"ds in datasets\">\r\n            <v-list-item :key=\"ds._id\">\r\n              <v-list-item-content>\r\n                <v-list-item-title>\r\n                  {{ ds.display_name || ds.name }}\r\n                  <span v-if=\"ds.display_name\">({{ ds.name }})</span>\r\n                  <v-btn\r\n                    class=\"oper\"\r\n                    icon\r\n                    @click=\"\r\n                      rename_collection(ds, prompt($t('raname-to'), ds.name))\r\n                    \"\r\n                  >\r\n                    <v-icon>mdi-form-textbox</v-icon>\r\n                  </v-btn>\r\n\r\n                  <v-btn class=\"oper\" icon @click=\"refresh_sources(ds)\">\r\n                    <v-icon>mdi-sync</v-icon>\r\n                  </v-btn>\r\n                </v-list-item-title>\r\n              </v-list-item-content>\r\n            </v-list-item>\r\n          </template>\r\n        </draggable>\r\n      </v-list>\r\n      <v-row>\r\n        <v-col class=\"opers\" cols=\"2\">\r\n          <v-btn icon @click=\"append_dataset\">\r\n            <v-icon>mdi-plus</v-icon>\r\n          </v-btn>\r\n        </v-col>\r\n        <v-col>\r\n          <ParamInput\r\n            :arg=\"{ name: $t('name'), type: '', default: '' }\"\r\n            v-model=\"input_coll.name\"\r\n        /></v-col>\r\n        <v-col>\r\n          <ParamInput\r\n            :arg=\"{ name: $t('display-name'), type: '', default: '' }\"\r\n            v-model=\"input_coll.display_name\"\r\n        /></v-col>\r\n        <v-col>\r\n          <ParamInput\r\n            :arg=\"{ name: $t('mongocollection'), type: '', default: '' }\"\r\n            v-model=\"input_coll.mongocollection\"\r\n        /></v-col>\r\n      </v-row>\r\n      <v-btn @click=\"save\" color=\"primary\">\r\n        <v-icon>mdi-check</v-icon> {{ $t(\"save\") }}\r\n      </v-btn>\r\n    </v-card-text></v-card\r\n  >\r\n</template>\r\n\r\n<script>\r\nimport ParamInput from \"../components/ParamInput\";\r\nimport draggable from \"vuedraggable\";\r\n\r\nimport api from \"../api\";\r\n\r\nexport default {\r\n  name: \"DatasetList\",\r\n  components: {\r\n    ParamInput,\r\n    draggable,\r\n  },\r\n  data() {\r\n    return {\r\n      datasets: [],\r\n      input_coll: {},\r\n      valid: [],\r\n    };\r\n  },\r\n  mounted() {\r\n    this.load_datasets();\r\n  },\r\n  methods: {\r\n    load_datasets() {\r\n      api.get_datasets().then((x) => (this.datasets = x));\r\n    },\r\n    prompt(t, v) {\r\n      return window.prompt(t, v);\r\n    },\r\n    update_valid(id, field, value) {\r\n      var coll = { _id: id };\r\n      coll[field] = value;\r\n      api\r\n        .call(\"datasets/edit\", coll)\r\n        .then(() => api.notify({ title: this.$t(\"updated\") }));\r\n    },\r\n    save() {\r\n      if (this.valid.length > 0) {\r\n        alert(this.$t(\"invalid-input\"));\r\n        return;\r\n      }\r\n      api\r\n        .call(\r\n          \"datasets/batch\",\r\n          this.datasets.map((x, i) =>\r\n            Object.assign({}, x, { order_weight: i, sources: null })\r\n          )\r\n        )\r\n        .then(() => api.notify({ title: this.$t(\"saved\") }));\r\n    },\r\n    append_dataset() {\r\n      if (!this.input_coll.name) return;\r\n      api.call(\"datasets/edit\", this.input_coll).then(() => {\r\n        this.load_datasets();\r\n        this.input_coll = {};\r\n      });\r\n    },\r\n    rename_collection(coll, to) {\r\n      if (coll && to)\r\n        api\r\n          .call(\"datasets/rename\", { _id: coll._id, to })\r\n          .then(() => api.notify({ title: this.$t(\"renamed\") }))\r\n          .then(this.load_datasets);\r\n    },\r\n    refresh_sources(coll) {\r\n      api\r\n        .call(\"datasets/sources\", { _id: coll._id })\r\n        .then(() => api.notify({ title: this.$t(\"refreshed\") }));\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nlabel {\r\n  font-size: 20px;\r\n  text-align: right;\r\n  vertical-align: baseline;\r\n  line-height: 64px;\r\n}\r\n\r\n[disabled] {\r\n  opacity: 0;\r\n}\r\n\r\n.oper {\r\n  opacity: 0;\r\n}\r\n\r\n:hover > .oper {\r\n  opacity: 100%;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DatasetList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DatasetList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DatasetList.vue?vue&type=template&id=3ab1b9ae&scoped=true&\"\nimport script from \"./DatasetList.vue?vue&type=script&lang=js&\"\nexport * from \"./DatasetList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DatasetList.vue?vue&type=style&index=0&id=3ab1b9ae&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3ab1b9ae\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"history\")))]),_c('v-card-text',_vm._l((_vm.history),function(h){return _c('v-row',{key:h._id},[_c('v-col',[_vm._v(_vm._s(h.user))]),_c('v-col',[_vm._v(_vm._s(h.created_at))]),_c('v-col',{attrs:{\"cols\":\"6\"},domProps:{\"textContent\":_vm._s(h.queries.join('\\n'))}}),_c('v-col',[_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.export_query(h)}}},[_c('v-icon',[_vm._v(\"mdi-file-export\")])],1),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.replay(h)}}},[_c('v-icon',[_vm._v(\"mdi-eye\")])],1)],1)],1)}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card flat>\n    <v-card-title>{{ $t(\"history\") }}</v-card-title>\n    <v-card-text>\n      <v-row v-for=\"h in history\" :key=\"h._id\">\n        <v-col>{{ h.user }}</v-col>\n        <v-col>{{ h.created_at }}</v-col>\n        <v-col cols=\"6\" v-text=\"h.queries.join('\\n')\"></v-col>\n        <v-col>\n          <v-btn icon @click=\"export_query(h)\">\n            <v-icon>mdi-file-export</v-icon>\n          </v-btn>\n          <v-btn icon @click=\"replay(h)\">\n            <v-icon>mdi-eye</v-icon>\n          </v-btn>\n        </v-col>\n      </v-row>\n    </v-card-text>\n  </v-card>\n</template>\n\n<script>\nimport api from \"../api\";\n\nexport default {\n  data() {\n    return { history: [] };\n  },\n  mounted() {\n    api.call(\"history\").then((data) => (this.history = data.result));\n  },\n  methods: {\n    export_query(h) {\n      api\n        .put(\"tasks/\", {\n          pipeline: [\n            [\n              \"DBQueryDataSource\",\n              {\n                query: h.queries[0],\n              },\n            ],\n          ],\n          name: this.$t(\"search\") + \" \" + h.queries[0],\n        })\n        .then((data) => this.$router.push(\"/tasks/\" + data.result))\n        .catch(() => {});\n    },\n    replay(h) {\n      this.$router.push(\n        \"search?q=\" +\n          encodeURIComponent(h.queries[0]) +\n          \"&req=\" +\n          encodeURIComponent(h.queries[1])\n      );\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./History.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./History.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./History.vue?vue&type=template&id=01058ce6&\"\nimport script from \"./History.vue?vue&type=script&lang=js&\"\nexport * from \"./History.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"login\")))]),_c('v-card-text',[_c('v-tabs',{model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},[_c('v-tab',{key:\"form\"},[_vm._v(_vm._s(_vm.$t(\"username-login\")))]),_c('v-tab',{key:\"otp\"},[_vm._v(_vm._s(_vm.$t(\"otp-login\")))])],1),_c('v-tabs-items',{model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},[_c('v-tab-item',{key:\"form\"},[_c('v-text-field',{attrs:{\"label\":_vm.$t('username')},model:{value:(_vm.username),callback:function ($$v) {_vm.username=$$v},expression:\"username\"}}),_c('v-text-field',{attrs:{\"type\":\"password\",\"label\":_vm.$t('password')},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.login.apply(null, arguments)}},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}})],1),_c('v-tab-item',{key:\"otp\"},[_c('v-text-field',{attrs:{\"label\":_vm.$t('username')},model:{value:(_vm.username),callback:function ($$v) {_vm.username=$$v},expression:\"username\"}}),_c('v-otp-input',{staticClass:\"otp-input\",attrs:{\"length\":\"6\"},on:{\"finish\":_vm.login},model:{value:(_vm.otp),callback:function ($$v) {_vm.otp=$$v},expression:\"otp\"}})],1)],1)],1),_c('v-card-actions',[_c('v-btn',{attrs:{\"color\":\"primary\",\"dark\":\"\"},on:{\"click\":_vm.login}},[_vm._v(_vm._s(_vm.$t(\"login\")))]),_c('v-spacer'),_c('v-checkbox',{attrs:{\"label\":_vm.$t('remember-me')},model:{value:(_vm.remember),callback:function ($$v) {_vm.remember=$$v},expression:\"remember\"}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card flat>\n    <v-card-title>{{ $t(\"login\") }}</v-card-title>\n    <v-card-text>\n      <v-tabs v-model=\"tab\">\n        <v-tab key=\"form\">{{ $t(\"username-login\") }}</v-tab>\n        <v-tab key=\"otp\">{{ $t(\"otp-login\") }}</v-tab>\n      </v-tabs>\n      <v-tabs-items v-model=\"tab\">\n        <v-tab-item key=\"form\">\n          <v-text-field\n            v-model=\"username\"\n            :label=\"$t('username')\"\n          ></v-text-field>\n          <v-text-field\n            v-model=\"password\"\n            type=\"password\"\n            :label=\"$t('password')\"\n            @keyup.enter=\"login\"\n          ></v-text-field>\n        </v-tab-item>\n        <v-tab-item key=\"otp\">\n          <v-text-field\n            v-model=\"username\"\n            :label=\"$t('username')\"\n          ></v-text-field>\n          <v-otp-input\n            class=\"otp-input\"\n            v-model=\"otp\"\n            length=\"6\"\n            @finish=\"login\"\n          ></v-otp-input>\n        </v-tab-item>\n      </v-tabs-items>\n    </v-card-text>\n    <v-card-actions>\n      <v-btn @click=\"login\" color=\"primary\" dark>{{ $t(\"login\") }}</v-btn>\n      <v-spacer></v-spacer>\n      <v-checkbox v-model=\"remember\" :label=\"$t('remember-me')\"></v-checkbox>\n    </v-card-actions>\n  </v-card>\n</template>\n\n<script>\nimport api from \"../api\";\n\nexport default {\n  name: \"Login\",\n  data() {\n    return {\n      username: \"\",\n      password: \"\",\n      remember: true,\n      otp: \"\",\n      tab: \"\",\n    };\n  },\n  methods: {\n    login(otp = null) {\n      api\n        .auth(this.username, this.password, otp || this.otp, this.remember)\n        .then(() => {\n          this.$emit(\"logined\");\n          this.$router.push(\"/\");\n        });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.otp-input {\n  max-width: 400px;\n  margin: 0 auto;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=00694030&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=00694030&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"00694030\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"task-result\"))+\" \"+_vm._s(_vm.id))]),_c('v-card-text',[(_vm.prompt)?_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.prompt)}}):(typeof _vm.total === 'number')?_c('ResultsView',{ref:\"results\",on:{\"load\":_vm.load_data}}):(_vm.redirect)?_c('iframe',{attrs:{\"src\":_vm.redirect}}):_c('div',[_vm._v(_vm._s(_vm.$t(\"task-file-result\")))])],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card flat>\n    <v-card-title>{{ $t(\"task-result\") }} {{ id }}</v-card-title>\n    <v-card-text>\n      <p v-if=\"prompt\" v-html=\"prompt\"></p>\n      <ResultsView\n        @load=\"load_data\"\n        v-else-if=\"typeof total === 'number'\"\n        ref=\"results\"\n      />\n      <iframe v-else-if=\"redirect\" :src=\"redirect\" />\n      <div v-else>{{ $t(\"task-file-result\") }}</div>\n    </v-card-text>\n  </v-card>\n</template>\n\n<script>\nimport api from \"../api\";\nimport ResultsView from \"../components/ResultsView\";\n\nexport default {\n  name: \"QueueResult\",\n  props: [\"id\"],\n  components: { ResultsView },\n  data() {\n    return {\n      total: 0,\n      prompt: \"\",\n      redirect: \"\",\n    };\n  },\n  watch: {\n    id() {\n      this.$refs.results.turn_page(1);\n    },\n  },\n  methods: {\n    load_data(e) {\n      var token = new Date().getTime() - Math.random();\n      api\n        .call(\n          \"queue/\" +\n            encodeURIComponent(this.id) +\n            \"?offset=\" +\n            e.offset +\n            \"&limit=\" +\n            e.limit\n        )\n        .then((data) => {\n          if (data.__redirect__) {\n            this.redirect = data.__redirect__;\n            this.total = null;\n          } else if (typeof data.__exception__ !== \"undefined\") {\n            this.prompt = `<h4>${\n              data.__exception__\n            }</h4><pre>${data.__tracestack__.join(\"\\n\")}</pre>`;\n          } else if (data.result) {\n            this.total = data.result.total;\n            e.callback({\n              offset: e.offset,\n              result: data.result.results,\n              token,\n            });\n          }\n        })\n        .catch((ex) => {\n          this.prompt =\n            \"<h4>\" +\n            ex.message +\n            \"</h4><p>\" +\n            ex.stack.replace(/\\n/g, \"<br>\") +\n            \"</p>\";\n          this.total = undefined;\n        });\n    },\n  },\n};\n</script>\n\n<style scoped>\niframe {\n  border: 0;\n  width: 100%;\n  height: calc(100vh - 220px);\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueueResult.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueueResult.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./QueueResult.vue?vue&type=template&id=78f93b1c&scoped=true&\"\nimport script from \"./QueueResult.vue?vue&type=script&lang=js&\"\nexport * from \"./QueueResult.vue?vue&type=script&lang=js&\"\nimport style0 from \"./QueueResult.vue?vue&type=style&index=0&id=78f93b1c&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"78f93b1c\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"file-storage\")))]),_c('v-card-text',[_c('v-progress-linear',_vm._b({directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.progress > 0),expression:\"progress > 0\"}]},'v-progress-linear',_vm.progress,false)),_c('input',{attrs:{\"type\":\"file\",\"value\":\"\",\"id\":\"file\",\"hidden\":\"\",\"multiple\":\"\"},on:{\"change\":_vm.upload_file}}),_c('v-row',[_c('v-col',[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.open_file_dialog()}}},[_c('v-icon',[_vm._v(\"mdi-upload\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"upload\"))+\" \")],1),_c('v-btn',{staticClass:\"ml-5\",attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.new_folder()}}},[_c('v-icon',[_vm._v(\"mdi-plus\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"new-folder\"))+\" \")],1),_c('span',{staticClass:\"name ml-5\"},[_vm._v(_vm._s(_vm.selected_dir))])],1)],1)],1),_c('v-sheet',{staticClass:\"ma-5\"},[_c('v-toolbar',{attrs:{\"flat\":\"\"}},[_c('v-text-field',{attrs:{\"clearable\":\"\",\"flat\":\"\",\"hide-details\":\"\",\"prepend-inner-icon\":\"mdi-magnify\",\"label\":_vm.$t('search'),\"clear-icon-cb\":_vm.update_files},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.search_file.apply(null, arguments)}},model:{value:(_vm.search),callback:function ($$v) {_vm.search=$$v},expression:\"search\"}})],1),_c('v-sheet',[_c('v-data-iterator',{attrs:{\"items\":_vm.files,\"items-per-page\":20,\"page\":_vm.page,\"hide-default-footer\":\"\"},on:{\"update:page\":function($event){_vm.page=$event}},scopedSlots:_vm._u([{key:\"default\",fn:function(props){return [_vm._l((props.items),function(f){return [(f.name == '..' || !f.name.startsWith('.'))?_c('v-row',{key:f.fullpath},[_c('v-col',{staticClass:\"name\"},[(f.type === 'file')?_c('v-btn',{attrs:{\"icon\":\"\",\"href\":_vm.file_link(f)}},[_c('v-icon',[_vm._v(\"mdi-download\")])],1):_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.enter(f.name)}}},[(f.type == 'folder')?_c('v-icon',[_vm._v(\"mdi-folder-open\")]):_c('v-icon',[_vm._v(\"mdi-arrow-left-circle\")])],1),_vm._v(\" \"+_vm._s(f.name == \"..\" ? _vm.$t(\"parent-dir\") : f.name)+\" \"),(f.type == 'file')?_c('div',{staticClass:\"description\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"size\"))+\": \"+_vm._s((f.size / 1024 / 1024).toFixed(2))+\" MB \"+_vm._s(_vm.$t(\"created-at\"))+\": \"+_vm._s(_vm._f(\"dateSafe\")((f.ctime * 1000)))+\" \"+_vm._s(_vm.$t(\"modified-at\"))+\": \"+_vm._s(_vm._f(\"dateSafe\")((f.mtime * 1000)))+\" \")]):_vm._e()],1),_c('v-spacer'),_c('v-col',{staticClass:\"opers\"},[(f.type !== 'back')?_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.copy_file_path(f)}}},[_c('v-icon',[_vm._v(\"mdi-content-copy\")])],1):_vm._e(),(f.name.match(/^jindai\\.plugins\\..*\\.zip$/))?_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.install_plugin(f)}}},[_c('v-icon',[_vm._v(\"mdi-cog-outline\")])],1):_vm._e(),(f.type !== 'back')?_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.rename_file(f)}}},[_c('v-icon',[_vm._v(\"mdi-form-textbox\")])],1):_vm._e()],1)],1):_vm._e()]})]}},{key:\"footer\",fn:function(){return [_c('v-row',{staticClass:\"mt-2\",attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-btn',{staticClass:\"mr-1\",attrs:{\"small\":\"\",\"dark\":\"\",\"fab\":\"\",\"color\":\"blue darken-3\"},on:{\"click\":() => _vm.page > 1 && --_vm.page}},[_c('v-icon',[_vm._v(\"mdi-chevron-left\")])],1),_c('span',{staticClass:\"mr-4 ml-4 grey--text\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"pagination\", { page: _vm.page, total: _vm.pages_count }))+\" \")]),_c('v-btn',{staticClass:\"ml-1\",attrs:{\"small\":\"\",\"dark\":\"\",\"fab\":\"\",\"color\":\"blue darken-3\"},on:{\"click\":() => _vm.page < _vm.pages_count && ++_vm.page}},[_c('v-icon',[_vm._v(\"mdi-chevron-right\")])],1)],1)]},proxy:true}])})],1)],1),_c('v-card-actions',[_c('input',{attrs:{\"type\":\"hidden\",\"id\":\"testing-code\"}})])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-card flat>\r\n    <v-card-title>{{ $t(\"file-storage\") }}</v-card-title>\r\n    <v-card-text>\r\n      <v-progress-linear v-show=\"progress > 0\" v-bind=\"progress\" />\r\n      <input\r\n        type=\"file\"\r\n        value=\"\"\r\n        id=\"file\"\r\n        @change=\"upload_file\"\r\n        hidden\r\n        multiple\r\n      />\r\n      <v-row>\r\n        <v-col>\r\n          <v-btn color=\"primary\" @click=\"open_file_dialog()\">\r\n            <v-icon>mdi-upload</v-icon> {{ $t(\"upload\") }}\r\n          </v-btn>\r\n          <v-btn color=\"primary\" class=\"ml-5\" @click=\"new_folder()\">\r\n            <v-icon>mdi-plus</v-icon> {{ $t(\"new-folder\") }}\r\n          </v-btn>\r\n          <span class=\"name ml-5\">{{ selected_dir }}</span>\r\n        </v-col>\r\n      </v-row>\r\n    </v-card-text>\r\n    <v-sheet class=\"ma-5\">\r\n      <v-toolbar flat>\r\n        <v-text-field\r\n          v-model=\"search\"\r\n          clearable\r\n          flat\r\n          hide-details\r\n          prepend-inner-icon=\"mdi-magnify\"\r\n          :label=\"$t('search')\"\r\n          @keyup.enter=\"search_file\"\r\n          :clear-icon-cb=\"update_files\"\r\n        ></v-text-field>\r\n      </v-toolbar>\r\n      <v-sheet>\r\n        <v-data-iterator\r\n          :items=\"files\"\r\n          :items-per-page=\"20\"\r\n          :page.sync=\"page\"\r\n          hide-default-footer\r\n        >\r\n          <template v-slot:default=\"props\">\r\n            <template v-for=\"f in props.items\">\r\n              <v-row\r\n                :key=\"f.fullpath\"\r\n                v-if=\"f.name == '..' || !f.name.startsWith('.')\"\r\n              >\r\n                <v-col class=\"name\">\r\n                  <v-btn icon :href=\"file_link(f)\" v-if=\"f.type === 'file'\">\r\n                    <v-icon>mdi-download</v-icon>\r\n                  </v-btn>\r\n                  <v-btn icon v-else @click=\"enter(f.name)\">\r\n                    <v-icon v-if=\"f.type == 'folder'\">mdi-folder-open</v-icon>\r\n                    <v-icon v-else>mdi-arrow-left-circle</v-icon>\r\n                  </v-btn>\r\n\r\n                  {{ f.name == \"..\" ? $t(\"parent-dir\") : f.name }}\r\n\r\n                  <div class=\"description\" v-if=\"f.type == 'file'\">\r\n                    {{ $t(\"size\") }}: {{ (f.size / 1024 / 1024).toFixed(2) }} MB\r\n                    {{ $t(\"created-at\") }}: {{ (f.ctime * 1000) | dateSafe }}\r\n                    {{ $t(\"modified-at\") }}:\r\n                    {{ (f.mtime * 1000) | dateSafe }}\r\n                  </div>\r\n                </v-col>\r\n                <v-spacer></v-spacer>\r\n                <v-col class=\"opers\">\r\n                  <v-btn\r\n                    @click=\"copy_file_path(f)\"\r\n                    v-if=\"f.type !== 'back'\"\r\n                    icon\r\n                  >\r\n                    <v-icon>mdi-content-copy</v-icon>\r\n                  </v-btn>\r\n                  <v-btn\r\n                    v-if=\"f.name.match(/^jindai\\.plugins\\..*\\.zip$/)\"\r\n                    @click=\"install_plugin(f)\"\r\n                    icon\r\n                  >\r\n                    <v-icon>mdi-cog-outline</v-icon>\r\n                  </v-btn>\r\n                  <v-btn v-if=\"f.type !== 'back'\" icon @click=\"rename_file(f)\">\r\n                    <v-icon>mdi-form-textbox</v-icon>\r\n                  </v-btn>\r\n                </v-col>\r\n              </v-row>\r\n            </template>\r\n          </template>\r\n\r\n          <template v-slot:footer>\r\n            <v-row class=\"mt-2\" align=\"center\" justify=\"center\">\r\n              <v-btn\r\n                small\r\n                dark\r\n                fab\r\n                color=\"blue darken-3\"\r\n                class=\"mr-1\"\r\n                @click=\"() => page > 1 && --page\"\r\n              >\r\n                <v-icon>mdi-chevron-left</v-icon>\r\n              </v-btn>\r\n              <span class=\"mr-4 ml-4 grey--text\">\r\n                {{ $t(\"pagination\", { page, total: pages_count }) }}\r\n              </span>\r\n              <v-btn\r\n                small\r\n                dark\r\n                fab\r\n                color=\"blue darken-3\"\r\n                class=\"ml-1\"\r\n                @click=\"() => page < pages_count && ++page\"\r\n              >\r\n                <v-icon>mdi-chevron-right</v-icon>\r\n              </v-btn>\r\n            </v-row>\r\n          </template>\r\n        </v-data-iterator>\r\n      </v-sheet>\r\n    </v-sheet>\r\n    <v-card-actions>\r\n      <input type=\"hidden\" id=\"testing-code\" />\r\n    </v-card-actions>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\nimport api from \"../api\";\r\n\r\nexport default {\r\n  name: \"StorageList\",\r\n  data() {\r\n    return {\r\n      files: [],\r\n      selected_dir: \"\",\r\n      progress: 0,\r\n      admin: false,\r\n      search: \"\",\r\n      page: 1,\r\n    };\r\n  },\r\n  computed: {\r\n    pages_count() {\r\n      return Math.ceil(this.files.length / 20);\r\n    },\r\n  },\r\n  methods: {\r\n    open_file_dialog() {\r\n      document.getElementById(\"file\").click();\r\n    },\r\n    new_folder() {\r\n      var folder = prompt(this.$t(\"folder-name\"))\r\n      if (!folder) return\r\n      api.call(`storage/${this.selected_dir}`, {mkdir: folder}).then(() => {\r\n        this.update_files()\r\n      })\r\n    },\r\n    upload_file(e) {\r\n      let data = new FormData();\r\n      for (var i = 0; i < e.target.files.length; ++i)\r\n        data.append(\"file\" + i, e.target.files[i]);\r\n\r\n      api\r\n        .upload(this.selected_dir, data, (e) => {\r\n          this.progress = ((e.loaded * 100) / e.total) | 0;\r\n        })\r\n        .then((data) => {\r\n          this.progress = 0;\r\n          for (var r of data.result)\r\n            this.files.splice(this.selected_dir != \"\" ? 1 : 0, 0, r);\r\n        });\r\n    },\r\n    search_file() {\r\n      if (this.search) {\r\n        api\r\n          .call(`storage/${this.selected_dir}`, { search: this.search })\r\n          .then((data) => {\r\n            this.files = data.result;\r\n          });\r\n      } else {\r\n        this.update_files();\r\n      }\r\n    },\r\n    file_link(f) {\r\n      return \"/api/storage/\" + f.fullpath.split(\"/\").slice(1).join(\"/\");\r\n    },\r\n    install_plugin(f) {\r\n      api.call(\"plugins\", { url: f.fullpath }).then((data) => {\r\n        if (data.result) api.notify(this.$t(\"installed\"));\r\n      });\r\n    },\r\n    rename_file(f) {\r\n      var new_name = prompt(this.$t(\"raname-to\"), f.name);\r\n      if (!new_name) return;\r\n      api.call(\r\n        \"storage/move\",\r\n        { source: f.fullpath, destination: new_name }.then(() =>\r\n          this.update_files()\r\n        )\r\n      );\r\n    },\r\n    update_files() {\r\n      api.call(\"storage/\" + this.selected_dir).then((data) => {\r\n        this.files = data.result;\r\n        if (this.selected_dir !== \"\")\r\n          this.files.splice(0, 0, { name: \"..\", type: \"back\" });\r\n        history.pushState(\r\n          null,\r\n          null,\r\n          api.querystring_stringify({\r\n            path: this.selected_dir,\r\n          })\r\n        );\r\n      });\r\n    },\r\n    copy_file_path(f) {\r\n      const text = f.fullpath;\r\n      const testingCodeToCopy = document.querySelector(\"#testing-code\");\r\n      testingCodeToCopy.setAttribute(\"type\", \"text\");\r\n      testingCodeToCopy.setAttribute(\"value\", text);\r\n      testingCodeToCopy.select();\r\n      try {\r\n        document.execCommand(\"copy\");\r\n      } catch (err) {\r\n        alert(\"Oops, unable to copy\");\r\n      }\r\n      testingCodeToCopy.setAttribute(\"type\", \"hidden\");\r\n      window.getSelection().removeAllRanges();\r\n    },\r\n    enter(d) {\r\n      if (d === \"..\")\r\n        this.selected_dir = this.selected_dir.split(\"/\").slice(0, -1).join(\"/\");\r\n      else\r\n        this.selected_dir = this.selected_dir\r\n          .split(\"/\")\r\n          .filter((x) => x)\r\n          .concat(d)\r\n          .join(\"/\");\r\n    },\r\n  },\r\n  mounted() {\r\n    this.selected_dir = api.querystring_parse(location.search).path || \"\";\r\n    this.update_files();\r\n  },\r\n  watch: {\r\n    selected_dir() {\r\n      this.update_files();\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nspan.name {\r\n  display: inline-block;\r\n  font-size: 20px;\r\n  min-width: 300px;\r\n  padding-right: 20px;\r\n}\r\n\r\nol {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\n\r\nspan.id::before {\r\n  content: \"ID: \";\r\n}\r\n\r\n.description {\r\n  font-size: 12px;\r\n}\r\n\r\n.opers > * {\r\n  margin-left: 10px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StorageList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StorageList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./StorageList.vue?vue&type=template&id=75d2b232&scoped=true&\"\nimport script from \"./StorageList.vue?vue&type=script&lang=js&\"\nexport * from \"./StorageList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./StorageList.vue?vue&type=style&index=0&id=75d2b232&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"75d2b232\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"system-admin\"))+\" \")]),_c('v-card-text',[_c('v-list',{attrs:{\"subheader\":\"\"}},[_c('v-subheader',[_vm._v(\" \"+_vm._s(_vm.$t(\"users\"))+\" \")]),_c('v-list-item',[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){_vm.show_modify = false;\n            _vm.new_user = { roles: [], datasets: [] };\n            _vm.show_user_modal = true;}}},[_c('v-icon',[_vm._v(\"mdi-plus\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"new-user\"))+\" \")],1)],1),_vm._l((_vm.users),function(u){return _c('v-list-item',{key:u._id},[_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(_vm._s(u.username))]),_c('v-list-item-subtitle',[_c('v-btn',{on:{\"click\":function($event){_vm.show_modify = true;\n                _vm.new_user = Object.assign(u, { password: '' });\n                _vm.show_user_modal = true;}}},[_c('v-icon',[_vm._v(\"mdi-account-edit\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"user-role\"))+\" \")],1),_c('v-btn',{staticClass:\"ml-5\",on:{\"click\":function($event){return _vm.del_user(u)}}},[_c('v-icon',[_vm._v(\"mdi-account-cancel\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"delete\"))+\" \")],1)],1)],1)],1)}),_c('v-divide'),_c('v-subheader',[_vm._v(_vm._s(_vm.$t(\"schedule\")))]),_c('v-list-item',[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){_vm.show_creation = true}}},[_c('v-icon',[_vm._v(\"mdi-plus\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"new-schedule\"))+\" \")],1)],1),_vm._l((_vm.scheduled_jobs),function(task){return _c('v-list-item',{key:task.key},[_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\" \"+_vm._s(task.key)+\" : \"+_vm._s(task.name)+\" (\"+_vm._s(task.repr)+\")\")]),_c('v-list-item-subtitle',[_c('v-btn',{on:{\"click\":function($event){return _vm.delete_schedule(task.key)}}},[_c('v-icon',[_vm._v(\"mdi-delete\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"cancel\")))],1)],1)],1)],1)})],2),_c('v-dialog',{model:{value:(_vm.show_user_modal),callback:function ($$v) {_vm.show_user_modal=$$v},expression:\"show_user_modal\"}},[_c('v-card',[(_vm.show_modify)?_c('v-card-title',[_vm._v(\" \"+_vm._s(_vm.$t(\"user-modify\"))+\" \"),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.show_user_modal = false}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1)],1):_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"new-user\")))]),_c('v-card-text',[_c('v-text-field',{attrs:{\"label\":_vm.$t('username'),\"disabled\":_vm.show_modify},model:{value:(_vm.new_user.username),callback:function ($$v) {_vm.$set(_vm.new_user, \"username\", $$v)},expression:\"new_user.username\"}}),_c('v-text-field',{attrs:{\"label\":_vm.$t('password'),\"type\":\"password\",\"disabled\":_vm.show_modify},model:{value:(_vm.new_user.password),callback:function ($$v) {_vm.$set(_vm.new_user, \"password\", $$v)},expression:\"new_user.password\"}}),_c('v-checkbox',{attrs:{\"label\":_vm.$t('role-query'),\"disabled\":\"\",\"input-value\":true}}),_c('v-checkbox',{attrs:{\"label\":_vm.$t('role-task'),\"disabled\":\"\",\"input-value\":true}}),_c('v-checkbox',{attrs:{\"label\":_vm.$t('role-admin'),\"value\":\"admin\"},model:{value:(_vm.new_user.roles),callback:function ($$v) {_vm.$set(_vm.new_user, \"roles\", $$v)},expression:\"new_user.roles\"}}),_c('treeselect',{attrs:{\"multiple\":true,\"options\":_vm.datasets.hierarchy,\"placeholder\":_vm.$t('permitted-datasets')},model:{value:(_vm.new_user.datasets),callback:function ($$v) {_vm.$set(_vm.new_user, \"datasets\", $$v)},expression:\"new_user.datasets\"}})],1),_c('v-card-actions',[(_vm.show_modify)?_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.modify_user_role}},[_vm._v(_vm._s(_vm.$t(\"modify\")))]):_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.add_user}},[_vm._v(_vm._s(_vm.$t(\"ok\")))]),_c('v-btn',{staticClass:\"ml-5\",on:{\"click\":function($event){_vm.show_user_modal = false}}},[_vm._v(_vm._s(_vm.$t(\"cancel\")))])],1)],1)],1),_c('v-dialog',{model:{value:(_vm.show_creation),callback:function ($$v) {_vm.show_creation=$$v},expression:\"show_creation\"}},[_c('v-card',[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"new-schedule\")))]),_c('v-card-text',[_c('ParamInput',{attrs:{\"arg\":{ type: 'TASK', name: _vm.$t('task') }},model:{value:(_vm.scheduler.task),callback:function ($$v) {_vm.$set(_vm.scheduler, \"task\", $$v)},expression:\"scheduler.task\"}}),_c('ParamInput',{attrs:{\"arg\":{ type: 'str', name: 'Description, e.g. day at 06:00' }},model:{value:(_vm.scheduler.cron),callback:function ($$v) {_vm.$set(_vm.scheduler, \"cron\", $$v)},expression:\"scheduler.cron\"}})],1),_c('v-card-actions',[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.create_schedule}},[_c('v-icon',[_vm._v(\"mdi-plus\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"add\")))],1),_c('v-btn',{on:{\"click\":function($event){_vm.show_creation = false}}},[_vm._v(_vm._s(_vm.$t(\"cancel\")))])],1)],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-card flat>\r\n    <v-card-title>{{ $t(\"system-admin\") }} </v-card-title>\r\n    <v-card-text>\r\n      <v-list subheader>\r\n        <v-subheader>\r\n          {{ $t(\"users\") }}\r\n        </v-subheader>\r\n        <v-list-item>\r\n          <v-btn\r\n            color=\"primary\"\r\n            @click=\"\r\n              show_modify = false;\r\n              new_user = { roles: [], datasets: [] };\r\n              show_user_modal = true;\r\n            \"\r\n          >\r\n            <v-icon>mdi-plus</v-icon> {{ $t(\"new-user\") }}\r\n          </v-btn></v-list-item\r\n        >\r\n        <v-list-item v-for=\"u in users\" :key=\"u._id\">\r\n          <v-list-item-content>\r\n            <v-list-item-title>{{ u.username }}</v-list-item-title>\r\n            <v-list-item-subtitle>\r\n              <v-btn\r\n                @click=\"\r\n                  show_modify = true;\r\n                  new_user = Object.assign(u, { password: '' });\r\n                  show_user_modal = true;\r\n                \"\r\n              >\r\n                <v-icon>mdi-account-edit</v-icon> {{ $t(\"user-role\") }}\r\n              </v-btn>\r\n              <v-btn @click=\"del_user(u)\" class=\"ml-5\">\r\n                <v-icon>mdi-account-cancel</v-icon> {{ $t(\"delete\") }}\r\n              </v-btn>\r\n            </v-list-item-subtitle>\r\n          </v-list-item-content>\r\n        </v-list-item>\r\n        <v-divide></v-divide>\r\n        <v-subheader>{{ $t(\"schedule\") }}</v-subheader>\r\n        <v-list-item>\r\n          <v-btn color=\"primary\" @click=\"show_creation = true\">\r\n            <v-icon>mdi-plus</v-icon> {{ $t(\"new-schedule\") }}\r\n          </v-btn></v-list-item\r\n        >\r\n        <v-list-item v-for=\"task in scheduled_jobs\" :key=\"task.key\">\r\n          <v-list-item-content>\r\n            <v-list-item-title>\r\n              {{ task.key }} : {{ task.name }} ({{\r\n                task.repr\r\n              }})</v-list-item-title\r\n            >\r\n            <v-list-item-subtitle>\r\n              <v-btn @click=\"delete_schedule(task.key)\"\r\n                ><v-icon>mdi-delete</v-icon> {{ $t(\"cancel\") }}</v-btn\r\n              >\r\n            </v-list-item-subtitle>\r\n          </v-list-item-content>\r\n        </v-list-item>\r\n      </v-list>\r\n\r\n      <v-dialog v-model=\"show_user_modal\">\r\n        <v-card>\r\n          <v-card-title v-if=\"show_modify\">\r\n            {{ $t(\"user-modify\") }}\r\n            <v-spacer></v-spacer>\r\n            <v-btn icon @click=\"show_user_modal = false\"\r\n              ><v-icon>mdi-close</v-icon></v-btn\r\n            >\r\n          </v-card-title>\r\n          <v-card-title v-else>{{ $t(\"new-user\") }}</v-card-title>\r\n          <v-card-text>\r\n            <v-text-field\r\n              :label=\"$t('username')\"\r\n              v-model=\"new_user.username\"\r\n              :disabled=\"show_modify\"\r\n            ></v-text-field>\r\n            <v-text-field\r\n              :label=\"$t('password')\"\r\n              type=\"password\"\r\n              v-model=\"new_user.password\"\r\n              :disabled=\"show_modify\"\r\n            ></v-text-field>\r\n            <v-checkbox\r\n              :label=\"$t('role-query')\"\r\n              disabled\r\n              :input-value=\"true\"\r\n            ></v-checkbox>\r\n            <v-checkbox\r\n              :label=\"$t('role-task')\"\r\n              disabled\r\n              :input-value=\"true\"\r\n            ></v-checkbox>\r\n            <v-checkbox\r\n              :label=\"$t('role-admin')\"\r\n              value=\"admin\"\r\n              v-model=\"new_user.roles\"\r\n            ></v-checkbox>\r\n\r\n            <treeselect\r\n              :multiple=\"true\"\r\n              :options=\"datasets.hierarchy\"\r\n              v-model=\"new_user.datasets\"\r\n              :placeholder=\"$t('permitted-datasets')\"\r\n            />\r\n          </v-card-text>\r\n          <v-card-actions>\r\n            <v-btn\r\n              @click=\"modify_user_role\"\r\n              color=\"primary\"\r\n              v-if=\"show_modify\"\r\n              >{{ $t(\"modify\") }}</v-btn\r\n            ><v-btn @click=\"add_user\" color=\"primary\" v-else>{{\r\n              $t(\"ok\")\r\n            }}</v-btn>\r\n            <v-btn @click=\"show_user_modal = false\" class=\"ml-5\">{{\r\n              $t(\"cancel\")\r\n            }}</v-btn></v-card-actions\r\n          >\r\n        </v-card>\r\n      </v-dialog>\r\n      <v-dialog v-model=\"show_creation\">\r\n        <v-card>\r\n          <v-card-title>{{ $t(\"new-schedule\") }}</v-card-title>\r\n          <v-card-text>\r\n            <ParamInput\r\n              v-model=\"scheduler.task\"\r\n              :arg=\"{ type: 'TASK', name: $t('task') }\"\r\n            />\r\n            <ParamInput\r\n              v-model=\"scheduler.cron\"\r\n              :arg=\"{ type: 'str', name: 'Description, e.g. day at 06:00' }\"\r\n            />\r\n          </v-card-text>\r\n          <v-card-actions\r\n            ><v-btn @click=\"create_schedule\" color=\"primary\">\r\n              <v-icon>mdi-plus</v-icon>\r\n              {{ $t(\"add\") }}</v-btn\r\n            >\r\n            <v-btn @click=\"show_creation = false\">{{ $t(\"cancel\") }}</v-btn>\r\n          </v-card-actions>\r\n        </v-card>\r\n      </v-dialog>\r\n    </v-card-text>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\nimport api from \"../api\";\r\nimport ParamInput from \"../components/ParamInput.vue\";\r\nexport default {\r\n  name: \"UserList\",\r\n  components: { ParamInput },\r\n  data() {\r\n    return {\r\n      users: [],\r\n      show_user_modal: false,\r\n      show_modify: false,\r\n      datasets: [],\r\n      new_user: {\r\n        roles: [],\r\n        datasets: [],\r\n      },\r\n      scheduled_jobs: [],\r\n      show_creation: false,\r\n      scheduler: {\r\n        task: \"\",\r\n        cron: \"\",\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    add_user() {\r\n      api.put(\"users/\", this.new_user).then((data) => {\r\n        api.notify({\r\n          text: this.$t(\"user-added\", { user: data.result.username }),\r\n        });\r\n        this.users.push(data.result);\r\n        this.show_user_modal = false;\r\n      });\r\n    },\r\n    del_user(u) {\r\n      if (!confirm(this.$t(\"user-delete-confirm\", { user: u.username })))\r\n        return;\r\n      api.delete(\"users/\" + u.username).then((data) => {\r\n        if (!data.result.ok) return;\r\n        api.notify({ text: this.$t(\"user-deleted\", { user: u.username }) });\r\n        this.users = this.users.filter((x) => x._id != u._id);\r\n      });\r\n    },\r\n    modify_user_role() {\r\n      api\r\n        .call(\"users/\" + this.new_user.username, {\r\n          roles: this.new_user.roles,\r\n          datasets: this.new_user.datasets,\r\n        })\r\n        .then(() => (this.show_user_modal = false));\r\n    },\r\n    update_scheduler() {\r\n      api.call(\"scheduler\").then((data) => (this.scheduled_jobs = data.result));\r\n    },\r\n    create_schedule() {\r\n      var text = `every ${this.scheduler.cron} do ${this.scheduler.task}`;\r\n      api.put(\"scheduler\", { text }).then(() => {\r\n        this.scheduler = {\r\n          cron: \"\",\r\n          task: \"\",\r\n        };\r\n        this.update_scheduler();\r\n      });\r\n      this.show_creation = false;\r\n    },\r\n    delete_schedule(key) {\r\n      api.delete(\"scheduler/\" + key).then(() => {\r\n        api.notify({ title: this.$t(\"deleted\") });\r\n        this.update_scheduler();\r\n      });\r\n    },\r\n  },\r\n  mounted() {\r\n    api.call(\"users/\").then((data) => (this.users = data.result));\r\n    api.get_datasets_hierarchy().then((data) => (this.datasets = data));\r\n    this.update_scheduler();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nspan.name {\r\n  display: inline-block;\r\n  font-size: 20px;\r\n  min-width: 300px;\r\n  padding-right: 20px;\r\n}\r\n\r\nol {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\n\r\nspan.id::before {\r\n  content: \"ID: \";\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SystemAdmin.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SystemAdmin.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SystemAdmin.vue?vue&type=template&id=4a6f3d06&scoped=true&\"\nimport script from \"./SystemAdmin.vue?vue&type=script&lang=js&\"\nexport * from \"./SystemAdmin.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SystemAdmin.vue?vue&type=style&index=0&id=4a6f3d06&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4a6f3d06\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t(\"preferences\")))]),_c('v-card-text',[_c('v-sheet',[_c('v-text-field',{attrs:{\"type\":\"password\",\"label\":_vm.$t('password-old')},model:{value:(_vm.old_password),callback:function ($$v) {_vm.old_password=$$v},expression:\"old_password\"}}),_c('v-text-field',{attrs:{\"type\":\"password\",\"label\":_vm.$t('password-new')},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}}),_c('v-text-field',{attrs:{\"type\":\"password\",\"label\":_vm.$t('password-repeated')},model:{value:(_vm.password2),callback:function ($$v) {_vm.password2=$$v},expression:\"password2\"}})],1),_c('v-sheet',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.otp_secret),expression:\"otp_secret\"}],staticClass:\"otp-info\"},[_c('v-row',[_c('div',{ref:\"qrCodeUrl\",staticClass:\"qrcode\"}),_c('div',{staticClass:\"ml-5\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"otp-prompt\", { otp_secret: _vm.otp_secret }))+\" \")])])],1),_c('v-sheet',[_c('v-btn',{staticClass:\"mr-3\",attrs:{\"color\":\"primary\"},on:{\"click\":_vm.update_password}},[_vm._v(\" \"+_vm._s(_vm.$t(\"password-update\"))+\" \")]),(!_vm.otp)?_c('v-btn',{on:{\"click\":function($event){return _vm.change_otp(true)}}},[_vm._v(_vm._s(_vm.$t(\"otp-enable\")))]):_c('v-btn',{on:{\"click\":function($event){return _vm.change_otp(false)}}},[_vm._v(_vm._s(_vm.$t(\"otp-disable\")))])],1),_c('v-sheet',{staticClass:\"mt-5\"},[_c('v-row',[_c('v-col',[_c('v-checkbox',{attrs:{\"flat\":\"\",\"label\":_vm.$t('image-full-size')},model:{value:(_vm.config.contain),callback:function ($$v) {_vm.$set(_vm.config, \"contain\", $$v)},expression:\"config.contain\"}})],1)],1),_c('v-row',[_c('v-col',[_c('v-checkbox',{attrs:{\"flat\":\"\",\"label\":_vm.$t('expert-mode')},model:{value:(_vm.config.expert),callback:function ($$v) {_vm.$set(_vm.config, \"expert\", $$v)},expression:\"config.expert\"}})],1)],1),_c('v-row',[_c('v-col',[_c('v-checkbox',{attrs:{\"flat\":\"\",\"label\":_vm.$t('image-thumbnail')},model:{value:(_vm.config.force_thumbnail),callback:function ($$v) {_vm.$set(_vm.config, \"force_thumbnail\", $$v)},expression:\"config.force_thumbnail\"}})],1)],1),_c('v-row',[_c('v-col',[_c('v-checkbox',{attrs:{\"flat\":\"\",\"label\":_vm.$t('image-enhance')},model:{value:(_vm.config.enhance),callback:function ($$v) {_vm.$set(_vm.config, \"enhance\", $$v)},expression:\"config.enhance\"}})],1)],1),_c('v-row',[_c('v-col',[_c('v-text-field',{attrs:{\"type\":\"number\",\"label\":_vm.$t('playing-interval')},model:{value:(_vm.config.playing_interval),callback:function ($$v) {_vm.$set(_vm.config, \"playing_interval\", $$v)},expression:\"config.playing_interval\"}})],1)],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card flat>\n    <v-card-title>{{ $t(\"preferences\") }}</v-card-title>\n    <v-card-text>\n      <v-sheet>\n        <v-text-field\n          v-model=\"old_password\"\n          type=\"password\"\n          :label=\"$t('password-old')\"\n        ></v-text-field>\n        <v-text-field\n          v-model=\"password\"\n          type=\"password\"\n          :label=\"$t('password-new')\"\n        ></v-text-field>\n        <v-text-field\n          v-model=\"password2\"\n          type=\"password\"\n          :label=\"$t('password-repeated')\"\n        ></v-text-field>\n      </v-sheet>\n      <v-sheet v-show=\"otp_secret\" class=\"otp-info\">\n        <v-row>\n          <div class=\"qrcode\" ref=\"qrCodeUrl\"></div>\n          <div class=\"ml-5\">\n            {{ $t(\"otp-prompt\", { otp_secret }) }}\n          </div>\n        </v-row>\n      </v-sheet>\n      <v-sheet>\n        <v-btn color=\"primary\" class=\"mr-3\" @click=\"update_password\">\n          {{ $t(\"password-update\") }}\n        </v-btn>\n        <v-btn @click=\"change_otp(true)\" v-if=\"!otp\">{{\n          $t(\"otp-enable\")\n        }}</v-btn>\n        <v-btn @click=\"change_otp(false)\" v-else>{{ $t(\"otp-disable\") }}</v-btn>\n      </v-sheet>\n      <v-sheet class=\"mt-5\">\n        <v-row>\n          <v-col>\n            <v-checkbox\n              flat\n              v-model=\"config.contain\"\n              :label=\"$t('image-full-size')\"\n            ></v-checkbox> </v-col\n        ></v-row>\n        <v-row>\n          <v-col>\n            <v-checkbox\n              flat\n              v-model=\"config.expert\"\n              :label=\"$t('expert-mode')\"\n            ></v-checkbox> </v-col\n        ></v-row>\n        <v-row\n          ><v-col>\n            <v-checkbox\n              flat\n              v-model=\"config.force_thumbnail\"\n              :label=\"$t('image-thumbnail')\"\n            ></v-checkbox></v-col\n        ></v-row>\n        <v-row\n          ><v-col>\n            <v-checkbox\n              flat\n              v-model=\"config.enhance\"\n              :label=\"$t('image-enhance')\"\n            ></v-checkbox>\n          </v-col>\n        </v-row>\n        <v-row>\n          <v-col>\n            <v-text-field\n              type=\"number\"\n              :label=\"$t('playing-interval')\"\n              v-model=\"config.playing_interval\"\n            ></v-text-field> </v-col\n        ></v-row>\n      </v-sheet>\n    </v-card-text>\n  </v-card>\n</template>\n\n\n<script>\nimport api from \"../api\";\nimport QRCode from \"qrcodejs2\";\n\nexport default {\n  name: \"Preferences\",\n  data() {\n    return {\n      old_password: \"\",\n      password: \"\",\n      password2: \"\",\n      otp: false,\n      otp_secret: \"\",\n      username: \"\",\n      config: api.config,\n    };\n  },\n  mounted() {\n    api.call(\"authenticate\").then((data) => {\n      this.otp = data.result.otp_secret;\n      this.username = data.result.username;\n    });\n  },\n  methods: {\n    update_password() {\n      if (this.password !== this.password2) {\n        api.notify({ text: this.$t(\"password-dismatch\") });\n      } else {\n        api\n          .call(\"account/\", {\n            old_password: this.old_password,\n            password: this.password,\n          })\n          .then(api.notify(this.$t(\"updated\")));\n      }\n    },\n    change_otp(otp) {\n      api.call(\"account/\", { otp }).then((data) => {\n        api.notify(this.$t(\"updated\"));\n        this.otp = otp;\n        if (otp && data.result) {\n          this.otp_secret = data.result;\n          this.create_qr_code();\n        }\n      });\n    },\n    create_qr_code() {\n      new QRCode(this.$refs.qrCodeUrl, {\n        text: `otpauth://totp/${this.username}?secret=${this.otp_secret}`,\n        width: 100,\n        height: 100,\n        colorDark: \"#000000\",\n        colorLight: \"#ffffff\",\n        correctLevel: QRCode.CorrectLevel.H,\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.qrcode {\n  display: inline-block;\n}\n\n.qrcode img {\n  width: 132px;\n  height: 132px;\n  background-color: #fff;\n  padding: 6px;\n  box-sizing: border-box;\n}\n\n.otp-info {\n  margin: 20px;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preferences.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preferences.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Preferences.vue?vue&type=template&id=e2992790&scoped=true&\"\nimport script from \"./Preferences.vue?vue&type=script&lang=js&\"\nexport * from \"./Preferences.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Preferences.vue?vue&type=style&index=0&id=e2992790&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e2992790\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(\" \"+_vm._s(_vm.$t(\"console\"))+\" \")]),_c('v-card-text',[_c('v-select',{attrs:{\"label\":\"Mongo Collection\",\"items\":_vm.mongocollections},on:{\"change\":function($event){_vm.previewed = _vm.command.operation == 'count'}},model:{value:(_vm.command.mongocollection),callback:function ($$v) {_vm.$set(_vm.command, \"mongocollection\", $$v)},expression:\"command.mongocollection\"}}),_c('ParamInput',{attrs:{\"arg\":{ name: 'Query', type: 'QUERY' }},on:{\"input\":function($event){_vm.previewed = _vm.command.operation == 'count'}},model:{value:(_vm.command.query),callback:function ($$v) {_vm.$set(_vm.command, \"query\", $$v)},expression:\"command.query\"}}),_c('ParamInput',{attrs:{\"arg\":{ name: 'Operation', type: 'update_many|delete_many|count' }},on:{\"input\":function($event){_vm.previewed = _vm.command.operation == 'count'}},model:{value:(_vm.command.operation),callback:function ($$v) {_vm.$set(_vm.command, \"operation\", $$v)},expression:\"command.operation\"}}),_c('ParamInput',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.command.operation != 'count'),expression:\"command.operation != 'count'\"}],attrs:{\"arg\":{ name: 'Parameters', type: 'QUERY' }},on:{\"input\":function($event){_vm.previewed = _vm.command.operation == 'count'}},model:{value:(_vm.command.operation_params),callback:function ($$v) {_vm.$set(_vm.command, \"operation_params\", $$v)},expression:\"command.operation_params\"}})],1),_c('v-card-actions',[_c('v-btn',{on:{\"click\":_vm.preview}},[_vm._v(_vm._s(_vm.$t(\"preview\")))]),_c('v-btn',{attrs:{\"disabled\":!_vm.previewed},on:{\"click\":_vm.execute}},[_vm._v(_vm._s(_vm.$t(\"execute\")))])],1),_c('v-card-text',[_c('pre',[_vm._v(_vm._s(_vm.preview_text))])]),_c('v-card-text',[_vm._v(\" \"+_vm._s(_vm.$t('history'))+\" \"),_vm._l((_vm.config.dbconsole.history),function(h,index){return _c('v-row',{key:index},[_c('v-col',[_vm._v(_vm._s(_vm.stringify_command(h)))]),_c('v-col',[_c('v-button',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.replay(h)}}},[_c('v-icon',[_vm._v(\"mdi-replay\")])],1)],1)],1)})],2)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-card flat>\r\n    <v-card-title>\r\n      {{ $t(\"console\") }}\r\n    </v-card-title>\r\n    <v-card-text>\r\n      <v-select\r\n        label=\"Mongo Collection\"\r\n        :items=\"mongocollections\"\r\n        v-model=\"command.mongocollection\"\r\n        @change=\"previewed = command.operation == 'count'\"\r\n      ></v-select>\r\n      <ParamInput\r\n        :arg=\"{ name: 'Query', type: 'QUERY' }\"\r\n        v-model=\"command.query\"\r\n        @input=\"previewed = command.operation == 'count'\"\r\n      />\r\n      <ParamInput\r\n        :arg=\"{ name: 'Operation', type: 'update_many|delete_many|count' }\"\r\n        v-model=\"command.operation\"\r\n        @input=\"previewed = command.operation == 'count'\"\r\n      />\r\n      <ParamInput\r\n        :arg=\"{ name: 'Parameters', type: 'QUERY' }\"\r\n        v-model=\"command.operation_params\"\r\n        @input=\"previewed = command.operation == 'count'\"\r\n        v-show=\"command.operation != 'count'\"\r\n      />\r\n    </v-card-text>\r\n    <v-card-actions>\r\n      <v-btn @click=\"preview\">{{ $t(\"preview\") }}</v-btn>\r\n      <v-btn :disabled=\"!previewed\" @click=\"execute\">{{ $t(\"execute\") }}</v-btn>\r\n    </v-card-actions>\r\n    <v-card-text>\r\n      <pre>{{ preview_text }}</pre>\r\n    </v-card-text>\r\n    <v-card-text>\r\n      {{ $t('history') }}\r\n      <v-row v-for=\"(h, index) in config.dbconsole.history\" :key=\"index\">\r\n        <v-col>{{ stringify_command(h) }}</v-col>\r\n        <v-col><v-button icon @click=\"replay(h)\"><v-icon>mdi-replay</v-icon></v-button></v-col>\r\n      </v-row>\r\n    </v-card-text>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\nimport api from \"../api\";\r\nimport ParamInput from \"../components/ParamInput\";\r\n\r\nexport default {\r\n  name: \"DbConsole\",\r\n  components: { ParamInput },\r\n  data() {\r\n    return {\r\n      mongocollections: [api.config.dbconsole.mongocollection || \"paragraph\"],\r\n      command: {\r\n        mongocollection: api.config.dbconsole.mongocollection || \"paragraph\",\r\n        query: \"\",\r\n        operation: \"count\",\r\n        operation_params: \"\",\r\n        preview: true,\r\n      },\r\n      previewed: false,\r\n      preview_text: \"\",\r\n      config: api.config\r\n    };\r\n  },\r\n  methods: {\r\n    get_command() {\r\n      return Object.assign({}, this.command, {\r\n        operation_params:\r\n          this.command.operation == \"count\" ? \"\" : this.command.operation_params,\r\n      });\r\n    },\r\n    stringify_command(data) {\r\n      return 'MongoCollection(\"' +\r\n        data.mongocollection +\r\n        '\").query(' +\r\n        JSON.stringify(data.query, \"\", 2) +\r\n        \").\" +\r\n        data.operation +\r\n        \"(\" +\r\n        JSON.stringify(data.operation_params, \"\", 2) +\r\n        \")\";\r\n    },\r\n    preview() {\r\n      this.command.preview = true;\r\n      api.call(\"admin/db\", this.get_command()).then((data) => {\r\n        data = data.result;\r\n        this.preview_text = this.stringify_command(data)\r\n        this.previewed = true;\r\n      });\r\n    },\r\n    execute() {\r\n      this.command.preview = false;\r\n      api.config.dbconsole.mongocollection = this.command.mongocollection;\r\n      if (!api.config.dbconsole.history) api.config.dbconsole.history = []\r\n      api.config.dbconsole.history.splice(0, 0, Object.assign({}, this.command));\r\n      if (api.config.dbconsole.history.length > 10) api.config.dbconsole.history = api.config.dbconsole.history.slice(0, 10)\r\n      api.config.save();\r\n      api.call(\"admin/db\", this.get_command()).then((data) => {\r\n        this.preview_text += \"\\n\\n\" + JSON.stringify(data.result, \"\", 2);\r\n      });\r\n    },\r\n    replay(h) {\r\n      this.command = Object.assign({}, h);\r\n      this.execute();\r\n    }\r\n  },\r\n  mounted() {\r\n    api\r\n      .call(\"admin/db/collections\")\r\n      .then((data) => (this.mongocollections = data.result));\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nspan.name {\r\n  display: inline-block;\r\n  font-size: 20px;\r\n  min-width: 300px;\r\n  padding-right: 20px;\r\n}\r\n\r\nol {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\n\r\nspan.id::before {\r\n  content: \"ID: \";\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DbConsole.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DbConsole.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DbConsole.vue?vue&type=template&id=59c088dc&scoped=true&\"\nimport script from \"./DbConsole.vue?vue&type=script&lang=js&\"\nexport * from \"./DbConsole.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DbConsole.vue?vue&type=style&index=0&id=59c088dc&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"59c088dc\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(\" \"+_vm._s(_vm.$t(\"auto-tagging\"))+\" \")]),_c('v-card-text',[_c('v-data-iterator',{attrs:{\"items\":_vm.auto_tags,\"items-per-page\":20,\"page\":_vm.page,\"search\":_vm.search,\"hide-default-footer\":\"\"},on:{\"update:page\":function($event){_vm.page=$event}},scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('v-toolbar',{attrs:{\"flat\":\"\"}},[_c('v-text-field',{attrs:{\"clearable\":\"\",\"flat\":\"\",\"hide-details\":\"\",\"prepend-inner-icon\":\"mdi-magnify\",\"label\":_vm.$t('search')},model:{value:(_vm.search),callback:function ($$v) {_vm.search=$$v},expression:\"search\"}})],1),_c('v-toolbar',{staticClass:\"mb-5\",attrs:{\"flat\":\"\"}},[_c('v-text-field',{attrs:{\"label\":_vm.$t('match-cond')},model:{value:(_vm.new_tag.cond),callback:function ($$v) {_vm.$set(_vm.new_tag, \"cond\", $$v)},expression:\"new_tag.cond\"}}),_c('v-text-field',{staticClass:\"new-tag-data\",attrs:{\"label\":_vm.$t('tag')},model:{value:(_vm.new_tag.tag),callback:function ($$v) {_vm.$set(_vm.new_tag, \"tag\", $$v)},expression:\"new_tag.tag\"}}),_c('v-btn',{staticClass:\"new-tag-data\",on:{\"click\":function($event){return _vm.auto_tags_create(_vm.new_tag)}}},[_c('v-icon',[_vm._v(\"mdi-plus\")])],1)],1),_c('v-row',_vm._l(([\n              _vm.$t('match-cond'),\n              _vm.$t('tag'),\n              _vm.$t('operations'),\n            ]),function(key,index){return _c('v-col',{key:index},[_vm._v(_vm._s(key))])}),1)]},proxy:true},{key:\"default\",fn:function(props){return _vm._l((props.items),function(item){return _c('v-row',{key:item._id,attrs:{\"cols\":\"12\"}},[_vm._l((['cond', 'tag']),function(key,index){return _c('v-col',{key:index},[_vm._v(\" \"+_vm._s(item[key])+\" \")])}),_c('v-col',[_c('v-btn',{attrs:{\"alt\":`Delete ${item._id}`},on:{\"click\":function($event){return _vm.auto_tags_delete([item._id])}}},[_c('v-icon',[_vm._v(\"mdi-delete\")])],1),_c('v-btn',{staticClass:\"ml-5\",on:{\"click\":function($event){return _vm.auto_tags_apply(item._id)}}},[_c('v-icon',[_vm._v(\"mdi-check\")])],1)],1)],2)})}},{key:\"footer\",fn:function(){return [_c('v-row',{staticClass:\"mt-2\",attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-btn',{staticClass:\"mr-1\",attrs:{\"small\":\"\",\"dark\":\"\",\"fab\":\"\",\"color\":\"blue darken-3\"},on:{\"click\":_vm.prev_page}},[_c('v-icon',[_vm._v(\"mdi-chevron-left\")])],1),_c('span',{staticClass:\"mr-4 ml-4 grey--text\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"pagination\", { page: _vm.page, total: _vm.pages_count }))+\" \")]),_c('v-btn',{staticClass:\"ml-1\",attrs:{\"small\":\"\",\"dark\":\"\",\"fab\":\"\",\"color\":\"blue darken-3\"},on:{\"click\":_vm.next_page}},[_c('v-icon',[_vm._v(\"mdi-chevron-right\")])],1)],1)]},proxy:true}])})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card flat>\n    <v-card-title> {{ $t(\"auto-tagging\") }} </v-card-title>\n    <v-card-text>\n      <v-data-iterator\n        :items=\"auto_tags\"\n        :items-per-page=\"20\"\n        :page.sync=\"page\"\n        :search=\"search\"\n        hide-default-footer\n      >\n        <template v-slot:header>\n          <v-toolbar flat>\n            <v-text-field\n              v-model=\"search\"\n              clearable\n              flat\n              hide-details\n              prepend-inner-icon=\"mdi-magnify\"\n              :label=\"$t('search')\"\n            ></v-text-field>\n          </v-toolbar>\n          <v-toolbar flat class=\"mb-5\">\n            <v-text-field\n              v-model=\"new_tag.cond\"\n              :label=\"$t('match-cond')\"\n            ></v-text-field>\n            <v-text-field\n              v-model=\"new_tag.tag\"\n              :label=\"$t('tag')\"\n              class=\"new-tag-data\"\n            ></v-text-field>\n\n            <v-btn @click=\"auto_tags_create(new_tag)\" class=\"new-tag-data\">\n              <v-icon>mdi-plus</v-icon>\n            </v-btn>\n          </v-toolbar>\n          <v-row>\n            <v-col\n              v-for=\"(key, index) in [\n                $t('match-cond'),\n                $t('tag'),\n                $t('operations'),\n              ]\"\n              :key=\"index\"\n              >{{ key }}</v-col\n            >\n          </v-row>\n        </template>\n\n        <template v-slot:default=\"props\">\n          <v-row v-for=\"item in props.items\" :key=\"item._id\" cols=\"12\">\n            <v-col v-for=\"(key, index) in ['cond', 'tag']\" :key=\"index\">\n              {{ item[key] }}\n            </v-col>\n            <v-col>\n              <v-btn\n                @click=\"auto_tags_delete([item._id])\"\n                :alt=\"`Delete ${item._id}`\"\n              >\n                <v-icon>mdi-delete</v-icon>\n              </v-btn>\n              <v-btn class=\"ml-5\" @click=\"auto_tags_apply(item._id)\"><v-icon>mdi-check</v-icon></v-btn>\n            </v-col>\n          </v-row>\n        </template>\n\n        <template v-slot:footer>\n          <v-row class=\"mt-2\" align=\"center\" justify=\"center\">\n            <v-btn\n              small\n              dark\n              fab\n              color=\"blue darken-3\"\n              class=\"mr-1\"\n              @click=\"prev_page\"\n            >\n              <v-icon>mdi-chevron-left</v-icon>\n            </v-btn>\n            <span class=\"mr-4 ml-4 grey--text\">\n              {{ $t(\"pagination\", { page, total: pages_count }) }}\n            </span>\n            <v-btn\n              small\n              dark\n              fab\n              color=\"blue darken-3\"\n              class=\"ml-1\"\n              @click=\"next_page\"\n            >\n              <v-icon>mdi-chevron-right</v-icon>\n            </v-btn>\n          </v-row>\n        </template>\n      </v-data-iterator>\n    </v-card-text>\n  </v-card>\n</template>\n\n<script>\nimport api from \"../api\";\n\nexport default {\n  name: \"AutoTags\",\n  data: () => ({\n    auto_tags: [],\n    page: 1,\n    search: \"\",\n    new_tag: {\n      tag: \"\",\n      cond: \"\",\n    },\n  }),\n  computed: {\n    pages_count() {\n      return Math.ceil(this.auto_tags.length / 20);\n    },\n  },\n  mounted() {\n    this.reload();\n  },\n  methods: {\n    auto_tags_create() {\n      if (this.new_tag.cond.startsWith('@@')) {\n        this.new_tag.cond = 'author=' + this.new_tag.cond.substr(1)\n      }\n      if (!this.new_tag.tag) {\n        var m = (this.new_tag.cond.match(/@([_\\w]+)/) || ['', ''])[1]\n        if (m) this.new_tag.tag = '*' + m\n      }\n      if (this.new_tag.tag == this.new_tag.cond || !this.new_tag.tag) return\n      api.put(\"plugins/autotags\", this.new_tag).then((data) => {\n        if (!data.__exception__) {\n          this.new_tag.tag = \"\";\n          this.new_tag.cond = \"\";\n          this.reload();\n        }\n      });\n    },\n    auto_tags_delete(ids) {\n      api\n        .call(\"plugins/autotags\", { ids, delete: true })\n        .then(\n          () =>\n            (this.auto_tags = this.auto_tags.filter(\n              (x) => !ids.includes(x._id)\n            ))\n        );\n    },\n    auto_tags_apply(id) {\n      api.call(\"plugins/autotags\", {apply: id})\n      .then(()=>(api.notify(this.$t('success'))))\n    },\n    reload() {\n      api\n        .call(\"plugins/autotags\")\n        .then((data) => (this.auto_tags = data.result));\n    },\n    next_page() {\n      if (this.page + 1 <= this.pages_count) this.page++;\n    },\n    prev_page() {\n      if (this.page - 1 >= 1) this.page--;\n    },\n    do_search(items, search) {\n      if (!search) return items;\n      return items.filter(\n        (x) =>\n          [x.cond, x.tag]\n            .join(\" \")\n            .toLowerCase()\n            .indexOf(search.toLowerCase()) >= 0\n      );\n    },\n  },\n};\n</script>\n\n<style scoped>\n.new-tag-data {\n  margin-left: 2vw;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutoTags.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutoTags.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AutoTags.vue?vue&type=template&id=665e2f9c&scoped=true&\"\nimport script from \"./AutoTags.vue?vue&type=script&lang=js&\"\nexport * from \"./AutoTags.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AutoTags.vue?vue&type=style&index=0&id=665e2f9c&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"665e2f9c\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('QueryFormulator',{model:{value:(_vm.test),callback:function ($$v) {_vm.test=$$v},expression:\"test\"}}),_c('pre',{domProps:{\"textContent\":_vm._s(_vm.test)}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[(_vm.context == 'expr')?_c('param-input',{attrs:{\"arg\":{\n      name: _vm.$t('brackets'),\n      type: '()|[]',\n    }},on:{\"change\":_vm.update},model:{value:(_vm.brackets),callback:function ($$v) {_vm.brackets=$$v},expression:\"brackets\"}}):_vm._e(),_c('v-select',{attrs:{\"items\":_vm.choices},on:{\"change\":_vm.update},model:{value:(_vm.selected),callback:function ($$v) {_vm.selected=$$v},expression:\"selected\"}}),[(_vm.next.startsWith('literal-'))?_c('param-input',{attrs:{\"arg\":{\n        name: '',\n        type: 'str',\n      }},on:{\"change\":_vm.update},model:{value:(_vm.embedded),callback:function ($$v) {_vm.embedded=$$v},expression:\"embedded\"}}):(_vm.next != 'null')?_c('query-formulator',{attrs:{\"context\":_vm.next},on:{\"change\":_vm.update},model:{value:(_vm.embedded),callback:function ($$v) {_vm.embedded=$$v},expression:\"embedded\"}}):_vm._e()],_c('v-select',{attrs:{\"items\":_vm.jointer_choices},on:{\"change\":_vm.update},model:{value:(_vm.jointer),callback:function ($$v) {_vm.jointer=$$v},expression:\"jointer\"}}),(_vm.jointer)?[_c('query-formulator',{attrs:{\"context\":\"expr\"},on:{\"change\":_vm.update},model:{value:(_vm.successor),callback:function ($$v) {_vm.successor=$$v},expression:\"successor\"}})]:_vm._e()],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <param-input\n      :arg=\"{\n        name: $t('brackets'),\n        type: '()|[]',\n      }\"\n      v-model=\"brackets\"\n      @change=\"update\"\n      v-if=\"context == 'expr'\"\n    ></param-input>\n    <v-select v-model=\"selected\" :items=\"choices\" @change=\"update\"></v-select>\n    <template>\n      <param-input\n        :arg=\"{\n          name: '',\n          type: 'str',\n        }\"\n        v-model=\"embedded\"\n        @change=\"update\"\n        v-if=\"next.startsWith('literal-')\"\n      />\n      <query-formulator\n        :context=\"next\"\n        v-model=\"embedded\"\n        @change=\"update\"\n        v-else-if=\"next != 'null'\"\n      />\n    </template>\n    <v-select\n      v-model=\"jointer\"\n      :items=\"jointer_choices\"\n      @change=\"update\"\n    ></v-select>\n    <template v-if=\"jointer\">\n      <query-formulator context=\"expr\" v-model=\"successor\" @change=\"update\" />\n    </template>\n  </div>\n</template>\n\n<script>\nconst FIELDS = [\n  \"keywords\",\n  \"content\",\n  \"author\",\n  \"dataset\",\n  \"source.url\",\n  \"source.file\",\n  \"lang\",\n];\n\nconst BINARY_OPERATORS = [\n  \"=\",\n  [\"%\", \"match-regex\"],\n  \">\",\n  \"<\",\n  \">=\",\n  \"<=\",\n  \"!=\",\n];\n\nconst JOINTERS = [\n  \"\",\n  [\",\", \"op-and\"],\n  [\"|\", \"op-or\"],\n  [\";\", \"op-list-sep\"],\n  [\"=>\", \"op-list-join\"],\n];\n\nconst LITERALS = [\"literal-any\", \"literal-text\"];\n\nconst UNIARY_OPERATORS = [[\"~\", \"op-not\"]];\n\nconst FUNCTIONS = [\"in\", \"first\", \"last\", \"groupby\", \"\"];\n\nimport ParamInput from \"./ParamInput.vue\";\n\nexport default {\n  name: \"QueryFormulator\",\n  components: {\n    ParamInput,\n  },\n  props: {\n    context: {\n      type: String,\n      default: \"expr\",\n    },\n    value: {\n      type: String,\n      default: \"\",\n    },\n  },\n  data() {\n    return {\n      function: \"match\",\n      selected: { literal: \"null\", type: \"null\" },\n      jointer: \"\",\n      embedded: \"\",\n      successor: \"\",\n      brackets: \"()\",\n    };\n  },\n  methods: {\n    _items_from_array(type_string, arr) {\n      return arr.map((x) => {\n        if (Array.isArray(x) && x.length == 2) {\n          return {\n            text: this.$t(x[1]),\n            value: {\n              type: type_string,\n              literal: x[0],\n            },\n          };\n        } else\n          return {\n            text: \"\" + x,\n            value: {\n              type: type_string,\n              literal: x,\n            },\n          };\n      });\n    },\n    _selected_string() {\n      switch (this.selected.type) {\n        case \"literals\":\n          if (this.selected.literal == \"literal-text\")\n            return \"`\" + this.embedded + \"`\";\n          else return this.embedded;\n        case \"binary-operators\":\n        case \"uniary-operators\":\n          return this.selected.literal + this.embedded;\n        default:\n          return this.selected.literal;\n      }\n    },\n    _stringify() {\n      return (\n        this._selected_string() +\n        (this.jointer ? this.jointer + this.successor : \"\")\n      );\n    },\n    update() {\n      switch (this.context) {\n        case \"expr\":\n          this.$emit(\n            \"input\",\n            this.brackets[0] + this._stringify() + this.brackets[1]\n          );\n          break;\n        default:\n          this.$emit(\"input\", this._stringify());\n          break;\n      }\n      this.$emit(\"change\");\n    },\n  },\n  computed: {\n    jointer_choices() {\n      return this._items_from_array(\"jointers\", JOINTERS);\n    },\n    choices() {\n      switch (this.context) {\n        case \"value-from\":\n          return this._items_from_array(\"fields\", FIELDS);\n        case \"binary-operators\":\n          return this._items_from_array(\"binary-operators\", BINARY_OPERATORS);\n        case \"expr\":\n          return [\n            ...this._items_from_array(\"null\", [\"null\"]),\n            ...this._items_from_array(\"uniary-operators\", UNIARY_OPERATORS),\n            ...this._items_from_array(\"functions\", FUNCTIONS),\n            ...this._items_from_array(\"fields\", FIELDS),\n            ...this._items_from_array(\"literals\", LITERALS),\n          ];\n        case \"call\":\n          switch (this.function) {\n            case \"match\":\n              return this._items_from_array(\"fields\", FIELDS);\n            case \"regexMatch\":\n              return this._items_from_array(\"parameters\", [\n                \"input\",\n                \"regex\",\n                \"options\",\n              ]);\n            case \"groupby\":\n              return this._items_from_array(\"parameters\", [[\"id\", \"group-by\"]]);\n          }\n      }\n      return [];\n    },\n    next() {\n      switch (this.selected.type) {\n        case \"fields\":\n          return \"binary-operators\";\n        case \"binary-operators\":\n        case \"uniary-operators\":\n          return \"expr\";\n        case \"null\":\n          return \"null\";\n        case \"literals\":\n          return this.selected.literal;\n        default:\n          return \"fields\";\n      }\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueryFormulator.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueryFormulator.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./QueryFormulator.vue?vue&type=template&id=2067029c&\"\nimport script from \"./QueryFormulator.vue?vue&type=script&lang=js&\"\nexport * from \"./QueryFormulator.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div>\n    <QueryFormulator v-model=\"test\" />\n    <pre v-text=\"test\"></pre>\n  </div>\n</template>\n\n<script>\nimport QueryFormulator from \"../components/QueryFormulator.vue\";\nexport default {\n  name: \"QueryFormTest\",\n  components: {\n    QueryFormulator,\n  },\n  data: () => ({ test: \"\" }),\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueryFormTest.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueryFormTest.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./QueryFormTest.vue?vue&type=template&id=a7687b92&\"\nimport script from \"./QueryFormTest.vue?vue&type=script&lang=js&\"\nexport * from \"./QueryFormTest.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from \"vue\";\nimport App from \"./App\";\nimport vuetify from \"./plugins/vuetify\";\n\n// patch for Blockly\n//Add unimported components to ignore list to prevent warnings.\nVue.config.ignoredElements = [\n    \"field\",\n    \"block\",\n    \"category\",\n    \"xml\",\n    \"mutation\",\n    \"value\",\n    \"sep\",\n];\n\n// use vue-router\nimport VueRouter from \"vue-router\";\nVue.use(VueRouter);\n\nVue.filter(\"dateSafe\", function(value) {\n    if (!value) return \"\";\n    if (\n        (typeof value === \"number\" && value < 10000) ||\n        (\"\" + value).match(/^\\d{4}(-\\d{1,2})?$/)\n    )\n        return value;\n    var ds = new Date(value).toLocaleString();\n    if (ds === \"Invalid Date\") return value;\n    return ds;\n});\n\n// use vue-treeselect\nimport Treeselect from \"@riophae/vue-treeselect\";\nVue.component(\"treeselect\", Treeselect);\nimport \"@riophae/vue-treeselect/dist/vue-treeselect.css\";\n\n// load components\nimport SearchForm from \"./views/SearchForm.vue\";\nimport TaskDetail from \"./views/TaskDetail.vue\";\nimport TaskShortcut from \"./views/TaskShortcut.vue\";\nimport TaskList from \"./views/TaskList.vue\";\nimport PageView from \"./views/PageView.vue\";\nimport DatasetList from \"./views/DatasetList.vue\";\nimport History from \"./views/History.vue\";\nimport Login from \"./views/Login.vue\";\nimport QueueResult from \"./views/QueueResult.vue\";\nimport StorageList from \"./views/StorageList.vue\";\nimport SystemAdmin from \"./views/SystemAdmin.vue\";\nimport Preferences from \"./views/Preferences.vue\";\nimport DbConsole from \"./views/DbConsole.vue\";\nimport AutoTags from \"./views/AutoTags.vue\";\nimport QueryFormTest from \"./views/QueryFormTest.vue\";\n\n// configure routes\nconst routes = [{\n        path: \"*\",\n        component: SearchForm,\n    },\n    {\n        path: \"/login\",\n        component: Login,\n        name: \"Login\",\n    },\n    {\n        path: \"/view/:path(.*)\",\n        component: PageView,\n        name: \"PageView\",\n    },\n    {\n        path: \"/tasks/shortcut/:id\",\n        component: TaskShortcut,\n        props: true,\n    },\n    {\n        path: \"/tasks/:id\",\n        component: TaskDetail,\n        props: true,\n    },\n    {\n        path: \"/tasks\",\n        component: TaskList,\n    },\n    {\n        path: \"/datasets\",\n        component: DatasetList,\n    },\n    {\n        path: \"/history\",\n        component: History,\n    },\n    {\n        path: \"/results/:id(.*)\",\n        component: QueueResult,\n        props: true,\n    },\n    {\n        path: \"/storage\",\n        component: StorageList,\n    },\n    {\n        path: \"/admin\",\n        component: SystemAdmin,\n    },\n    {\n        path: \"/preferences\",\n        component: Preferences,\n    },\n    {\n        path: \"/dbconsole\",\n        component: DbConsole,\n    },\n    {\n        path: \"/autotags\",\n        component: AutoTags,\n    },\n    {\n        path: \"/querytest\",\n        component: QueryFormTest,\n    },\n];\n\nconst router = new VueRouter({\n    routes,\n    mode: \"history\",\n    scrollBehavior() {\n        return {\n            x: 0,\n            y: 0,\n        };\n    },\n});\n\nrouter.beforeEach((to, from, next) => {\n    if (to.name !== \"Login\" && !localStorage.token)\n        next({\n            name: \"Login\",\n        });\n    else next();\n});\n\nimport i18n from \"./locales\";\n\nnew Vue({\n    vuetify,\n    router,\n    i18n,\n    render: (h) => h(App),\n}).$mount(\"#app\");","module.exports = __webpack_public_path__ + \"img/loading.aef9417c.png\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchForm.vue?vue&type=style&index=0&id=4e85c642&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutoTags.vue?vue&type=style&index=0&id=665e2f9c&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QueueResult.vue?vue&type=style&index=0&id=78f93b1c&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResultsView.vue?vue&type=style&index=1&id=7d00bbc8&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preferences.vue?vue&type=style&index=0&id=e2992790&prod&scoped=true&lang=css&\"","import Vue from \"vue\";\nimport VueI18n from \"vue-i18n\";\n\nVue.use(VueI18n);\n\nconst DEFAULT_LANG = \"chs\";\nconst LOCALE_KEY = \"localeLanguage\";\n\nconst locales = {\n    chs: require(\"./chs.json\"),\n    cht: require(\"./cht.json\"),\n    en: require(\"./en.json\"),\n    ja: require(\"./ja.json\"),\n};\n\nconst i18n = new VueI18n({\n    locale: DEFAULT_LANG,\n    messages: locales,\n    fallbackLocale: \"cn\",\n});\n\nexport const setup = (lang) => {\n    if (lang === undefined) {\n        lang = window.localStorage.getItem(LOCALE_KEY);\n        if (locales[lang] === undefined) {\n            lang = DEFAULT_LANG;\n        }\n    }\n    window.localStorage.setItem(LOCALE_KEY, lang);\n\n    Object.keys(locales).forEach((lang) => {\n        document.body.classList.remove(`lang-${lang}`);\n    });\n    document.body.classList.add(`lang-${lang}`);\n    document.body.setAttribute(\"lang\", lang);\n\n    Vue.config.lang = lang;\n    i18n.locale = lang;\n};\n\nsetup();\nwindow.i18n = i18n;\n\nexport default i18n;","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaggingDialog.vue?vue&type=style&index=0&id=003e8633&prod&scope=true&lang=css&\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&id=65c6d83c&prod&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DatasetList.vue?vue&type=style&index=0&id=3ab1b9ae&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StorageList.vue?vue&type=style&index=0&id=75d2b232&prod&scoped=true&lang=css&\"","import axios from \"axios\";\r\nimport Vue from \"vue\";\r\nimport Cookies from \"js-cookie\";\r\nimport i18n from \"./locales/\";\r\n\r\nconst _prompt_no_image = require(\"../public/assets/no-image.png\");\r\nconst _prompt_video = require(\"../public/assets/video.png\");\r\n\r\nconst apiBase = \"/api/\";\r\nconst _stack = [];\r\nvar _token = localStorage.token || \"\";\r\nCookies.set(\"token\", _token, { domain: '.' + location.hostname });\r\n\r\nfunction LocalConfig() {\r\n    // Local Config Object\r\n\r\n    let defaults = {\r\n        fit: \"both\",\r\n        drawer: true,\r\n        contain: false,\r\n        enhance: false,\r\n        force_thumbnail: false,\r\n        playing_interval: 1000,\r\n        view_mode: \"list\",\r\n        page_size: 50,\r\n        tagging: {\r\n            batch_delim: \", \",\r\n            batch_prefix: \"*\",\r\n        },\r\n        dbconsole: {\r\n            mongocollection: 'paragraph',\r\n            history: []\r\n        },\r\n        groups: \"none\",\r\n        sort: \"id\",\r\n        expert: false,\r\n        multiple_image_domains: true\r\n    };\r\n\r\n    function _save_config(target) {\r\n        localStorage[\"local_config\"] = JSON.stringify(target);\r\n    }\r\n\r\n    function _load_config() {\r\n        return JSON.parse(localStorage[\"local_config\"] || \"{}\");\r\n    }\r\n\r\n    let handler = {\r\n        get(target, name) {\r\n            var val = target[name] || \"\";\r\n            switch (typeof defaults[name]) {\r\n                case \"number\":\r\n                    return +val;\r\n                case \"boolean\":\r\n                    return val === true;\r\n            }\r\n            return val;\r\n        },\r\n        set(target, name, val) {\r\n            switch (typeof defaults[name]) {\r\n                case \"number\":\r\n                    val = +val;\r\n                    break;\r\n                case \"boolean\":\r\n                    val = \"\" + val == \"true\";\r\n                    break;\r\n            }\r\n            target[name] = val;\r\n            _save_config(target);\r\n            return true;\r\n        },\r\n    };\r\n\r\n    return new Proxy(Object.assign({save() {_save_config(this)}}, defaults, _load_config()), handler);\r\n}\r\n\r\nexport default {\r\n    stack: _stack,\r\n\r\n    locale: \"chs\",\r\n\r\n    bus: new Vue(),\r\n\r\n    user: \"\",\r\n\r\n    apiBase,\r\n\r\n    notify(notice) {\r\n        this.bus.$emit(\"alert\", notice);\r\n    },\r\n\r\n    querystring_parse(str) {\r\n        var params = {};\r\n        for (var pair of new URLSearchParams(str).entries()) {\r\n            if (pair[1].startsWith(\"JSON__\")) pair[1] = JSON.parse(pair[1].slice(6));\r\n            else if (pair[1].match(/^\\d+$/)) pair[1] = +pair[1];\r\n            else if (pair[1].match(/^(true|false)$/)) pair[1] = pair[1] == \"true\";\r\n            params[pair[0]] = pair[1];\r\n        }\r\n        return params;\r\n    },\r\n\r\n    querystring_stringify(obj) {\r\n        var str = \"\";\r\n        for (var k in obj) {\r\n            let o = obj[k];\r\n            str += `&${k}=`;\r\n            switch (typeof o) {\r\n                case \"object\":\r\n                    str += \"JSON__\" + encodeURIComponent(JSON.stringify(o));\r\n                    break;\r\n                case \"string\":\r\n                    str += encodeURIComponent(o);\r\n                    break;\r\n                default:\r\n                    str += o;\r\n                    break;\r\n            }\r\n        }\r\n        if (str === \"\") return \"\";\r\n        return \"?\" + str.substring(1);\r\n    },\r\n\r\n    blob_download(blob, filename) {\r\n        var url = URL.createObjectURL(blob);\r\n\r\n        const link = document.createElement(\"a\");\r\n        link.href = url;\r\n        link.download = filename;\r\n\r\n        // this is necessary as link.click() does not work on the latest firefox\r\n        link.dispatchEvent(\r\n            new MouseEvent(\"click\", {\r\n                bubbles: true,\r\n                cancelable: true,\r\n                view: window,\r\n            })\r\n        );\r\n\r\n        setTimeout(() => {\r\n            // For Firefox it is necessary to delay revoking the ObjectURL\r\n            window.URL.revokeObjectURL(url);\r\n            link.remove();\r\n        }, 100);\r\n    },\r\n\r\n    cancel_source() {\r\n        return axios.CancelToken.source();\r\n    },\r\n\r\n    _catch_and_then(promise) {\r\n        function DataError(message, stack) {\r\n            this.name = \"DataError\";\r\n            this.message = message;\r\n            this.stack = stack;\r\n        }\r\n        DataError.prototype = Object.create(Error.prototype);\r\n        DataError.prototype.constructor = DataError;\r\n\r\n        return promise\r\n            .then((resp) => {\r\n                if (_stack.length > 0) {\r\n                    _stack.pop();\r\n                    this.bus.$emit(\"loading\", _stack.length);\r\n                }\r\n                if (resp.data.__exception__) {\r\n                    throw new DataError(\r\n                        resp.data.__exception__,\r\n                        resp.data.__tracestack__.join(\"\\n\")\r\n                    );\r\n                } else {\r\n                    return resp.data;\r\n                }\r\n            })\r\n            .catch((ex) => {\r\n                console.log(ex)\r\n                if (_stack.length > 0) {\r\n                    _stack.pop();\r\n                    this.bus.$emit(\"loading\", _stack.length);\r\n                }\r\n                if (typeof ex.message === \"string\") {\r\n                    ex = ex.message;\r\n                    if (ex.match(\"code 502\")) ex = \"backend-disconnected\";\r\n                    else if (ex.match(\"Forbidden.\")) {\r\n                        localStorage.token = \"\";\r\n                        ex = \"forbidden\";\r\n                        if (!location.href.endsWith(\"/login\")) location.href = \"/login\";\r\n                    } else if (ex.match(\"Unmatched credentials\"))\r\n                        ex = \"unmatched-credentials\";\r\n                }\r\n\r\n                if (ex.toString() !== \"Cancel\") {\r\n                    this.notify(ex);\r\n                    throw ex;\r\n                }\r\n            });\r\n    },\r\n\r\n    _axios_config(other) {\r\n        if (!this.locale) this.locale = i18n.locale;\r\n        return Object.assign({\r\n            headers: {\r\n                \"X-Authentication-Token\": _token,\r\n                \"X-Preferred-Language\": this.locale,\r\n            },\r\n        },\r\n            other || {}\r\n        );\r\n    },\r\n\r\n    upload(file, data, progress_handler) {\r\n        return this._catch_and_then(\r\n            axios.put(\r\n                this.apiBase + \"storage/\" + file,\r\n                data,\r\n                this._axios_config({\r\n                    onUploadProgress: progress_handler\r\n                })\r\n            )\r\n        )\r\n    },\r\n\r\n    auth(username, password, otp, remember) {\r\n        if (typeof otp == \"string\") otp = otp.substr(0, 6);\r\n        return new Promise((resolve, reject) => {\r\n            this.call(\"authenticate\", {\r\n                username,\r\n                password,\r\n                otp,\r\n            }).then((data) => {\r\n                if (data) {\r\n                    localStorage.token = _token = data.result;\r\n                    Cookies.set(\r\n                        \"token\",\r\n                        _token,\r\n                        remember ?\r\n                            {\r\n                                expires: 30,\r\n                            } :\r\n                            undefined\r\n                    );\r\n                    resolve(data);\r\n                } else {\r\n                    reject(data);\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    log_out() {\r\n        return axios.delete(`${this.apiBase}authenticate`).then(() => {\r\n            location.reload();\r\n        });\r\n    },\r\n\r\n    escape_regex(x) {\r\n        return x.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\r\n    },\r\n\r\n    help_pipelines() {\r\n        if (!this._pipelines)\r\n            return this.call(\"help/pipelines\").then((data) => {\r\n                this._pipelines = data.result;\r\n                return data.result;\r\n            });\r\n        else\r\n            return new Promise((accept) => {\r\n                accept(this._pipelines);\r\n            });\r\n    },\r\n\r\n    help_langs() {\r\n        if (!this._langs)\r\n            return this.call(\"help/langs\").then((data) => {\r\n                this._langs = data.result;\r\n                return data.result;\r\n            });\r\n        else\r\n            return new Promise((accept) => {\r\n                accept(this._langs);\r\n            });\r\n    },\r\n\r\n    querify(obj) {\r\n        function _debracket(x) {\r\n            if (x.match(/^\\(.*\\)$/)) {\r\n                var stack = 0;\r\n                for (var c of x.substr(1, x.length - 2)) {\r\n                    switch (c) {\r\n                        case \"(\":\r\n                            ++stack;\r\n                            break;\r\n                        case \")\":\r\n                            if (stack) --stack;\r\n                            else return x;\r\n                            break;\r\n                        case \",\":\r\n                        case \"|\":\r\n                            return x;\r\n                    }\r\n                }\r\n                if (stack == 0) return x.substr(1, x.length - 2);\r\n            }\r\n            return x;\r\n        }\r\n\r\n        if (Array.isArray(obj)) {\r\n            if (obj.length == 0) return \"[]\";\r\n            else if (obj.length == 1) {\r\n                return \"[\" + _debracket(this.querify(obj[0])) + \"]\";\r\n            } else {\r\n                return (\r\n                    \"[\" + obj.map((x) => _debracket(this.querify(x))).join(\";\") + \"]\"\r\n                );\r\n            }\r\n        }\r\n\r\n        if (obj === null || obj === undefined) {\r\n            return \"null\";\r\n        }\r\n\r\n        if (typeof obj == \"object\") {\r\n            var s = \"\";\r\n            for (var kvpair of Object.entries(obj)) {\r\n                let key = kvpair[0],\r\n                    val = kvpair[1];\r\n                switch (key) {\r\n                    case \"$and\":\r\n                        s +=\r\n                            \",(\" +\r\n                            val.map((x) => _debracket(this.querify(x))).join(\",\") +\r\n                            \")\";\r\n                        break;\r\n                    case \"$or\":\r\n                        s +=\r\n                            \",(\" +\r\n                            val.map((x) => _debracket(this.querify(x))).join(\"|\") +\r\n                            \")\";\r\n                        break;\r\n                    case \"$options\":\r\n                        break;\r\n                    case \"$regex\":\r\n                        s += \"%\" + this.querify(val);\r\n                        break;\r\n                    default:\r\n                        if (key.startsWith(\"$\"))\r\n                            s +=\r\n                                \",\" + key.substr(1) + \"(\" + _debracket(this.querify(val)) + \")\";\r\n                        else {\r\n                            s += \",\" + key;\r\n                            val = this.querify(val);\r\n                            if (val.startsWith(\"(%\")) {\r\n                                s += val.substr(1, val.length - 2);\r\n                            } else {\r\n                                s += \"=\" + val;\r\n                            }\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n            return \"(\" + _debracket(s.replace(/^,/, \"\")) + \")\";\r\n        }\r\n\r\n        return JSON.stringify(obj);\r\n    },\r\n\r\n    logined() {\r\n        return new Promise((resolve, reject) => {\r\n            this.call(\"authenticate\")\r\n                .then((d) => {\r\n                    this.user = d.result.username;\r\n                    resolve(d);\r\n                })\r\n                .catch(reject);\r\n        });\r\n    },\r\n\r\n    call(name, params, cancel = null) {\r\n        _stack.push(name);\r\n        this.bus.$emit(\"loading\", _stack.length);\r\n        if (typeof params !== \"undefined\")\r\n            return this._catch_and_then(\r\n                axios.post(\r\n                    apiBase + name,\r\n                    params,\r\n                    this._axios_config(\r\n                        cancel ?\r\n                            {\r\n                                cancelToken: cancel.token,\r\n                            } :\r\n                            {}\r\n                    )\r\n                )\r\n            );\r\n        else\r\n            return this._catch_and_then(\r\n                axios.get(\r\n                    apiBase + name,\r\n                    this._axios_config(\r\n                        cancel ?\r\n                            {\r\n                                cancelToken: cancel.token,\r\n                            } :\r\n                            {}\r\n                    )\r\n                )\r\n            );\r\n    },\r\n\r\n    delete(name, params) {\r\n        _stack.push(name);\r\n        this.bus.$emit(\"loading\", _stack.length);\r\n        if (typeof params !== \"undefined\")\r\n            return this._catch_and_then(\r\n                axios.delete(apiBase + name, params, this._axios_config())\r\n            );\r\n        else\r\n            return this._catch_and_then(\r\n                axios.delete(apiBase + name, this._axios_config())\r\n            );\r\n    },\r\n\r\n    put(name, params) {\r\n        _stack.push(name);\r\n        this.bus.$emit(\"loading\", _stack.length);\r\n        return this._catch_and_then(\r\n            axios.put(apiBase + name, params, this._axios_config())\r\n        );\r\n    },\r\n\r\n    cut_words(str) {\r\n        return this.call(\"quicktask\", {\r\n            pipeline: [\r\n                [\r\n                    \"WordCut\",\r\n                    {\r\n                        lang: \"auto\",\r\n                        content: str,\r\n                    },\r\n                ],\r\n            ],\r\n        });\r\n    },\r\n\r\n    queue() {\r\n        return this.call(\"queue/\")\r\n            .then((data) => data.result)\r\n            .catch(() => { });\r\n    },\r\n\r\n    fav(r) {\r\n        const key = \"favored:\" + this.user;\r\n        var bundle = {\r\n            keywords: key,\r\n        };\r\n        if (this.favored(r)) {\r\n            r.keywords = r.keywords.filter((x) => x != key);\r\n            bundle = {\r\n                $pull: bundle,\r\n            };\r\n        } else {\r\n            r.keywords.push(key);\r\n            bundle = {\r\n                $push: bundle,\r\n            };\r\n        }\r\n        this.call(\r\n            `collections/${r.mongocollection || \"paragraph\"}/${r._id}`,\r\n            bundle\r\n        );\r\n    },\r\n\r\n    favored(r) {\r\n        return r.keywords.includes(\"favored:\" + this.user);\r\n    },\r\n\r\n    get_datasets() {\r\n        function _segs(x) {\r\n            var r = [],\r\n                s = \"\";\r\n            for (var seg of x.name.split(\"--\")) {\r\n                s += seg;\r\n                r.push(s);\r\n                s += \"--\";\r\n            }\r\n            return r;\r\n        }\r\n\r\n        return this.call(\"datasets\").then((data) => {\r\n            var weights = {},\r\n                colls = data.result.sort((x) => x.order_weight);\r\n            for (var c of colls) {\r\n                for (var s of _segs(c))\r\n                    if (!weights[s]) weights[s] = c.order_weight;\r\n            }\r\n\r\n            function _comp(x, y) {\r\n                var s1 = _segs(x),\r\n                    s2 = _segs(y);\r\n                for (var si = 0; si < s1.length && si < s2.length; ++si) {\r\n                    let xx = s1[si],\r\n                        yy = s2[si];\r\n                    if (weights[xx] !== weights[yy]) return weights[xx] - weights[yy];\r\n                }\r\n                return x.name.localeCompare(y.name);\r\n            }\r\n\r\n            return colls.sort(_comp);\r\n        });\r\n    },\r\n\r\n    get_datasets_hierarchy() {\r\n        var bundles = {};\r\n        return this.get_datasets().then((data) => {\r\n            var hierarchy = {\r\n                id: \"ROOT\",\r\n                name: \"\",\r\n                children: [],\r\n            };\r\n\r\n            data = data.map((x) => {\r\n                x.segments = (x.display_name || x.name).split(\"--\");\r\n                x.level = x.segments.length;\r\n                return x;\r\n            });\r\n\r\n            for (var x of data) {\r\n                var parent_obj = hierarchy;\r\n                for (\r\n                    var i = 0, segs = x.segments[0]; i < x.level; i++, segs += \"--\" + x.segments[i]\r\n                ) {\r\n                    var cand = parent_obj.children.filter((child) => child.id == segs)[0];\r\n                    if (typeof cand === \"undefined\") {\r\n                        cand = {\r\n                            id: segs,\r\n                            label: x.segments[i],\r\n                            children: [],\r\n                        };\r\n                        bundles[cand.id] = {\r\n                            name: segs,\r\n                            dataset_name: x.name,\r\n                            mongocollection: x.mongocollection,\r\n                        };\r\n                        parent_obj.children.push(cand);\r\n                    }\r\n                    parent_obj = cand;\r\n                }\r\n            }\r\n\r\n            return {\r\n                hierarchy: hierarchy.children,\r\n                bundles: bundles,\r\n            };\r\n        });\r\n    },\r\n\r\n    quote(s) {\r\n        s = s || \"\";\r\n        if (s.match(/[`'\"()\\s.&,+%:/]|(^\\d+(\\.\\d+)?$)/))\r\n            return \"`\" + s.replace(/`/g, \"\\\\`\") + \"`\";\r\n        if (s === \"\") s = \"''\";\r\n        return s;\r\n    },\r\n\r\n    _generate_domain(path, prefix) {\r\n        const host_name_regex = /^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/;\r\n\r\n        const simpleHash = str => {\r\n            let hash = 0;\r\n            for (let i = 0; i < str.length; i++) {\r\n                const char = str.charCodeAt(i);\r\n                hash = (hash << 5) - hash + char;\r\n                hash &= hash; // Convert to 32bit integer\r\n            }\r\n            return new Uint32Array([hash])[0].toString(36);\r\n            };\r\n\r\n        if (this.config.multiple_image_domains && location.hostname.match(host_name_regex))\r\n            return `//${prefix}-` + simpleHash(path) + '.' + location.host;\r\n        \r\n        return ''\r\n    },\r\n\r\n    get_image_url(src) {\r\n        var path = ''\r\n        if (src.file.indexOf('://') >= 0) {\r\n            let ext = (src.url || src.orig_path || '').split('.').pop()\r\n            let segs = src.file.split('://')\r\n            path = `/images/${segs[0]}/${segs[1].replace('$', src.block_id) || src.block_id}/image.${ext.length <= 4 ? ext : 'data'}`\r\n        }\r\n        else if (src.file.match(/\\.pdf$/) && typeof(src.page) !== 'undefined')\r\n            path = `/images/file/${src.file}__hash/pdf/${src.page}`\r\n        else if (src.file)\r\n            path = `/images/file/${src.file}`\r\n        else if (src.url)\r\n            path = src.url\r\n        else\r\n            path = `/images/object/${Buffer.from(JSON.stringify(src)).toString('base64')}`;\r\n        \r\n        return this._generate_domain(path, 'img') + path;\r\n    },\r\n\r\n    get_item_image(item, disable_args) {\r\n        let config = this.config;\r\n\r\n        if (!item || !item.source || (!item.source.url && !item.source.file))\r\n            return _prompt_no_image;\r\n\r\n        var args = \"\";\r\n        if (item && item.item_type == \"video\") {\r\n            if (item.thumbnail)\r\n                return this.get_image_url({file: item.thumbnail, url: '.jpg'});\r\n            return _prompt_video;\r\n        }\r\n        \r\n        if (!disable_args) {\r\n            if (config.force_thumbnail) args += \"__hash/thumbnail/1280\";\r\n            // if (config.enhance) args += \"&enhance=1\";\r\n        }\r\n\r\n        if (item.source.file) {\r\n            if (item.source.file.indexOf('://') >= 0) item.source.block_id = item._id;\r\n            return this.get_image_url(item.source) + args;\r\n        }\r\n        return item.source.url;\r\n    },\r\n\r\n    get_item_video(item) {\r\n        if (item.source.file) {\r\n            if (item.source.file.indexOf('://') >= 0) item.source.block_id = item._id;\r\n            return this.get_image_url(item.source);\r\n        }\r\n        return item.source.url;\r\n    },\r\n\r\n    get_paragraph_image(paragraph) {\r\n        if (paragraph.images && paragraph.images.length)\r\n            return this.get_item_image(paragraph.images[0]);\r\n        if (\r\n            paragraph.source &&\r\n            paragraph.source.file &&\r\n            paragraph.source.file.endsWith(\".pdf\")\r\n        )\r\n            return this.get_item_image(paragraph);\r\n\r\n        return _prompt_no_image;\r\n    },\r\n\r\n    scope(paragraph) {\r\n        if (paragraph.author)\r\n            return 'author=' + JSON.stringify(paragraph.author);\r\n        if (Array.isArray(paragraph.keywords)) {\r\n            var ats = paragraph.keywords.filter(x => x.startsWith('@'))\r\n            if (ats.length) return JSON.stringify(ats[0])\r\n            var groups = paragraph.keywords.filter(x => x.startsWith('*'))\r\n            if (groups.length) return JSON.stringify(groups[0])\r\n        }\r\n        return 'id=' + paragraph._id;\r\n    },\r\n\r\n    config: LocalConfig(),\r\n};","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoPlayer.vue?vue&type=style&index=0&id=24f80ead&prod&scoped=true&lang=css&\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV4AAACWBAMAAABkyf1EAAAAG1BMVEXMzMzFxcW+vr63t7exsbGqqqqjo6OcnJyWlpawiKwlAAADbklEQVR42u2YQU/bQBBGx0kgHF1AJcegijZHeqlyDFIFOVJOOaZqVXKMSkF7DCSOv59dzew6wSFpqzZdsPS9A6zsjfw8Hs/sWoQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEELIXwKk9n8PT06tOfQSfHsV872vmG9WMV+fwBXyvayUb4aHSvneY76UO3F37Se+F/knkbfux8ovk4v8SxjWr/OrWL6TAdqF3A6AeVryxeQIyNM6gKFZnrvg9k4P2ZyaK7Iqhm/LROzCIxRaj3z14LCDUEj6OuWzSuogszkdFGdj+DYsgfXCGt5HF/a+M+QOU5ePrJA0bIpmUNNGXYgkNkI7kq+4eZDrYJYeLi/sfZGlGsqe9LUTtnCT7o9wqoG+SQ+cs9vM3+8Pls/lf/t29fIqN1LVzuLCwfdS3aYiu3pikEsYuTwVOQL0HoYa+IdYvk2MTS5RK2mEBr3wTfUexiJ1/eOmlrpjqdm0uvr2reO4WSzfunruwQuJmPXSV9O5pU8gwUTLn/hRwz8GzQfnX8R5LF9xucnt+KXaICv5Tm3UDlM/9sKPdvUWNLaS+EzoIJpvBz2VCwrdecnXF480TPXtwZLIXssuQmaEOVF8dzFWuaDQyUu+94tOV/i+6ZtvGqIa0qgZp6CpRA0zVQoRaqHcL8q+tXNtZpNHk31JBvzTieErI6TmW17mrPO11ut9iznP4NtC7w/j2wVwd7bMh8e+vWi+O7jfmL9lX4evx6Fotxf5MI65npxYQc021oeSbwPfy/XM3rdJbF/po6X193JN/S35Bksz75XrWfIqom8Lg0WgVvpbyddnbWJN0bJgVLRxacWrv36ZKAlma9YPJV8/aFhn9isJ7ceWQP08YnzFYdP6bCW+bQvlRGSAYn1mC80aZjF9u9i0/l3J36HV4EmY7Px6MjveHyweSxTfJjbtL0q+dcxVDdM0TB6h2HPEKb+Fry1k1+/fVuovgIeRBtOGtiobFHukeL76ovsAZ/Ir3yPbQXfV9zWAqTVDC/ClPAMn7vY3q6xz3J1Kw+lD+OBuU98MD1207w//SGculaKbVUS09s1vnmYV8U2sHyeRqu4WsP37bqSvJFugj6v0wEX6CrUF/PezWWUqQ+Ki7dm2Q/0ad2dCCCGEEEIIIYQQQgghhBBCCCHkBfITuFeSbWJ0VM4AAAAASUVORK5CYII=\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamInput.vue?vue&type=style&index=0&id=fbcef6ac&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ContentView.vue?vue&type=style&index=0&id=588a05d0&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BlocklyComponent.vue?vue&type=style&index=0&id=350904c4&prod&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ResultsView.vue?vue&type=style&index=0&id=7d00bbc8&prod&lang=css&\""],"sourceRoot":""}