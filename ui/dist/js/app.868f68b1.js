(function(e){function t(t){for(var s,i,o=t[0],l=t[1],c=t[2],u=0,d=[];u<o.length;u++)i=o[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);p&&p(t);while(d.length)d.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],s=!0,i=1;i<a.length;i++){var o=a[i];0!==r[o]&&(s=!1)}s&&(n.splice(t--,1),e=l(l.s=a[0]))}return e}var s={},i={app:0},r={app:0},n=[];function o(e){return l.p+"js/"+({}[e]||e)+"."+{"chunk-0fa28732":"39462851"}[e]+".js"}function l(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(e){var t=[],a={"chunk-0fa28732":1};i[e]?t.push(i[e]):0!==i[e]&&a[e]&&t.push(i[e]=new Promise((function(t,a){for(var s="css/"+({}[e]||e)+"."+{"chunk-0fa28732":"551cd1a5"}[e]+".css",r=l.p+s,n=document.getElementsByTagName("link"),o=0;o<n.length;o++){var c=n[o],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===s||u===r))return t()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){c=d[o],u=c.getAttribute("data-href");if(u===s||u===r)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var s=t&&t.target&&t.target.src||r,n=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");n.code="CSS_CHUNK_LOAD_FAILED",n.request=s,delete i[e],p.parentNode.removeChild(p),a(n)},p.href=r;var h=document.getElementsByTagName("head")[0];h.appendChild(p)})).then((function(){i[e]=0})));var s=r[e];if(0!==s)if(s)t.push(s[2]);else{var n=new Promise((function(t,a){s=r[e]=[t,a]}));t.push(s[2]=n);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=o(e);var d=new Error;c=function(t){u.onerror=u.onload=null,clearTimeout(p);var a=r[e];if(0!==a){if(a){var s=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+s+": "+i+")",d.name="ChunkLoadError",d.type=s,d.request=i,a[1](d)}r[e]=void 0}};var p=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(t)},l.m=e,l.c=s,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)l.d(a,s,function(t){return e[t]}.bind(null,s));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var p=u;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0057":function(e,t,a){"use strict";var s=a("8336"),i=a("ce7e"),r=a("132d"),n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ml-10"},[t(s["a"],{staticClass:"mb-5 mt-5",on:{click:function(t){return e.append_stage()}}},[t(r["a"],[e._v("mdi-plus")])],1),t("draggable",{attrs:{handle:".drag-handle",list:e.value}},e._l(e.value,(function(a,n){return t("div",{key:n,staticClass:"stage-opers"},[t("StageDetail",{attrs:{stages:e.stages,map_id:e.map_id+"."+n},on:{validation:function(t){return e.update_valid(e.map_id+"."+n,t)},shortcut:e.update_shortcut},model:{value:e.value[n],callback:function(t){e.$set(e.value,n,t)},expression:"value[index]"}}),t("div",{staticClass:"opers"},[t(s["a"],{attrs:{icon:""},on:{click:function(t){return e.remove_stage(n)}}},[t(r["a"],[e._v("mdi-delete")])],1),t(s["a"],{directives:[{name:"show",rawName:"v-show",value:n>0,expression:"index > 0"}],attrs:{icon:""},on:{click:function(t){return e.move_stage(n,-1)}}},[t(r["a"],[e._v("mdi-arrow-up")])],1),t(s["a"],{directives:[{name:"show",rawName:"v-show",value:n<e.value.length-1,expression:"index < value.length - 1"}],attrs:{icon:""},on:{click:function(t){return e.move_stage(n,1)}}},[t(r["a"],[e._v("mdi-arrow-down")])],1),t(s["a"],{attrs:{icon:""},on:{click:function(t){return e.append_stage(n+1)}}},[t(r["a"],[e._v("mdi-plus")])],1)],1),t(i["a"],{staticClass:"mb-5"})],1)})),0)],1)},o=[],l=a("d722"),c=a("b76a"),u=a.n(c),d={name:"Pipeline",components:{StageDetail:()=>a.e("chunk-0fa28732").then(a.bind(null,"5b1e")),draggable:u.a},data(){return{stages:{},show_code:!1,valid:[],shortcut:{}}},props:["value","map_id"],methods:{update_valid(e,t){var a=this.valid.indexOf(e);a>=0&&this.valid.splice(a,1),t||this.valid.push(e),this.$emit("validation",0==this.valid.length)},update_shortcut(e,t){this.$emit("shortcut",e,t)},append_stage(e){"undefined"===typeof e?this.value.push(["Passthrough",{}]):this.value.splice(e,0,["Passthrough",{}])},remove_stage(e){this.value.splice(e,1)},move_stage(e,t){var a=this.value[e];this.value.splice(e,1),this.value.splice(e+t,0,a)}},mounted(){l["a"].help_pipelines().then(e=>{this.stages=e}),Array.isArray(this.value)||this.$emit("input",[])}},p=d,h=(a("3cdf"),a("2877")),_=Object(h["a"])(p,n,o,!1,null,"ccaf75ca",null);t["a"]=_.exports},"02b9":function(e,t,a){"use strict";a("58bd")},"030a":function(e,t,a){"use strict";a("8d8f")},"0423":function(e){e.exports=JSON.parse('{"add":"追加","author":"著者名","browse":"ブラウズ","cancel":"キャンセル","concurrent":"パラレル数","confirm-delete":"この項目を削除するかどうかを確認します。","copy":"コピー","created-at":"で作成されました。","created-by":"作成者","dataset":"データセット","default":"デフォルト","delete":"削除","deleted":"削除されました。","delimiter":"セパレーター","design-view":"デザインビュー","drop-in-files":"ここにファイルをドラッグしてください","edit-paragraph":"段落を編集する","edit":"編集","export-excel":"エクセルの書き出し","export-json":"JSONの書き出し","export-task":"新規タスクのエクスポート","file-storage":"ファイルストレージ","finished-tasks":"完了したタスク","finished":"完了","found-results":"%{total} 件見つかりました。","group":"グループ","grouping":"グループ","image-enhance":"画像補正","image-full-size":"画像全体を表示する","image-thumbnail":"サムネイル","installed":"正常にインストールされました。","playing-interval":"インターバル数（ミリ秒）","invalid-input":"入力値が無効です。","match-file-type":"ファイルは、以下のいずれかのタイプである必要があります。","match-type":"入力値は","metadata":"メタデータ","modified-at":"修正","modify":"修正","name":"名称","new-schedule":"新規スケジュールタスク","new-task":"新しい課題","new-user":"新規ユーザー","no-available":"結果は出ていません。","none":"なし","number-1-10":"入力値は1～10でお願いします。","ok":"確認事項","otp-prompt":"Authenticator を使用して上記の QR  コードを読み取るか、%{otp_secret} を入力してください。","otp-enable":"OTP ログインを有効にする","otp-disable":"OTP ログインを無効にする","page-size":"ページサイズ","pagenum":"ページ番号","parent-dir":"親リストに戻る","password":"パスワード","pdate-rev":"新しいものから古いものへ","pdate":"古いものから新しいものへ","permitted-datasets":"アクセス可能なデータセット","pipeline":"タスクフロー","play":"プレイバック","prefix":"プリフィクス","query":"クエリ","quick-task":"クイックタスク","random":"ランダム","required":"必須","reset-storage":"リセット","results":"結果","resume-next":"エラーを無視する","role-admin":"管理者","role-query":"お問い合わせ","role-task":"タスク管理","run-at":"ランズイン","run-background":"バックグラウンドで実行","run-now":"今すぐ実行","running-tasks":"実行作業","running":"実行中","save":"セーブ","saved":"救われた。","schedule":"スケジュールされたタスク","search":"検索","separate":"セパレート","shared":"シェア","shortcut-params":"クイックタスクパラメーター","size":"サイズ","sort":"並び替え","source":"ソース","tag-batch":"一括タグ付け","tag":"タグ","tagging":"タグ","task-enqueued":"タスク","task":"タスク","text":"テキスト","total":"合計","upload":"アップロード","user-added":"ユーザー","user-delete-confirm":"ユーザー","user-deleted":"ユーザ","user-modify":"ユーザーを変更する","user-role":"ユーザーの役割","username":"ユーザー名","users":"ユーザー","view":"表示","waiting-tasks":"保留中のタスク","waiting":"保留中","account":"アカウント","admin":"管理","all":"すべて","auto-tagging":"自動タグ付け","clear":"クリア","console":"コンソール","history":"沿革","log-out":"ログアウト","password-new":"新規パスワード","password-old":"旧パスワード","password-repeated":"新しいパスワードの繰り返し","password-dismatch":"新しいパスワードの入力が一貫していない。","permissions":"アクセス権","tasks":"タスク","user":"ユーザー","updated":"は正常に更新されました。","merge":"マージ","password-update":"パスワードの変更","datasets":"データセット","renamed":"リネームが成功しました。","refreshed":"リフレッシュしています。","match-cond":"條件","match-tag":"マッチングタグ","operations":"アクション","pagination":"第 %{page} / %{total} 页","pagenum-modes":"全ページを修正","raname-to":"名称を変更する","preview":"プレビュー","execute":"実行する","login":"ログイン","username-login":"ユーザー名","otp-login":"OTPログイン","remember-me":"リメンバー・ミー","date":"日付","outline":"概要","edit-pagenum":"編集ページ","modify-mode":"モディファイモード","task-result":"タスクの結果","task-file-result":"課題の結果は、ファイルとしてダウンロードできます。","_lang":"日本語","langs":"Auto:auto","preferences":"設定","send-task":"タスクに送る","send-to":"... へ","backend-disconnected":"サーバー接続エラー、後でもう一度やり直してください","forbidden":"アクセスできません。もう一度ログインしてください","unmatched-credentials":"ユーザー名またはパスワードが間違っています","system-admin":"システム設定","folio-mode":"フォリオ","brackets":"括弧を使う","expert-mode":"専門家用","success":"完了","latest-imported":"最新の輸入","new-folder":"新しいフォルダ","folder-name":"フォルダ名","display-name":"表示名","mongocollection":"データベースコレクション"}')},"0918":function(e,t,a){},"10e1":function(e,t,a){},"1a5f":function(e,t,a){},"1aa9":function(e,t,a){"use strict";a("64f6")},"1f8a":function(e,t,a){},"20fe":function(e){e.exports=JSON.parse('{"_lang":"繁體中文","add":"添加","author":"作者","browse":"瀏覽","cancel":"取消","concurrent":"並行數","confirm-delete":"確認要刪除該項目嗎？","copy":"複製","created-at":"創建於","created-by":"創建者","dataset":"數據集","default":"默認","delete":"刪除","deleted":"已刪除。","delimiter":"分隔符","design-view":"設計視圖","drop-in-files":"在此拖入文件","edit-paragraph":"編輯段落","edit":"編輯","export-excel":"導出 Excel","export-json":"導出 JSON","export-task":"導出新任務","file-storage":"文件存儲","finished-tasks":"已完成的任務","finished":"已完成","found-results":"已找到 %{total} 個結果。","group":"按組","grouping":"分組","image-enhance":"增強圖像","image-full-size":"顯示全圖","image-thumbnail":"縮略圖","installed":"已成功安裝。","playing-interval":"播放間隔毫秒數","invalid-input":"無效的輸入值。","langs":"自動:auto|簡體中文:chs|繁體中文:cht|英文:en|德文:de|法文:fr|俄文:ru|西班牙文:es|葡萄牙文:pt|日文:ja|韓文/朝鮮文:kr|越南文:vn","match-file-type":"文件應爲下列類型之一: %{type}","match-type":"輸入值應爲 %{type} 類型","metadata":"元數據","modified-at":"修改於","modify":"修改","name":"名稱","new-schedule":"新計劃任務","new-task":"新任務","new-user":"新用戶","no-available":"無可用結果。","none":"無","number-1-10":"輸入值應介於 1 - 10 之間。","ok":"確認","otp-prompt":"請使用 Authenticator 掃描上述二維碼，或輸入如下信息：%{otp_secret}。本信息僅顯示一次。","otp-enable":"啓用 OTP 登錄","otp-disable":"關閉 OTP 登錄","page-size":"每頁結果數","pagenum":"頁碼","parent-dir":"返回上級目錄","password":"密碼","pdate-rev":"從新到舊","pdate":"從舊到新","permitted-datasets":"允許訪問的數據集","pipeline":"任務流程","play":"播放","prefix":"前綴","query":"查詢","quick-task":"快速任務","random":"隨機","required":"必填","reset-storage":"重置","results":"結果","resume-next":"忽略錯誤","role-admin":"管理員","role-query":"查詢","role-task":"任務管理","run-at":"運行於","run-background":"隊列運行","run-now":"立即運行","running-tasks":"運行中的任務","running":"運行中","save":"保存","saved":"已保存。","schedule":"計劃任務","search":"搜索","split":"分離","shared":"共享","shortcut-params":"快速任務參數","size":"大小","sort":"排序","source":"來源","tag-batch":"批量標籤","tag":"標籤","tagging":"標籤","task-enqueued":"任務 %{task} 已加入到隊列中。","task":"任務","text":"文本","total":"總數","upload":"上傳","user-added":"成功添加用戶 %{user}。","user-delete-confirm":"確認要刪除用戶 %{user} 嗎？","user-deleted":"用戶 %{user} 已成功刪除.","user-modify":"修改用戶","user-role":"用戶角色","username":"用戶名","users":"用戶","view":"查看","waiting-tasks":"等待中的任務","waiting":"等待中","account":"賬戶","admin":"管理","all":"全部","auto-tagging":"自動標籤","clear":"清除","console":"控制檯","history":"歷史","log-out":"登出","password-new":"新密碼","password-old":"舊密碼","password-repeated":"重複新密碼","password-dismatch":"新密碼輸入不一致。","permissions":"權限","tasks":"任務","user":"用戶","updated":"已成功更新。","merge":"合併","password-update":"更改密碼","datasets":"數據集","renamed":"重命名成功。","refreshed":"已刷新。","match-cond":"匹配條件","operations":"操作","pagination":"第 %{page} / %{total} 頁","pagenum-modes":"修改全部頁面:all|只修改當前頁面:solo|只修改本頁之後的頁面:after","raname-to":"更名爲","preview":"預覽","execute":"執行","login":"登錄","username-login":"用戶名密碼登錄","otp-login":"OTP 登錄","remember-me":"記住我","date":"日期","outline":"大綱","edit-pagenum":"編輯頁碼","modify-mode":"修改模式","task-result":"任務結果","task-file-result":"任務結果爲文件，請下載。","preferences":"設置","send-task":"发送到任務","send-to":"发送到","backend-disconnected":"後臺連接錯誤，請稍後再試","forbidden":"沒有訪問權限，請重新登錄","unmatched-credentials":"登录信息有误，请检查","system-admin":"系統設置","folio-mode":"對開模式","brackets":"括號","expert-mode":"專家模式","success":"成功","latest-imported":"最近導入","new-folder":"新資料夾","folder-name":"資料夾名","display-name":"顯示名","mongocollection":"資料庫集合名"}')},"210b4":function(e,t,a){"use strict";a("1a5f")},"24cc":function(e,t,a){"use strict";a("0918")},"24d9":function(e,t,a){"use strict";a("d5a4")},2529:function(e,t,a){"use strict";a("49ea")},"364c":function(e,t,a){},"38d2":function(e,t,a){"use strict";a("cbe0")},"38fe":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV4AAACWBAMAAABkyf1EAAAAG1BMVEXMzMyWlpbFxcW+vr6xsbGcnJyjo6Oqqqq3t7cKhryjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADFUlEQVR4nO2YvW/TUBTF/ZXEY25bp4xJoWLFCFHGmIEZLxVjLFSpY9yKPVkq/mzuV2InQrDZr9L5Le/KjqrT6/vOve9FEQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMCIrOjSo4yKkzcxzYeX81+mdHWMrk/ehKm3y6pkuq8xTL0p0dKiPesLX29U086CljavQW9LWwtE+CvQu6fvuibHwnAC1RvTha75mZ2FqndKb3SdHY3NCVRvRgtdJ8fGEUXvHoon15u81Pdf/fHdQ/E8vMAzuG51XYk805gTs7Z4z2Gx01+8l8dPowk9UNMHWSrxCdNYibArjTMJrWKSWsJiOaZWoaW1LI34sGpMVSOVElcWL/kHtxZuRpSqlCZBRaneCdHzzWdqOOZi+bH8UqtFt7T4+LY535XDYzWQ6raLLaey8zizc5+BbsXyWPpWXOTMpYdnqvIyTZzqrbVApqJ3pc0klXcz85Hm0A5HI9ccmmrRm1rjSEVvZXuxWcgr9bvS2+F4JKovVh2iN/M5uOa4sZ63p2Pf7tv0SDRSkqV+Z9E784ZXcezSS/5FZTaSjb/hKnGyVsdK0XvIIM/DiYuL+WVjc2fu7XBENLW1djnTe+GP5+7E0u0ObSU5H4uGZ8KVmVjaYj1jmF5u0PmJ3qU8DUDvjAXmVrRx70x0oncb+ZhxXMcj5yqdWVL7+Y37ejcB6ZVamJhb9es3lvrtzCCceuCtzx9/LVGsPdj8YSV6uyuJcPabdLG9qen7byl+1plXOH4myW2sKq2/WRHIfYQnM/8dUr/git34h+/ND5HMk/5vSPbLYPoxV8Cl14DPZ1Ibic07O3ncUm/eGf8UyhntPMEues7myUVA82QknurHHNW70uI4mdcvA5rXI0mabSbTy5oeb16o1lqmn8tP9t9Udh66/tcfGgg+tKudeS+uu/Nma+1N3k4tHHtcF1aHJmB69SS80Hga3nk+EpPyr+x3Oo0UdHcXUVjyA7kv+Qvpr+LRw+Rbfb/z+K4O4D4KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMLlD3CGZGQvx4tTAAAAAElFTkSuQmCC"},"39b0":function(e,t,a){},"3b7a":function(e,t,a){},"3cdf":function(e,t,a){"use strict";a("39b0")},"42ce":function(e,t,a){"use strict";a("84e2")},"458e":function(e,t,a){"use strict";a("6fe0")},"49ea":function(e,t,a){},"545c":function(e,t,a){"use strict";var s=a("c6a6"),i=a("8336"),r=a("62ad"),n=a("2b5d"),o=a("132d"),l=a("0fd9"),c=a("b974"),u=a("9e88"),d=a("8654"),p=a("a844"),h=function(){var e=this,t=e._self._c;return t("div",[e.type_choices?t(s["a"],e._g(e._b({attrs:{label:e.arg.name,value:null===e.value||"undefined"===typeof e.value?e.arg.default:e.value,items:e.type_choices},on:{change:e.inputListeners.input}},"v-autocomplete",e.$attrs,!1),e.inputListeners)):"TASK"==e.arg.type||"PIPELINE"==e.arg.type?t(s["a"],e._g(e._b({attrs:{label:e.arg.name,value:e.value,items:e.choices,hint:(e.choices.filter(t=>t.value==e.value)[0]||{}).hint,"persistent-hint":"","item-value":"value","item-text":"text"},on:{change:e.inputListeners.input}},"v-autocomplete",e.$attrs,!1),e.inputListeners)):"DATASET"==e.arg.type?t(n["a"],e._g(e._b({attrs:{items:e.choices,label:e.arg.name,value:e.value,"item-value":"value","item-text":"text"},on:{change:e.inputListeners.input}},"v-combobox",e.$attrs,!1),e.inputListeners)):"object"==e.arg.type?t("div",[e._l(e.keys,(function(a,s){return t(l["a"],{key:a.name},[t(r["a"],[t(d["a"],{on:{input:e.update_object_value},model:{value:a.name,callback:function(t){e.$set(a,"name",t)},expression:"r.name"}})],1),t(r["a"],[t(c["a"],{attrs:{items:["str","int","float","bool"]},on:{input:e.update_object_value},model:{value:a.type,callback:function(t){e.$set(a,"type",t)},expression:"r.type"}})],1),t(r["a"],[t("ParamInput",{attrs:{arg:a},on:{input:e.update_object_value},model:{value:e.object_value[a.name],callback:function(t){e.$set(e.object_value,a.name,t)},expression:"object_value[r.name]"}})],1),t(r["a"],[t(i["a"],{attrs:{icon:""},on:{click:function(t){e.keys.splice(s,1),e.update_object_value()}}},[t(o["a"],[e._v("mdi-minus")])],1)],1)],1)})),t(l["a"],[t(i["a"],{attrs:{icon:""},on:{click:function(t){return e.keys.push({name:"",type:"str"})}}},[t(o["a"],[e._v("mdi-plus")])],1)],1)],2):"bool"==e.arg.type?t("div",[t(u["a"],e._g(e._b({ref:"checkbox",staticClass:"d-inline-block",attrs:{value:e.value}},"v-simple-checkbox",e.$attrs,!1),e.inputListeners)),t("label",{on:{click:()=>e.$refs.checkbox.click()}},[e._v(e._s(e.arg.name))])],1):"QUERY"==e.arg.type?t("div",[t("label",[e._v(e._s(e.arg.name))]),t("prism-editor",{staticClass:"my-editor match-braces",attrs:{highlight:e.highlighter,"line-numbers":""},on:{input:function(t){return e.$emit("input",e.code)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.$emit("submit"):null}},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1):"str"==e.arg.type||"string"==e.arg.type?t(p["a"],e._g(e._b({attrs:{value:e.value,hint:e.arg.default,required:!e.arg.default,rows:(e.value||"").includes("\n")?4:1,cols:"40",label:e.arg.name}},"v-textarea",e.$attrs,!1),e.inputListeners)):e.arg.type.startsWith("file")?t("div",{staticClass:"file-drop",on:{drop:function(t){return t.preventDefault(),e.drop_file.apply(null,arguments)},dragover:function(e){e.preventDefault()},click:function(t){return e.$refs.input_file.click()}}},[e._v(" "+e._s(e.file_prompt)+" "),t("input",{ref:"input_file",attrs:{type:"file",accept:e.arg.type.substr(5).split(",").map(e=>"."+e).join(", ")},on:{change:function(t){return e.drop_file({dataTransfer:{files:t.target.files}})}}})]):t(d["a"],e._g(e._b({attrs:{type:"text",value:e.value,placeholder:e.arg.default,required:!e.arg.default,label:e.arg.name}},"v-text-field",e.$attrs,!1),e.inputListeners)),e._v(" "+e._s(e.prompt)+" ")],1)},_=[],g=a("d722"),m=a("e57a"),f=(a("cabf"),a("8c7a"));a("cb55"),a("84bf");function v(e){return function(t){var a=e.validate(t);"undefined"!==typeof a?e.prompt="":a=null,a&&"undefined"!==typeof a.value&&(a=a.value),e.$emit("validation",""===e.prompt),e.$emit("input",a)}}var b={name:"ParamInput",inheritAttrs:!1,props:["value","arg"],events:["validation"],components:{PrismEditor:m["a"]},computed:{inputListeners:function(){const e=this;return Object.assign({},this.$listeners,{input:v(e)})},type_choices(){function e(e){return e.split("|").map(e=>e.includes(":")?e.split(":"):[e,e]).map(e=>({text:e[0],value:e[1]}))}switch(this.arg.type){case"LANG":return e(this.langs);default:if(this.arg.type.includes("|"))return e(this.arg.type);var t=(this.arg.description||"").match(/@choose\((.*?)\)/);return!!t&&e(t[1])}}},data(){return{prompt:"",code:"",choices:[],file_prompt:this.$t("drop-in-files"),langs:this.$t("langs"),object_value:{},keys:[]}},watch:{arg(){this.update_choices()}},methods:{validate(e){if(""===e)return"undefined"===typeof this.arg.default||null===this.arg.default?void(this.prompt=this.$t("required")):null;switch(this.arg.type){case"bool":return e;case"int":if(e.match(/^[+-]?\d+$/))return parseInt(e);break;case"float":case"number":if(e.match(/^[+-]?\d?\.?\d+[eE]?[+-]?\d*$/))return parseFloat(e);break;default:return e}this.prompt=this.$t("match-type",{type:this.arg.type})},highlighter(e){return Object(f["highlight"])(e,f["languages"].clike)},update_object_value(){if("object"===this.arg.type){var e={};for(var t of this.keys)e[t.name]=this.object_value[t.name];this.$emit("input",e)}},refresh(e){this.code=e,this.$emit("input",e)},update_choices(){switch(this.arg.type){case"TASK":case"DATASET":g["a"].call(this.arg.type.toLowerCase()+"s").then(e=>this.choices=e.result.map(e=>({text:e.name,value:"TASK"==this.arg.type?e._id:e.name})));break;case"PIPELINE":g["a"].help_langs.then(e=>this.choices=[].concat(...Object.values(e).map(e=>Object.keys(e).map(t=>({text:`${e[t].doc} ${t}`,value:t,hint:e[t].args.map(e=>`${e.name} (${e.type}${null!==e.default?" optional":""})`).join(", ")})))));break;case"LANG":g["a"].help_langs().then(e=>{for(var t of Object.entries(e)){let e=t[0],a=t[1];this.langs.indexOf(":"+e)>=0||(this.langs+=`|${a}:${e}`)}});break;case"object":this.keys=this.arg.keys||[]}},drop_file(e){let t=this.arg.type.substr(5).split(","),a=new RegExp("\\.("+t.join("|")+")$","i"),s=Array.from(e.dataTransfer.files).filter(e=>e.name.match(a));if(!s.length)return void g["a"].notify(this.$t("match-file-type",{type:t.join(", ")}));let i=s[0];var r=new FileReader;r.onload=e=>{this.$emit("input",e.target.result),this.file_prompt=i.name},r.onerror=e=>console.log("Error : "+e.type),r.readAsDataURL(i)}},mounted(){this.code=this.value,this.update_choices()}},y=b,k=(a("ee69"),a("2877")),w=Object(k["a"])(y,h,_,!1,null,"fbcef6ac",null);t["a"]=w.exports},"56d7":function(e,t,a){"use strict";a.r(t);var s=a("2b0e"),i=a("7496"),r=a("40dc"),n=a("5bc1"),o=a("8336"),l=a("b0af"),c=a("553a"),u=a("132d"),d=a("8860"),p=a("56b0"),h=a("da13"),_=a("5d23"),g=a("f6c4"),m=a("f774"),f=a("8e36"),v=a("b974"),b=a("2db4"),y=a("2fa4"),k=a("2a7f"),w=function(){var e=this,t=e._self._c;return t(i["a"],[e.viewer?e._e():t(m["a"],{attrs:{app:"","disable-resize-watcher":""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[t(d["a"],{attrs:{nav:""}},[t(h["a"],{attrs:{link:""},on:{click:function(t){return e.$router.push("/")}}},[t(_["c"],[e._v(e._s(e.$t("search")))])],1),t(p["a"],{scopedSlots:e._u([{key:"activator",fn:function(){return[t(_["c"],[e._v(e._s(e.$t("tasks")))])]},proxy:!0}],null,!1,224619653)},[t(h["a"],{attrs:{link:""},on:{click:function(t){return e.$router.push("/tasks")}}},[t(_["c"],[e._v(e._s(e.$t("all")))])],1),e._l(e.shortcuts||[{_id:"",name:e.$t("quick-task")}],(function(a){return t(h["a"],{key:a._id,attrs:{link:""},on:{click:function(t){return e.$router.push("/tasks/shortcut/"+a._id)}}},[t(_["c"],[e._v(e._s(a.name))])],1)}))],2),t(p["a"],{scopedSlots:e._u([{key:"activator",fn:function(){return[t(_["c"],[e._v(e._s(e.$t("user")))])]},proxy:!0}],null,!1,4269343434)},[e._l([["preferences","preferences"],["history","history"]],(function(a){return t(h["a"],{key:a[0],attrs:{link:""},on:{click:function(t){return e.$router.push("/"+a[1])}}},[t(_["c"],[e._v(e._s(e.$t(a[0])))])],1)})),t(h["a"],{attrs:{link:""},on:{click:function(t){e.log_out(),e.$router.push("/login")}}},[t(_["c"],[e._v(e._s(e.$t("log-out")))])],1)],2),t(p["a"],{scopedSlots:e._u([{key:"activator",fn:function(){return[t(_["c"],[e._v(e._s(e.$t("admin")))])]},proxy:!0}],null,!1,4012197972)},e._l([["file-storage","storage"],["dataset","datasets"],["console","dbconsole"],["system-admin","admin"],["auto-tagging","autotags"]],(function(a){return t(h["a"],{key:a[0],attrs:{link:""},on:{click:function(t){return e.$router.push("/"+a[1])}}},[t(_["c"],[e._v(e._s(e.$t(a[0])))])],1)})),1)],1)],1),e.viewer?e._e():t(r["a"],{attrs:{app:"",color:"primary",dark:""}},[t(n["a"],{on:{click:function(t){e.drawer=!e.drawer}}}),t(k["a"],[e._v(e._s(e.app_title))]),t(y["a"]),t("queue-view",{attrs:{data:e.queue}})],1),t(g["a"],[t(f["a"],{style:{opacity:e.loading?1:0,"z-index":5},attrs:{indeterminate:"",app:"",fixed:""}}),t("div",{attrs:{id:e.viewer?"viewer":"content-wrapper"}},[t("keep-alive",{attrs:{include:["SearchForm","ResultsView","DbConsole"]}},[t("router-view",{key:e.$route.fullPath,on:{logined:function(t){return e.$emit("logined")}}})],1)],1),t("div",{staticStyle:{height:"40px"}}),e.viewer?e._e():[t(l["a"],{directives:[{name:"show",rawName:"v-show",value:e.console_outputs.length>0,expression:"console_outputs.length > 0"}],ref:"console",attrs:{flat:""}},[t(o["a"],{staticClass:"ma-3",attrs:{small:"",left:"",bottom:"",text:""},on:{click:function(t){e.console_outputs=[]}}},[t(u["a"],[e._v("mdi-delete")]),e._v(e._s(e.$t("clear")))],1),t("div",{staticClass:"console"},e._l(e.console_outputs.slice(0,50),(function(a,s){return t("div",{key:s},[e._v(" "+e._s(a)+" ")])})),0)],1),t(c["a"],{attrs:{id:"footer"}},[t("div",{staticClass:"language mr-5"},[t(v["a"],{style:{width:"150px"},attrs:{dense:"",flat:"","single-line":"","prepend-icon":"mdi-web",items:Object.entries(e.$i18n.messages).map(e=>({value:e[0],text:e[1]._lang}))},model:{value:e.ui_language,callback:function(t){e.ui_language=t},expression:"ui_language"}})],1),t("div",{staticClass:"powered-by"},[e._v(" Powered by Jindai © 2018-"+e._s((new Date).getFullYear())+" zhuth & contributors ")]),t("div",{domProps:{innerHTML:e._s(e.copyright)}})])]],2),e._l(e.snackbars,(function(a,s){return t(b["a"],{key:"sb"+s,scopedSlots:e._u([{key:"action",fn:function(){return[t(o["a"],{attrs:{color:"primary",text:""},on:{click:function(t){return e.snackbars.splice(s,1)}}},[t(u["a"],[e._v("mdi-close")])],1)]},proxy:!0}],null,!0),model:{value:a.visible,callback:function(t){e.$set(a,"visible",t)},expression:"sb.visible"}},[e._v(" "+e._s(a.text)+" ")])}))],2)},x=[],$=a("d722"),q=a("4ca6"),C=a("99d9"),A=a("169a"),S=a("ce7e"),j=function(){var e=this,t=e._self._c;return t("div",[t("a",{staticStyle:{color:"white","text-decoration":"none"},attrs:{link:""},on:{click:function(t){e.show_detail=!0}}},[t(q["a"],{attrs:{value:e.data.finished.length>0,content:e.data.finished.length,color:"green"}},[e._v(" "+e._s(e.$t("finished"))+" ")]),t(q["a"],{staticClass:"ml-5 mr-5",attrs:{value:e.data.waiting.length>0,content:e.data.waiting.length}},[e._v(" "+e._s(e.$t("waiting"))+" ")]),t(q["a"],{attrs:{color:"orange",value:e.data.running.length>0,content:e.data.running.length}},[e._v(" "+e._s(e.$t("running"))+" ")])],1),t(A["a"],{attrs:{width:"80%"},model:{value:e.show_detail,callback:function(t){e.show_detail=t},expression:"show_detail"}},[t(l["a"],[t(C["c"],[e._v(e._s(e.$t("finished-tasks"))+" "),t(y["a"]),t(o["a"],{attrs:{icon:""},on:{click:e.clear_not_viewable}},[t(u["a"],[e._v("mdi-delete")])],1),t(o["a"],{attrs:{icon:""},on:{click:function(t){e.show_detail=!1}}},[t(u["a"],[e._v("mdi-close")])],1)],1),e.data.finished.length>0?t(C["b"],e._l(e.data.finished,(function(a){return t("div",{key:a.key},[t("h4",[e._v(e._s(a.name))]),t("span",[e._v(e._s(a.key))]),e._v(" "+e._s(e.$t("run-at"))+": "+e._s(a.queued_at)),t("br"),e.downloadable(a)?t(o["a"],{attrs:{href:e.download_link(a),target:"_blank"}},[t(u["a"],[e._v("mdi-download")])],1):e._e(),e.viewable(a)?t(o["a"],{staticClass:"ml-3",on:{click:function(t){return e.view_result(a)}}},[t(u["a"],[e._v("mdi-eye")])],1):e._e(),t(o["a"],{staticClass:"ml-3",on:{click:function(t){return e.delete_result(a)}}},[t(u["a"],[e._v("mdi-delete")])],1),t(S["a"],{staticClass:"mt-5"})],1)})),0):t(C["b"],[e._v(e._s(e.$t("no-available")))]),t(C["c"],[e._v(e._s(e.$t("running-tasks")))]),t(C["b"],e._l(e.data.running,(function(a){return t("div",{key:a.key,staticClass:"mb-5"},[t("span",[e._v(e._s(a.key))]),e._v(" "+e._s(e.$t("run-at"))+": "+e._s(a.queued_at)),t("br"),t(o["a"],{on:{click:function(t){return e.delete_result(a)}}},[t(u["a"],[e._v("mdi-stop")])],1)],1)})),0),t(C["c"],[e._v(e._s(e.$t("waiting-tasks")))]),t(C["b"],e._l(e.data.waiting,(function(a){return t("div",{key:a.key,staticClass:"mb-5"},[t("span",[e._v(e._s(a.key))]),e._v(" "+e._s(e.$t("run-at"))+": "+e._s(a.queued_at)),t("br"),t(o["a"],{on:{click:function(t){return e.delete_result(a)}}},[t(u["a"],[e._v("mdi-stop")])],1)],1)})),0)],1)],1)],1)},O=[],P={data(){return{show_detail:!1}},props:["data"],methods:{download_link(e){return"/api/queue/"+encodeURIComponent(e.key)},delete_result(e){var t=encodeURIComponent(e.key);$["a"].delete("queue/"+t).then(()=>{$["a"].notify({title:"成功删除"}),this.$emit("updated",{})})},clear_not_viewable(){for(var e of this.data.finished){var t=encodeURIComponent(e.key);$["a"].delete("queue/"+t).then(()=>{this.$emit("updated",{})})}},view_result(e){var t=encodeURIComponent(e.key);this.$router.push("/results/"+t).catch(()=>{}),this.show_detail=!1},downloadable(e){switch(e.result_type){case"list":case"dict":case"file":return!0;default:return!1}},viewable(e){switch(e.result_type){case"list":case"redirect":case"exception":return!0;default:return!1}}}},T=P,E=(a("1aa9"),a("2877")),I=Object(E["a"])(T,j,O,!1,null,"25525aa2",null),L=I.exports,N=a("bf0f"),R={name:"app",components:{QueueView:L},data(){return{drawer:!0,loading:!1,queue:{finished:[],waiting:0,running:[]},queue_source:null,logs:{},admin:!1,shortcuts:[],snackbars:[],console_outputs:[],app_title:"Jindai",app_dark:!1,copyright:"",ui_language:"",queue_timeout_flag:0}},watch:{app_dark(e){this.$vuetify.theme.dark=!!e},app_title(e){document.title=e},ui_language(e){Object(N["b"])(e),$["a"].locale=e},drawer(e){$["a"].config.drawer=e}},created(){this.ui_language=this.$i18n.locale,$["a"].bus.$on("loading",e=>this.loading=e>0).$on("alert",e=>{const t=e.title?`${e.title}\n${e.text||""}`.trim():e;this.snackbars=this.snackbars.filter(e=>e.visible).concat([{text:"undefined"!==typeof this.$i18n.messages.chs[t]?this.$t(t):t,visible:!0}]).slice(0,5)}).$on("finish",e=>{this.logs[e]&&delete this.logs[e]}),this.$on("logined",()=>{$["a"].logined().then(e=>this.admin=e.result.roles.indexOf("admin")>=0).then(()=>{$["a"].call("tasks/shortcuts").then(e=>this.shortcuts=e.result),this.viewer||this.queue_event()}).catch(()=>localStorage.token="")})},mounted(){$["a"].call("meta").then(e=>{Object.assign(this,e.result)}),this.$emit("logined"),window.onblur=()=>{this.queue_source.close(),this.queue_source=null},window.onfocus=()=>{this.queue_event()},this.drawer=$["a"].config.drawer},computed:{viewer(){return location.href.indexOf("/view/")>0}},methods:{nav_click(e){this.$router.push(e.target.getAttribute("to")).catch(()=>{})},log_out(){$["a"].log_out()},update_queue(e){e&&(this.queue={finished:e.filter(e=>"stopped"==e.status),running:e.filter(e=>"running"==e.status),waiting:e.filter(e=>"pending"==e.status)})},queue_event(){$["a"].queue().then(e=>this.update_queue(e)),this.queue_source||(this.queue_source=new EventSource("/api/queue/events"),this.queue_source.onmessage=e=>{console.log(e);var t=JSON.parse(e.data);t.log?(this.console_outputs.splice(0,0,t.log),this.console_outputs.length>100&&this.console_outputs.splice(50,this.console_outputs.length-50)):this.update_queue(t)})}},sse:{cleanup:!0}},D=R,U=(a("c53e"),Object(E["a"])(D,w,x,!1,null,null,null)),z=U.exports,V=a("f309");a("5363"),a("fe2e");s["default"].use(V["a"]);var W=new V["a"]({icons:{iconfont:"mdi"}}),M=a("8c4f"),F=a("ca17"),B=a.n(F),J=(a("542c"),a("62ad")),Q=a("2b5d"),K=a("0fd9"),H=a("8654"),X=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("search")))]),t(C["b"],{on:{drop:function(t){return t.preventDefault(),e.drop_json_file.apply(null,arguments)},dragover:function(e){e.preventDefault()}}},[t("form",{attrs:{autocapitalize:"off",autocorrect:"off",spellcheck:"false"}},[t(K["a"],[t(J["a"],[e.expert?t("ParamInput",{ref:"search_code",staticClass:"mb-5 d-inline-block cond-width",attrs:{arg:{name:e.$t("query"),type:"QUERY"}},on:{submit:e.search},model:{value:e.q,callback:function(t){e.q=t},expression:"q"}}):t(H["a"],{staticClass:"d-inline-block selector cond-width",attrs:{dense:"",label:e.$t("query")},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)}},model:{value:e.q,callback:function(t){e.q=t},expression:"q"}}),t(Q["a"],{staticClass:"d-inline-block ml-5 selector",style:{width:"100px"},attrs:{label:e.$t("sort"),dense:"",items:[{text:e.$t("default"),value:"id"},{text:e.$t("pdate"),value:"pdate"},{text:e.$t("pdate-rev"),value:"-pdate"},{text:e.$t("source"),value:"source"},{text:e.$t("latest-imported"),value:"-id"},{text:e.$t("random"),value:"random"}]},model:{value:e.sort,callback:function(t){e.sort=t},expression:"sort"}})],1)],1),t(K["a"],{staticStyle:{"margin-top":"-24px"}},[t(J["a"],[t("treeselect",{attrs:{multiple:!0,options:e.datasets,placeholder:e.$t("dataset")},model:{value:e.selected_datasets,callback:function(t){e.selected_datasets=t},expression:"selected_datasets"}})],1)],1),t(K["a"],{staticClass:"ml-0 mb-3"},[t(o["a"],{attrs:{color:"primary"},on:{click:e.search}},[e._v(e._s(e.$t("search")))]),t("span",{staticClass:"ml-5",staticStyle:{"line-height":"100%","vertical-align":"middle"}},[e._v(" "+e._s(e.$t("grouping"))+" "),t(Q["a"],{staticClass:"d-inline-block ml-1",staticStyle:{width:"80px"},attrs:{dense:"",flat:"",items:[{text:e.$t("none"),value:"none"},{text:e.$t("group"),value:"group"},{text:e.$t("source"),value:"source"},{text:e.$t("author"),value:"author"}]},model:{value:e.groups,callback:function(t){e.groups=t},expression:"groups"}})],1),t(y["a"]),t(o["a"],{staticClass:"exports",on:{click:e.export_query}},[t(u["a"],[e._v("mdi-clipboard-outline")]),e._v(" "+e._s(e.$t("export-task"))+" ")],1),t(o["a"],{staticClass:"exports",on:{click:function(t){return e.export_file("xlsx")}}},[t(u["a"],[e._v("mdi-file-excel")]),e._v(" "+e._s(e.$t("export-excel"))+" ")],1),t(o["a"],{staticClass:"exports",on:{click:function(t){return e.export_file("json")}}},[t(u["a"],[e._v("mdi-download")]),e._v(" "+e._s(e.$t("export-json"))+" ")],1)],1)],1),t("ResultsView",{ref:"results",staticClass:"mt-5",attrs:{page_size:e.page_size},on:{load:e.load_search}})],1)],1)},G=[],Y=(a("13d5"),a("c6a6")),Z=a("a609"),ee=a("ac7c"),te=a("adda"),ae=a("e449"),se=a("891e"),ie=a("8dd9"),re=function(){var e=this,t=e._self._c;return 0!==e.total?t(ie["a"],{ref:"results",class:e.config.view_mode},[t("div",{staticClass:"tools"},[t(Z["a"],{staticClass:"view-mode-toggler",attrs:{mandatory:"",dense:""},on:{change:e.update_view_mode},model:{value:e.config.view_mode,callback:function(t){e.$set(e.config,"view_mode",t)},expression:"config.view_mode"}},[t(o["a"],{attrs:{value:"list"}},[t(u["a"],[e._v("mdi-view-list")])],1),t(o["a"],{attrs:{value:"page"}},[t(u["a"],[e._v("mdi-text-long")])],1),t(o["a"],{attrs:{value:"gallery"}},[t(u["a"],[e._v("mdi-view-module")])],1)],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:null!==e.total,expression:"total !== null"}],staticClass:"count"},[e._v(" "+e._s(e.$t("found-results",{total:e.total}))+" ")]),t(S["a"],{staticClass:"mt-5 mb-5"}),e.columns.includes("content")?t("div",{ref:"all_items",staticClass:"wrapper-container"},[e._l(e.visible_data,(function(a,s){return[a.spacer?t("div",{key:"spacer"+s,staticClass:"spacer"}):t("div",{key:s,staticClass:"paragraph",attrs:{"data-id":a._id}},[t("div",{staticClass:"meta"},[t(ee["a"],{staticClass:"d-inline-block",attrs:{dense:"","hide-details":""},on:{change:function(t){return e.update_selection(a,null,s)}},model:{value:a.selected,callback:function(t){e.$set(a,"selected",t)},expression:"r.selected"}}),e._v(" "+e._s(e.$t("dataset"))+": "),t("a",{attrs:{href:"/"+e.querystring_stringify({q:e.current_q(),selected_datasets:[a.dataset],groups:"none"}),target:"_blank"}},[e._v(e._s(a.dataset))]),e._v(" "+e._s(e.$t("outline"))+": "+e._s(a.outline)+" "+e._s(e.$t("source"))+": "),t("a",{attrs:{href:"/"+e.querystring_stringify({q:`(${e.current_q()}),source.file=${e.quote(a.source.file)}`,selected_datasets:[a.dataset],groups:"none"}),target:"_blank"}},[e._v(e._s(a.source.file))]),t("a",{attrs:{href:a.source.url,target:"_blank"}},[e._v(e._s(a.source.url))]),e._v(" "+e._s(e.$t("pagenum"))+": "+e._s(a.pagenum)+" "+e._s(e.$t("date"))+": "+e._s(e._f("dateSafe")(a.pdate))+" "),t(S["a"],{staticClass:"mt-5"})],1),"gallery"==e.config.view_mode?t(te["a"],{class:{selected:a.selected},attrs:{contain:e.config.contain,height:240,src:e.get_paragraph_image(a)},on:{click:function(t){return e.update_selection(a,t,s)},dblclick:function(t){return e.view_page(s)}}}):e._e(),t("ContentView",{key:a._id,attrs:{view_mode:e.config.view_mode,paragraph:a,item_width:200,item_height:200}}),t("div",{staticClass:"mt-10 operations"},[t(o["a"],{on:{click:function(t){return e.view_page(s)}}},[t(u["a"],[e._v("mdi-eye")]),e._v(" "+e._s(e.$t("view"))+" ")],1),t(o["a"],{attrs:{href:`/view/${a.mongocollection}/${a.source.file?a.source.file+"/"+a.source.page:a._id}`,target:"_blank"}},[t(u["a"],[e._v("mdi-dock-window")]),e._v(" "+e._s(e.$t("browse"))+" ")],1),t(o["a"],{on:{click:function(t){e.dialogs.info.target=a,e.dialogs.info.visible=!0}}},[t(u["a"],[e._v("mdi-information")]),e._v(" "+e._s(e.$t("metadata"))+" ")],1),t(o["a"],{on:{click:function(t){e.dialogs.edit.target=a,e.dialogs.edit.visible=!0}}},[t(u["a"],[e._v("mdi-file-edit-outline")]),e._v(" "+e._s(e.$t("edit"))+" ")],1),t(ae["a"],{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:s}){return[t(o["a"],e._g(e._b({staticClass:"d-inline-block"},"v-btn",s,!1),a),[t(u["a"],[e._v("mdi-send")]),e._v(" "+e._s(e.$t("send-task"))+" ")],1)]}}],null,!0)},[t(d["a"],e._l(e.dialogs.send_task.quicktasks,(function(s,i){return t(h["a"],{key:i,staticClass:"pointer"},[t(_["c"],{on:{click:function(t){e.set_selection([a]),e.send_task(s.value)}}},[e._v(e._s(s.text))])],1)})),1)],1),t(S["a"],{staticClass:"mt-5 mb-5"})],1)],1)]}))],2):t(ie["a"],[t("table",[t("thead",[t("tr",e._l(e.columns,(function(a){return t("th",{key:a},[e._v(e._s(a))])})),0)]),t("tbody",e._l(e.visible_data,(function(a,s){return t("tr",{key:s},e._l(e.columns,(function(i){return t("td",{key:i+s},[Array.isArray(a[i])?t("div",[t(o["a"],{on:{click:function(t){return e.show_embedded(a,i)}}},[t(u["a"],[e._v("mdi-file")])],1)],1):t("div",[e._v(" "+e._s(a[i])+" ")])])})),0)})),0)])]),t(K["a"],{staticClass:"mt-5"},[t(se["a"],{attrs:{length:e.pages.length},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}}),t("div",[t("label",[e._v(" "+e._s(e.$t("pagenum")))]),t(H["a"],{staticClass:"d-inline-block ml-1",staticStyle:{"max-width":"40px"},attrs:{type:"number",dense:""},on:{change:function(t){e.page=parseInt(t)||e.page}}})],1),t("div",[t("label",[e._v(e._s(e.$t("page-size")))]),t(v["a"],{staticClass:"d-inline-block ml-1",staticStyle:{"max-width":"50px"},attrs:{items:[20,50,100,200],dense:""},model:{value:e.config.page_size,callback:function(t){e.$set(e.config,"page_size",t)},expression:"config.page_size"}})],1)],1),t("PageView",{ref:"page_view",staticClass:"page-view",attrs:{paragraphs:e.visible_data,view_mode:e.config.view_mode,start_index:e.dialogs.paragraph.start_index,plugin_pages:e.plugin_pages},on:{next:function(t){return e.turn_page(e.page+1)},prev:function(t){return e.turn_page(e.page-1)},browse:function(t){e.browsing=t},info:function(t){e.dialogs.info.visible=!0,e.dialogs.info.target=t},rating:e.rating},model:{value:e.dialogs.paragraph.visible,callback:function(t){e.$set(e.dialogs.paragraph,"visible",t)},expression:"dialogs.paragraph.visible"}}),t(A["a"],{model:{value:e.dialogs.info.visible,callback:function(t){e.$set(e.dialogs.info,"visible",t)},expression:"dialogs.info.visible"}},[t(l["a"],[t(C["c"],[t(o["a"],{staticStyle:{"margin-right":"12px"},attrs:{icon:""},on:{click:function(t){e.dialogs.info.visible=!1}}},[t(u["a"],[e._v("mdi-close")])],1),e._v(" "+e._s(e.$t("metadata")))],1),t(C["b"],e._l(e.dialogs.info.target,(function(a,s){return t(K["a"],{key:s},[t(J["a"],{attrs:{cols:"4"}},[e._v(e._s(s))]),t(J["a"],{attrs:{cols:"8"}},[e._v(e._s(a))])],1)})),1),t(C["a"],[t(o["a"],{on:{click:function(t){e.dialogs.info.visible=!1}}},[e._v(" "+e._s(e.$t("ok"))+" ")])],1)],1)],1),t(A["a"],{model:{value:e.dialogs.edit.visible,callback:function(t){e.$set(e.dialogs.edit,"visible",t)},expression:"dialogs.edit.visible"}},[t(l["a"],[t(C["c"],[e._v(e._s(e.$t("edit-paragraph"))+" "+e._s(e.dialogs.edit.target._id)+" "),t(y["a"]),t(o["a"],{attrs:{icon:""},on:{click:function(t){e.dialogs.edit.visible=!1}}},[t(u["a"],[e._v("mdi-close")])],1)],1),t(C["b"],[t(d["a"],[e._l(e.dialogs.edit.target,(function(a,s){return t(h["a"],{key:s},[t(_["a"],[["_id","matched_content"].includes(s)||"object"==typeof a?e._e():t("ParamInput",{attrs:{arg:{type:typeof a,name:s,default:"''"}},model:{value:e.dialogs.edit.target[s],callback:function(t){e.$set(e.dialogs.edit.target,s,t)},expression:"dialogs.edit.target[key]"}})],1)],1)})),t(h["a"],[t(_["a"],[t("ParamInput",{attrs:{arg:{type:"string",name:"新字段",default:""}},model:{value:e.dialogs.edit.new_field,callback:function(t){e.$set(e.dialogs.edit,"new_field",t)},expression:"dialogs.edit.new_field"}}),t(o["a"],{on:{click:function(t){e.dialogs.edit.target[e.dialogs.edit.new_field]="",e.$forceUpdate()}}},[t(u["a"],[e._v("mdi-plus")])],1)],1)],1)],2)],1),t(C["a"],[t(o["a"],{attrs:{color:"primary"},on:{click:function(t){return e.save()}}},[e._v(e._s(e.$t("save")))]),t(o["a"],{on:{click:function(t){e.dialogs.edit.visible=!1}}},[e._v(e._s(e.$t("cancel")))])],1)],1)],1),t(A["a"],{model:{value:e.dialogs.embedded.visible,callback:function(t){e.$set(e.dialogs.embedded,"visible",t)},expression:"dialogs.embedded.visible"}},[t(l["a"],[t(C["c"],[e._v(" "+e._s(e.$t("view"))+" "+e._s(e.querify(e.dialogs.embedded.target.source))+" "),t(y["a"]),t(o["a"],{attrs:{icon:""},on:{click:function(t){e.dialogs.embedded.visible=!1}}},[t(u["a"],[e._v("mdi-close")])],1)],1),t(C["b"],[t("ResultsView",{attrs:{total:(e.dialogs.embedded.target.arr||[]).length},on:{load:t=>t.callback({offset:0,result:e.dialogs.embedded.target.arr})}})],1)],1)],1),t(A["a"],{model:{value:e.dialogs.send_task.visible,callback:function(t){e.$set(e.dialogs.send_task,"visible",t)},expression:"dialogs.send_task.visible"}},[t(l["a"],[t(C["c"],[e._v(" "+e._s(e.$t("send-task"))+" "),t(y["a"]),t(o["a"],{attrs:{icon:""},on:{click:function(t){e.dialogs.send_task.visible=!1}}},[t(u["a"],[e._v("mdi-close")])],1)],1),t(C["b"],{staticClass:"mt-5"},[t(K["a"],[t(J["a"],[t(Y["a"],{attrs:{dense:"",label:e.$t("send-to"),items:e.dialogs.send_task.quicktasks},model:{value:e.dialogs.send_task.pipeline,callback:function(t){e.$set(e.dialogs.send_task,"pipeline",t)},expression:"dialogs.send_task.pipeline"}}),t(o["a"],{attrs:{color:"primary",dense:""},on:{click:function(t){return e.$refs.quicktask_results.start(1)}}},[t(u["a"],[e._v("mdi-fast-forward")]),e._v(" "+e._s(e.$t("run-now")))],1)],1)],1),t(ie["a"],[t("ResultsView",{ref:"quicktask_results",attrs:{total:e.dialogs.send_task.results_count},on:{load:e.quicktask}})],1)],1)],1)],1),t("tagging-shortcuts-dialog",{attrs:{choices:e.dialogs.tagging_shortcuts.list,initial:e.dialogs.tagging_shortcuts.initial,multiple:!1,match_initials:!0},on:{submit:function(t){return e.tag(t,!0)}},model:{value:e.dialogs.tagging_shortcuts.visible,callback:function(t){e.$set(e.dialogs.tagging_shortcuts,"visible",t)},expression:"dialogs.tagging_shortcuts.visible"}}),t("tagging-dialog",{ref:"tagging_dialog",attrs:{choices:e.dialogs.tagging.choices,scope:e.scope(e.selected_paragraphs())},on:{submit:function(t){return e.tag(t,!1)},author:e.set_author}}),t("QuickActionButtons",{attrs:{selection_count:e.selection_count,playing_interval:e.config.playing_interval},on:{"toggle-selection":e.toggle_selection,"clear-selection":e.clear_selection,delete:e.delete_items,rating:function(t){return e.rating(.5)},group:e.group,tag:e.show_tagging_dialog,merge:e.merge,split:e.split,task:e.send_task,play:e.playing,"reset-storage":e.reset_storage}})],1):t(ie["a"],{ref:"results"},[e._v("未找到匹配的结果。")])},ne=[],oe=a("545c"),le=a("c3f0"),ce=function(){var e=this,t=e._self._c;return t(A["a"],{staticClass:"white-bg",attrs:{value:e.value,fullscreen:"file"==e.view_mode||"gallery"==e.view_mode,persistent:""}},[t(l["a"],{directives:[{def:le["a"],name:"touch",rawName:"v-touch",value:{left:()=>e._event_handler("left"),right:()=>e._event_handler("right"),down:()=>e.$emit("input",!1),up:()=>e.$emit("rating",{item:e.active_item,inc:1})},expression:"{\n      left: () => _event_handler('left'),\n      right: () => _event_handler('right'),\n      down: () => $emit('input', false),\n      up: () => $emit('rating', { item: active_item, inc: 1 }),\n    }"}],style:"gallery"==e.view_mode?{overflow:"hidden",height:"100%"}:{},attrs:{flat:""},on:{wheel:e._wheel_handler}},[t(C["b"],["file"==e.view_mode?t(K["a"],{staticClass:"pt-3"},[t(J["a"],{staticClass:"heading"},[t("h3",[e._v(e._s(e.file)+"  ")])]),t(y["a"]),t(o["a"],{attrs:{icon:"",enabled:e.page>0},on:{click:function(t){return e._event_handler("right")}}},[t(u["a"],[e._v("mdi-chevron-left")])],1),t(H["a"],{staticStyle:{"max-width":"50px"},attrs:{dense:"",flat:"",type:"number",value:e.page},on:{input:e.try_page}}),t(o["a"],{attrs:{icon:""},on:{click:function(t){return e._event_handler("left")}}},[t(u["a"],[e._v("mdi-chevron-right")])],1)],1):t(o["a"],{staticClass:"close",attrs:{icon:""},on:{click:function(t){return e.$emit("input",!1)}}},[t(u["a"],[e._v("mdi-close")])],1),e.active_paragraph&&e.active_paragraph.source?["gallery"!==e.view_mode?t(K["a"],{staticClass:"main"},[t("div",{staticClass:"paragraphs"},[e._l(e.shown_paragraphs,(function(a){return t("div",{key:a._id},[t("ContentView",{attrs:{paragraph:a,item_width:"100%",view_mode:e.view_mode}})],1)})),e.active_paragraph?t("div",{staticClass:"mt-5 meta"},[e._v(" "+e._s(e.$t("date"))+": "+e._s(e._f("dateSafe")(e.active_paragraph.pdate))),t("br"),e._v(" "+e._s(e.$t("pagenum"))+": "+e._s(e.active_paragraph.pagenum)+" "),t(o["a"],{attrs:{icon:"",small:""},on:{click:function(t){e.pagenum_editor.new_pagenum=e.active_paragraph.pagenum,e.pagenum_edit=!0}}},[t(u["a"],{attrs:{small:""}},[e._v("mdi-form-textbox")])],1),t("br"),e._v(" "+e._s(e.$t("outline"))+": "+e._s(e.active_paragraph.outline)),t("br"),e._v(" "+e._s(e.$t("source"))+": "),e.active_paragraph.source.url?t("a",{attrs:{href:e.active_paragraph.source.url,target:"_blank"}},[e._v(e._s(e.active_paragraph.source.url))]):e._e(),e._v(" "+e._s(e.active_paragraph.source.file)+" "+e._s(e.active_paragraph.source.page)),t("br")],1):e._e()],2),t("div",{staticClass:"image",on:{click:function(t){e.show_modal=!!e.pdf_image}}},[t("img",{attrs:{src:e.pdf_image,alt:""},on:{load:function(t){t.target.style.height=e.window_height-t.target.offsetTop-20+"px"}}})])]):t("div",[e.value?t("ImageBrowsing",{attrs:{paragraph:e.active_paragraph,item:e.active_item,plugin_pages:e.plugin_pages},on:{info:function(t){return e.$emit("info",t)},browse:e._event_handler}}):e._e()],1),t(A["a"],{attrs:{fullscreen:""},model:{value:e.show_modal,callback:function(t){e.show_modal=t},expression:"show_modal"}},[t(o["a"],{staticClass:"ma-10",attrs:{fab:"",fixed:"",icon:"",top:"",right:""},on:{click:function(t){e.show_modal=!1}}},[t(u["a"],[e._v("mdi-close")])],1),t("img",{ref:"image",staticStyle:{width:"100%"},attrs:{src:e.pdf_image,alt:""}})],1),t(A["a"],{attrs:{width:"unset"},model:{value:e.pagenum_edit,callback:function(t){e.pagenum_edit=t},expression:"pagenum_edit"}},[t(l["a"],[t(C["c"],[e._v(e._s(e.$t("edit-pagenum"))+" "),t(y["a"]),t(o["a"],{attrs:{icon:""},on:{click:function(t){e.pagenum_edit=!1}}},[t(u["a"],[e._v("mdi-close")])],1)],1),t(C["b"],[t(ie["a"],[t("ParamInput",{attrs:{arg:{name:e.$t("pagenum"),type:"int"}},model:{value:e.pagenum_editor.new_pagenum,callback:function(t){e.$set(e.pagenum_editor,"new_pagenum",t)},expression:"pagenum_editor.new_pagenum"}}),t("ParamInput",{attrs:{arg:{name:e.$t("modify-mode"),type:e.$t("pagenum-modes")}},model:{value:e.pagenum_editor.sequential,callback:function(t){e.$set(e.pagenum_editor,"sequential",t)},expression:"pagenum_editor.sequential"}}),t("ParamInput",{attrs:{arg:{name:e.$t("folio-mode"),type:"bool"}},model:{value:e.pagenum_editor.folio,callback:function(t){e.$set(e.pagenum_editor,"folio",t)},expression:"pagenum_editor.folio"}})],1)],1),t(C["a"],[t(o["a"],{attrs:{color:"primary"},on:{click:e.save_pagenum}},[e._v(e._s(e.$t("ok")))])],1)],1)],1)]:e._e()],2)],1)],1)},ue=[],de=function(){var e=this,t=e._self._c;return["file","list","page"].includes(e.view_mode)?t("div",{staticClass:"paragraph mt-5"},[e.is_html?t("p",{domProps:{innerHTML:e._s(e.content)}}):t("p",[e._v(" "+e._s(e.content)+" "),t(o["a"],{staticClass:"fav-button",attrs:{color:e.favored?"orange":"",dark:e.favored,icon:"",small:""},on:{click:function(t){e.fav(),e.$forceUpdate()}}},[t(u["a"],{attrs:{small:""}},[e._v("mdi-star")])],1)],1),e.paragraph.images&&e.paragraph.images.length?t("div",[t(K["a"],{attrs:{float:""}},e._l(e.first_item_only?e.paragraph.images.slice(0,1):e.paragraph.images,(function(a){return t(l["a"],{key:a._id,staticClass:"ma-5",staticStyle:{overflow:"hidden"},attrs:{width:e.item_width}},[t(te["a"],{attrs:{contain:e.contain,height:e.item_height,src:e.get_item_image(a)}})],1)})),1)],1):e._e()]):t("div",{staticClass:"gallery-item"},[t("div",{staticClass:"gallery-description"},[t("span",{staticClass:"nums"},[t("span",{staticClass:"datetime"},[e._v(e._s(e._f("dateSafe")(e.paragraph.pdate)))]),t("span",{staticClass:"count"},[t("a",{staticClass:"counter secondary--text chip",attrs:{target:"_blank",href:(e.paragraph.group_url||`/?q=id%3DObjectId(${e.paragraph._id})`)+"=>expand()&groups=none"}},[e._v(e._s(e.paragraph.count||e.paragraph.images.length))])]),t(o["a"],{staticClass:"orig no-underline",attrs:{href:e.paragraph.source.url,target:"_blank",icon:""}},[t(u["a"],[e._v("mdi-web")])],1)],1),t("a",{staticClass:"force-text break-anywhere",attrs:{href:"/?q=source.url%3D`"+(e.paragraph.source.url||"")+"`",target:"_blank"}},[e._v(e._s(e.paragraph.source.url))]),t("p",{staticClass:"content"},[e._v(e._s(e.text))]),e._l(e.tags,(function(a){return["..."!=a?t("a",{key:`${e.paragraph._id}-${Math.random()}-${a}`,class:["tag","chip",e.tag_class(a)],attrs:{alt:a,href:"/"+e.querystring_stringify({groups:a.match(/^\*/)?"none":a.match(/^@/)?"group":"",q:a.match(/^[@*]/)?e.quote(a):e.quote(a)+","+e.scope(e.paragraph)}),target:"_blank"}},[e._v(e._s(a))]):t(o["a"],{key:a,attrs:{icon:""},on:{click:function(t){e.show_all_tags=!0}}},[t(u["a"],[e._v("mdi-more")])],1)]}))],2)])},pe=[],he={name:"ContentView",props:["paragraph","first_item_only","item_width","item_height","view_mode","contain"],data:()=>({show_all_tags:!1}),computed:{is_html(){return this.content.match(/<.*>/)},content(){return this.paragraph.matched_content||this.paragraph.content},favored(){return $["a"].favored(this.paragraph)},tags(){var e=[...this.paragraph.keywords].filter(e=>e).sort();return!this.show_all_tags&&e.length>20&&(e=[...e.slice(0,20),"..."]),e},text(){return this.paragraph.content||""}},methods:{_open_window(e){window.open(e)},get_item_image(e){return $["a"].get_item_image(e)},fav(){$["a"].fav(this.paragraph)},quote(e){return JSON.stringify(""+e)},tag_class(e){return e.startsWith("*")?"t_group":e==this.paragraph.author?"t_author":"author"!=e&&"group"!=e?"t_"+e:""},querystring_stringify:$["a"].querystring_stringify,scope:$["a"].scope}},_e=he,ge=(a("f947"),Object(E["a"])(_e,de,pe,!1,null,"588a05d0",null)),me=ge.exports,fe=a("1d4d"),ve=function(){var e=this,t=e._self._c;return e.item?t("div",{staticClass:"browser"},[e.browsing_video?t("video-player",{ref:"videoPlayer",staticClass:"video-player",attrs:{src:e.get_item_video(e.item),options:{muted:!1,autoplay:!0,style:{width:"100%",height:"100vh"}}}}):t("div",{staticStyle:{width:"100%","text-align":"center"},on:{click:e.toggle_fits}},[t("div",{style:{height:"100vh",width:"100%",overflow:"hidden"}},[e.item?t("img",{ref:"browsing_image",attrs:{src:e.get_item_image(e.item),alt:"Browsing Image"},on:{load:e.fit_image}}):e._e()])]),t("div",{staticClass:"browsing description"},[t(K["a"],{attrs:{align:"end"}},[t(J["a"],{attrs:{cols:"2"}},[t(se["a"],{attrs:{length:3,"total-visible":0},on:{previous:e.browse_prev,next:e.browse_next},model:{value:e.browsing_page,callback:function(t){e.browsing_page=t},expression:"browsing_page"}})],1),e.item?t(J["a"],{staticClass:"item-description",attrs:{cols:"10"}},[t(K["a"],{staticClass:"mt-3 mb-3"},["number"==typeof e.item.rating?t("div",{staticClass:"mr-3"},[t(fe["a"],{staticStyle:{display:"inline-block"},attrs:{"background-color":"white",color:"yellow accent-4","half-increments":"",hover:"",size:"18"},on:{input:function(t){return e.$emit("rating",{item:e.item,val:t})}},model:{value:e.item.rating,callback:function(t){e.$set(e.item,"rating",t)},expression:"item.rating"}}),t("span",{staticClass:"grey--text text--lighten-2"},[e._v("("+e._s(e.item.rating.toFixed(1))+") ")])],1):e._e(),t("div",[e._l(e.plugin_pages,(function(a,s){return t(o["a"],{key:s,staticClass:"t_func sim",attrs:{icon:"",dense:"",href:"/"+e.querystring_stringify({q:e.scope(e.paragraph)+`;plugin('${e.format(a.format,{mediaitem:e.item,paragraph:e.paragraph})}')`}),target:"_blank"}},[t(u["a"],[e._v(e._s(a.icon))])],1)})),t(o["a"],{attrs:{icon:"",dense:"",target:"_blank","data-keybind":"i"},on:{click:function(t){return e.$emit("info",e.item)}}},[t(u["a"],[e._v("mdi-information")])],1)],2)]),t("ContentView",{staticClass:"browsing-content",attrs:{paragraph:e.paragraph,view_mode:"gallery-description"}})],1):e._e()],1)],1)],1):e._e()},be=[],ye=a("ba0d"),ke=function(){var e=this,t=e._self._c;return t("div",{staticClass:"video"},[t("video",{key:e.src,ref:"videoPlayer",staticClass:"video__player",style:e.options.style||{},attrs:{preload:"auto",controls:e.options.controls,autoplay:e.options.autoplay,"webkit-playsinline":"true",playsinline:"true","x-webkit-airplay":"allow","x5-video-player-type":"h5-page","x5-video-orientation":"portraint"},domProps:{muted:e.options.muted},on:{play:e.handleVideoPlay,playing:e.handleVideoPlaying,pause:function(t){e.playing=!1},dblclick:e.requestFullscreen,mousedown:e.handleMouse}},[t("source",{attrs:{src:e.src}})]),e.options.controls?e._e():t("div",{staticClass:"controls"},[t(o["a"],{attrs:{icon:""},on:{click:e.toggle_play}},[t(u["a"],{directives:[{name:"show",rawName:"v-show",value:!e.playing,expression:"!playing"}]},[e._v("mdi-play")]),t(u["a"],{directives:[{name:"show",rawName:"v-show",value:e.playing,expression:"playing"}]},[e._v("mdi-pause")])],1),t("select",{staticClass:"rates",domProps:{value:e.vp.playbackRate},on:{change:function(t){e.playbackRate=e.vp.playbackRate=+t.target.value}}},[t("option",{domProps:{value:.5}},[e._v("0.5x")]),t("option",{domProps:{value:1}},[e._v("1.0x")]),t("option",{domProps:{value:2}},[e._v("2.0x")]),t("option",{domProps:{value:4}},[e._v("4.0x")]),t("option",{domProps:{value:8}},[e._v("8.0x")])]),t("span",{ref:"duration"}),t(ye["a"],{ref:"slider",staticClass:"d-inline-block",attrs:{max:e.vp.duration,min:0,value:e.currentTime,"hide-details":"",dark:"",dense:"",color:"white"},on:{change:function(t){e.vp.currentTime=t}}}),t(o["a"],{attrs:{icon:""},on:{click:e.fullscreen}},[t(u["a"],[e._v("mdi-fullscreen")])],1)],1)])},we=[],xe={name:"VideoPlayer",props:["src","options"],data(){return{playing:!1,vp:{},currentTime:0,playbackRate:1}},methods:{handleVideoPlay(e){this.$emit("play",e)},handleVideoPlaying(e){this.playing=!0,this.vp=e.target,this.vp.playbackRate=this.playbackRate},handleMouse(e){var t=null;e.type&&"mousedown"==e.type&&(e.cancelBubble=!0,t=e.clientX<window.innerWidth/3?-15:e.clientX>2*window.innerWidth/3?15:0),null!=t&&(0==t?this.toggle_play():this.vp.currentTime+=t)},requestFullscreen(e){e.target.requestFullscreen()},toggle_play(){this.playing?this.vp.pause():this.vp.play()},to_friendly_time(e){function t(e){return e<10?"0"+e:""+e}e|=0;const a=e/60%60|0,s=e/3600|0;return e%=60,s>0?`${s}:${t(a)}:${t(e)}`:`${t(a)}:${t(e)}`},fullscreen(){this.vp.requestFullscreen()},handleKey(e){if(this.playing)switch(e.key){case",":this.vp.currentTime-=15;break;case".":this.vp.currentTime+=15;break;case"/":this.vp.currentTime=this.vp.duration/2;break}}},mounted(){const e=this;setInterval(()=>{const t=e.$refs.duration,a=e.$refs.slider;e.playing&&e.vp.currentTime&&document.activeElement!=a&&(t&&(t.innerText=`${e.to_friendly_time(e.vp.currentTime)}/${e.to_friendly_time(e.vp.duration)}`,a.$el.style.width=window.innerWidth-t.offsetLeft-t.offsetWidth-70+"px"),e.currentTime=e.vp.currentTime)},500)},created(){window.addEventListener("keydown",this.handleKey)},beforeDestroy(){window.removeEventListener("keydown",this.handleKey)}},$e=xe,qe=(a("df07"),Object(E["a"])($e,ke,we,!1,null,"24f80ead",null)),Ce=qe.exports,Ae={name:"ImageBrowsing",components:{ContentView:me,VideoPlayer:Ce},props:["paragraph","item","plugin_pages"],data(){return{browsing_page:2}},watch:{item(e){e&&e.source||this.$emit("browse","continue")}},computed:{browsing_video(){return this.item&&"video"==this.item.item_type}},methods:{quote(e){return encodeURIComponent($["a"].quote(e))},format(e,t){function a(e,a){var s=t;for(var i of a.split("."))s=s[i]||"";return s}return"string"==typeof e&&e.replace(/\{([\w\d._]+)\}/g,a)||""},get_item_image(e){return $["a"].get_item_image(e)},get_item_video(e){return $["a"].get_item_video(e)},fit_image(e){const t=e.target,a=window.innerHeight,s=window.innerWidth,i=t.naturalWidth/t.naturalHeight,r=s/a;var n=0,o=0,l="",c="",u=0,d=0,p=i<1!=r<1;if("both"==$["a"].config.fit&&p){switch(c=1/i>=r?"fit-height":"fit-width",c){case"fit-width":n=s,o=n*i,u=n,d=(a-o)/2;break;case"fit-height":o=a,n=o/i,u=(n+s)/2,d=0;break}l="rotate(90deg)"}else{switch($["a"].config.fit){case"both":case"maximize":c=i>=r?"fit-height":"fit-width";break;default:c=r>1?"fit-height":"fit-width"}switch(c){case"fit-width":o=s,n=s/i;break;case"fit-height":n=a,o=n*i;break}l=`translate(${(s-o)/2}px, ${(a-n)/2}px)`}Object.assign(t.style,{height:n+"px",width:o+"px",transform:l,"transform-origin":"left top",top:d+"px",left:u+"px",position:"absolute",display:"block"})},toggle_fits(){const e=["both","visible","maximize"];$["a"].config.fit=e[(e.indexOf($["a"].config.fit)+1)%e.length],this.fit_image({target:this.$refs.browsing_image}),this.$forceUpdate()},browse_next(){this.$emit("browse","arrowright"),this.browsing_page=2},browse_prev(){this.$emit("browse","arrowleft"),this.browsing_page=2},querystring_stringify:$["a"].querystring_stringify,scope:$["a"].scope}},Se=Ae,je=(a("030a"),a("42ce"),Object(E["a"])(Se,ve,be,!1,null,"7462d287",null)),Oe=je.exports,Pe={name:"PageView",components:{ParamInput:oe["a"],ContentView:me,ImageBrowsing:Oe},data(){return{file:"",page:0,pdf_image:"",show_modal:!1,pagenum_edit:!1,pagenum_editor:{new_pagenum:0,sequential:"all",folio:!1},fetched_paragraphs:[],mongocollection:"paragraph",loading_image:a("6d2d"),paragraph_index:0,item_index:0,playing_timer:0,playing_interval:1e3,last_inc:1,last_wheel:new Date}},props:{view_mode:{default:"file"},paragraphs:{default:()=>[]},start_index:{default:0},value:{default:!0},plugin_pages:{default:[]}},computed:{window_height(){return window.innerHeight},active_paragraph(){return"file"==this.view_mode?this.fetched_paragraphs[0]:Object.assign({},this.paragraphs[this.paragraph_index])},active_item(){return(this.active_paragraph_images||[])[this.item_index]},shown_paragraphs(){return"file"!==this.view_mode?[this.active_paragraph]:this.fetched_paragraphs},active_paragraph_images(){return this.active_paragraph&&this.active_paragraph.images&&this.active_paragraph.images.length?this.active_paragraph.images:this.active_paragraph&&this.active_paragraph.source&&this.active_paragraph.source.file&&this.active_paragraph.source.file.endsWith(".pdf")?[this.active_paragraph]:[]}},beforeDestroy(){window.removeEventListener("keyup",this._event_handler)},created(){window.addEventListener("keyup",this._event_handler)},mounted(){if(this.$el.focus(),!this.paragraph){let e=window.location.href.split("/");if(!e.includes("view"))return;e=e.slice(e.indexOf("view")+1),this.mongocollection=e[0],e.length>2&&(this.file=decodeURIComponent(e.slice(1,-1).join("/")),this.page=+e.slice(-1)[0])}this.update_pdfpage()},watch:{value(e){e?(this.paragraph_index=this.start_index,this.item_index=0,this.update_pdfpage()):this.playing_timer&&window.clearInterval(this.playing_timer)},paragraphs(){this.paragraph_index<0&&(this.paragraph_index=this.paragraphs.length-1,"gallery"==this.view_mode&&(this.item_index=this.paragraphs.slice(-1)[0].images.length-1))}},methods:{_wheel_handler(e){"gallery"===this.view_mode&&(new Date-this.last_wheel>100&&(this._event_handler(e.deltaY>0?"arrowright":"arrowleft"),this.last_wheel=new Date),e.preventDefault())},update_pdfpage(){if("file"==this.view_mode&&this.file){var e=location.href.split("/");e.pop(),e.push(""+this.page),history.pushState(null,null,e.join("/"))}this.pdf_image=this.loading_image,"file"==this.view_mode&&this.file&&$["a"].call("quicktask",{query:"?"+$["a"].querify(this.paragraph_id?{id:this.paragraph_id}:{source:{file:this.file,page:this.page}}),mongocollection:this.mongocollection}).then(e=>{this.fetched_paragraphs=e.result,e.result.length||(this.fetched_paragraphs=[{source:{file:this.file,page:this.page},keywords:[],content:"",_id:""}])});var t="file"==this.view_mode?{file:this.file,page:this.page}:this.active_paragraph.source;if(t&&t.file&&"undefined"!==typeof t.page){var a=$["a"].get_image_url(t),s=new Image;s.src=a,s.onload=()=>{this.pdf_image=s.src}}else this.pdf_image=""},playing(e){"gallery"===this.view_mode&&(e&&(this.playing_interval=e),this.playing_timer=setInterval(()=>{this._event_handler("arrowright")},this.playing_interval))},_event_handler(e){if(document.getSelection().toString()||!this.value)return;if("string"!==typeof e){const t=e;if("INPUT"==t.target.tagName||"TEXTAREA"==t.target.tagName)return;this.playing_timer&&clearInterval(this.playing_timer),e=t.key.toLowerCase(),t.shiftKey&&(e+="shift")}var t=0;switch(e){case"right":case"arrowleft":t=-1;break;case"left":case"arrowright":t=1;break;case"arrowleftshift":t=-this.item_index-1;break;case"arrowrightshift":t=this.active_paragraph_images.length-this.item_index;break;case"continue":t=this.last_inc;break;case"g":document.querySelector(".browsing.description a.t_group").click();break;case"enter":this.playing();break;default:var a=document.querySelector(`[data-keybind="${e}"]`);a&&a.click();break}if(0==t)return;this.last_inc=Math.sign(t);const s=t=>{this.paragraph_index+t>=0&&this.paragraph_index+t<this.paragraphs.length?(this.paragraph_index+=t,this.item_index<0?this.item_index=this.active_paragraph_images.length-1:this.item_index=0,"gallery"!=this.view_mode||this.active_paragraph_images&&0!=this.active_paragraph_images.length||this._event_handler(e)):(this.$emit(t<0?"prev":"next"),this.paragraph_index=t>0?0:-1),this.update_pdfpage()};switch(this.view_mode){case"file":this.page=+this.page+t,this.update_pdfpage();break;case"gallery":if(this.active_paragraph_images&&this.item_index+t>=0&&this.item_index+t<this.active_paragraph_images.length){this.item_index+=t;break}this.item_index=t>0?0:-1,t=Math.sign(t),s(t);break;default:s(t);break}},try_page(e){e|=0,this.page=e,this.update_pdfpage()},save_pagenum(){$["a"].call(`collections/${this.mongocollection||"paragraph"}/${this.active_paragraph._id}/pagenum`,this.pagenum_editor),this.pagenum_edit=!1}}},Te=Pe,Ee=(a("24d9"),Object(E["a"])(Te,ce,ue,!1,null,"a5c961f0",null)),Ie=Ee.exports,Le=function(){var e=this,t=e._self._c;return t("div",{staticClass:"fabs"},[t(q["a"],{attrs:{bordered:"",color:"green darken-2",content:""+e.selection_count,value:e.selection_count>0,overlap:""}},[t(o["a"],{attrs:{fab:"",small:""},on:{click:function(t){return e.$emit("toggle-selection")},dblclick:function(t){return e.$emit("clear-selection")}}},[t(u["a"],[e._v("mdi-select-all")])],1)],1),t(o["a"],{attrs:{fab:"",small:""},on:{click:function(t){return e.$emit("tag")}}},[t(u["a"],[e._v("mdi-tag")])],1),t(o["a"],{attrs:{fab:"",small:""},on:{click:function(t){return e.$emit("rating")}}},[t(u["a"],[e._v("mdi-heart")])],1),t(o["a"],{attrs:{fab:"",small:""},on:{click:function(t){return e.$emit("group")}}},[t(u["a"],[e._v("mdi-group")])],1),t(ae["a"],{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:s}){return[t(o["a"],e._g(e._b({attrs:{fab:"",small:""}},"v-btn",s,!1),a),[t(u["a"],[e._v("mdi-dots-horizontal")])],1)]}}])},[t(d["a"],{staticClass:"pointer"},[e._l(["play","merge","split","reset-storage","task"],(function(a){return t(h["a"],{key:a},[t(_["c"],{on:{click:function(t){return e.$emit(a)}}},[e._v(e._s(e.$t(a)))])],1)})),t(h["a"],[t(_["c"],{on:{click:function(t){return e.$emit("delete")}}},[t(u["a"],[e._v("mdi-delete")]),e._v(" "+e._s(e.$t("delete"))+" ")],1)],1)],2)],1)],1)},Ne=[],Re={name:"QuickActionButtons",props:{selection_count:{type:Number,default:0},playing_interval:{default:1e3}}},De=Re,Ue=(a("02b9"),Object(E["a"])(De,Le,Ne,!1,null,"0bda02b7",null)),ze=Ue.exports,Ve=a("cd55"),We=a("49e2"),Me=a("c865"),Fe=a("0393"),Be=function(){var e=this,t=e._self._c;return t(A["a"],{attrs:{"content-class":"dialog-limit"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t(l["a"],[t(C["c"],[e._v(e._s(e.$t("tagging")))]),t(C["b"],[t(Q["a"],{ref:"ac",attrs:{autofocus:"",items:e.tag_choices,"search-input":e.tag_typing,loading:null!==e.cancel,flat:"",multiple:"",chips:"","deletable-chips":"","hide-selected":"","auto-select-first":"",label:"标签",filter:e.match_pattern,"max-height":"180"},on:{"update:searchInput":function(t){e.tag_typing=t},"update:search-input":function(t){e.tag_typing=t},keyup:[t=>"Enter"!=t.key&&(e.enter_hit=0),function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(()=>2==++e.enter_hit?e.do_submit():null).apply(null,arguments)}]},model:{value:e.tag_new,callback:function(t){e.tag_new=t},expression:"tag_new"}}),t(Fe["a"],[t(Ve["a"],{key:"batched",attrs:{dense:""}},[t(Me["a"],[e._v(e._s(e.$t("tag-batch")))]),t(We["a"],[t(H["a"],{attrs:{label:e.$t("text")},model:{value:e.batch,callback:function(t){e.batch=t},expression:"batch"}}),t(H["a"],{attrs:{label:e.$t("delimiter")},model:{value:e.batch_delim,callback:function(t){e.batch_delim=t},expression:"batch_delim"}}),t(H["a"],{attrs:{label:e.$t("prefix")},model:{value:e.batch_prefix,callback:function(t){e.batch_prefix=t},expression:"batch_prefix"}})],1)],1),t(Ve["a"],{key:"author",attrs:{dense:""}},[t(Me["a"],[e._v(e._s(e.$t("author")))]),t(We["a"],[t(Q["a"],{attrs:{label:e.$t("text"),items:e.author_candidates},model:{value:e.author,callback:function(t){e.author=t},expression:"author"}})],1)],1)],1)],1),t(C["a"],[t("div",{staticStyle:{"margin-top":"250px"}},[t(o["a"],{attrs:{color:"primary"},on:{click:function(t){return e.do_submit()}}},[e._v(" "+e._s(e.$t("ok"))+" ")]),t(o["a"],{on:{click:function(t){e.$emit("cancel"),e.visible=!1}}},[e._v(" "+e._s(e.$t("cancel"))+" ")])],1)])],1)],1)},Je=[],Qe={name:"TaggingDialog",data(){return{tag_choices:[],cancel:null,tag_new:[],tag_typing:"",visible:!1,batch:"",batch_delim:"",batch_prefix:"",enter_hit:0,author:""}},props:{prompt:{type:String,default:""},value:{type:Array,default:()=>[]},scope:{type:String,default:""}},watch:{tag_typing(e){e&&this.search_tag(e)},tag_new(){this.tag_typing&&(this.tag_typing="")}},computed:{author_candidates(){return this.tag_new.filter(e=>!(e.value||e).startsWith("*")).sort()}},mounted(){Object.assign(this,$["a"].config.tagging)},methods:{show(e){var t=[...e].sort();this.visible=!0,this.tag_new=t,this.tag_choices=t,this.batch="",this.author="",this.scope&&$["a"].call("term/keywords",{scope:this.scope}).then(e=>{this.tag_choices=[...t,...e.result]})},escape_search(e){return e=e.match(/^[@*]/)?"\\"+e[0]+".*"+$["a"].escape_regex(e.substr(1)):$["a"].escape_regex(e),e},match_pattern(e,t,a){return a.match(new RegExp(this.escape_search(t),"i"))},search_tag(e){this.cancel&&this.cancel.cancel(),0!=e.length&&"*"!=e&&"@"!=e&&(this.tag_choices=[...this.tag_new],this.cancel=$["a"].cancel_source(),$["a"].call("term/keywords",{pattern:this.escape_search(e),regex:!0},this.cancel).then(e=>{this.cancel=null,this.tag_choices=this.tag_new.map(e=>({text:e,value:e})).concat(e.result.map(e=>({text:e.term,value:e.term})))}).catch(e=>{this.cancel=null,console.log(e),this.tag_choices=[...this.tag_new]}))},do_submit(){this.enter_hit=0,this.author&&(this.$emit("author",this.author),this.author=""),this.batch&&this.tag_new.push(...this.batch.split(this.batch_delim||", ").map(e=>e.trim()).filter(e=>e).map(e=>this.batch_prefix+e)),$["a"].config.tagging={batch_delim:this.batch_delim,batch_prefix:this.batch_prefix},this.$emit("submit",this.tag_new.map(e=>e.value||e)||[this.tag_typing]),this.visible=!1}}},Ke=Qe,He=(a("c000"),Object(E["a"])(Ke,Be,Je,!1,null,null,null)),Xe=He.exports,Ge=function(){var e=this,t=e._self._c;return t(A["a"],{attrs:{width:"unset"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t(l["a"],[t(C["c"],[e._v(e._s(e.$t("tagging")))]),t(C["b"],{staticStyle:{height:"150px"}},[t(Y["a"],{ref:"ac",staticClass:"mx-4",attrs:{autofocus:"",items:e.tag_choices,loading:e.loading,"search-input":e.tag_typing,multiple:"",flat:"","hide-no-data":"","hide-details":"",label:e.$t("tag")},on:{"update:searchInput":function(t){e.tag_typing=t},"update:search-input":function(t){e.tag_typing=t},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.do_submit.apply(null,arguments)},change:function(t){e.tag_typing=""}},model:{value:e.tag_new,callback:function(t){e.tag_new=t},expression:"tag_new"}})],1),t(C["a"],[t(o["a"],{attrs:{color:"primary"},on:{click:e.do_submit}},[e._v(" "+e._s(e.$t("ok"))+" ")]),t(o["a"],{on:{click:function(t){return e.$emit("input",!1)}}},[e._v(" "+e._s(e.$t("cancel"))+" ")])],1)],1)],1)},Ye=[],Ze={name:"TaggingShortcutsDialog",data(){return{tag_choices:[],loading:!1,tag_new:[],tag_typing:"",show:!1}},props:{choices:{default:null},bundle:{default:()=>({})},prompt:{type:String,default:""},value:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},initial:String,match_initials:{type:Boolean,default:!1}},watch:{tag_typing(e){e&&this.search_tag(e)},choices(e){this.tag_choices=e||[]},value(e){this.show=e,e&&(this.tag_new=[],this.tag_typing=this.initial)},show(e){e||this.$emit("input",!1)}},mounted(){this.tag_choices=this.choices||[]},methods:{search_tag(e){if(e){var t=this.choices.filter(t=>t.text.startsWith(e));return t.length>0&&(t[0].text.startsWith(e+" ")&&(this.tag_new=Array.from(new Set(this.tag_new.concat(t[0])))),t.length>1?this.tag_typing=e:this.tag_typing=""),t}},do_submit(){this.$emit("submit",this.tag_new.map(e=>e.value).filter(e=>e)),this.$emit("input",!1)}}},et=Ze,tt=(a("210b4"),Object(E["a"])(et,Ge,Ye,!1,null,"736d6737",null)),at=tt.exports,st={name:"ResultsView",props:{load:{}},components:{ParamInput:oe["a"],PageView:Ie,ContentView:me,QuickActionButtons:ze,TaggingDialog:Xe,TaggingShortcutsDialog:at},data(){return{total:0,page:1,value:[],token:null,page_range:[0,0],plugin_pages:[],sticky:[],config:new Proxy($["a"].config,{get(e,t){return e[t]},set(e,t,a){e[t]=a,this.$forceUpdate()}}),dialogs:{embedded:{visible:!1,target:{}},edit:{visible:!1,target:{},new_field:""},paragraph:{visible:!1,start_index:0,item:{}},info:{visible:!1,target:{}},send_task:{visible:!1,quicktasks:[],pipeline:[],results_count:null},tagging_shortcuts:{visible:!1,list:[],initial:""},tagging:{visible:!1,choices:[]}},selection:[],browsing_item:{},selection_count:0,select_index:-1,last_key:""}},watch:{page(e){this.turn_page(e)},"dialogs.paragraph.visible":function(e){if(!e&&this.$refs.page_view.active_paragraph){var t=document.querySelector(`[data-id="${this.$refs.page_view.active_paragraph._id}"]`);window.scrollTo(0,t.offsetTop)}}},computed:{pages(){var e=[],t=this.total||this.value.length;-1==this.total&&(t=2e5);for(let a=0,s=1;a<t&&s<=1e3;a+=$["a"].config.page_size,s++)e.push(s);return e},visible_data(){return[...this.sticky,...this.value.slice(this.offset-this.page_range[0]).slice(0,$["a"].config.page_size)]},offset(){return(this.page-1)*$["a"].config.page_size},columns(){var e=new Set;for(var t of this.visible_data)for(var a in t)e.add(a);return Array.from(e).sort()}},mounted(){this.start(),$["a"].call("plugins/shortcuts").then(e=>{for(var t in e=e.result,e)this.dialogs.tagging_shortcuts.list.push({text:`${t} ${e[t]}`,value:e[t]})}),$["a"].call("tasks/shortcuts").then(e=>this.dialogs.send_task.quicktasks=e.result.map(e=>({text:e.name,value:e.pipeline}))),$["a"].call("plugins/filters").then(e=>this.plugin_pages=e.result)},created(){window.addEventListener("keyup",this._keyup_handler)},beforeDestroy(){window.removeEventListener("keyup",this._keyup_handler)},methods:{_fetched(){return this.page_range[0]<=this.offset&&this.page_range[1]>this.offset},current_q(){return $["a"].querystring_parse(location.search).q||""},start(e){this.page_range=[0,0];let t=$["a"].querystring_parse(location.search);e||(e=t.page?0|t.page:1),this.turn_page(e)},querify:$["a"].querify,turn_page(e,t){function a(e){e.map(e=>{e.images&&[...e.images.slice(0,5),...e.images.slice(-1)].map(e=>{if("image"==e.item_type){let t=new Image;t.src=$["a"].get_item_image(e)}})})}0!==e&&(history.pushState("","",$["a"].querystring_stringify(Object.assign($["a"].querystring_parse(location.search),{page:this.page}))),this.page!==e&&(this.page=e),window.scroll({top:this.$refs.results.offsetTop-64}),this._fetched()?(a(this.visible_data),"function"==typeof t&&t()):(this.total=null,this.$emit("load",{offset:this.offset,limit:5*$["a"].config.page_size,callback:e=>{if(!(this.token>e.token)){if(this.token=e.token,"undefined"!==typeof e.result){if(Array.isArray(e.result)&&!e.result.length)return void(this.page>1&&(this.page=1));this.selection=[],this.page_range=[e.offset,e.offset+e.result.length];var s=e.result.map(e=>Object.assign(e,{selected:!1})),i=s.filter(e=>e.spacer).length>0;if(i){var r=!0;for(var n of(this.sticky=[],this.value=[],s))(r?this.sticky:this.value).push(n),n.spacer&&(r=!1)}else this.sticky=[],this.value=s;a(this.visible_data),"function"==typeof t&&t()}"undefined"!==typeof e.total&&(this.total=e.total),this.$forceUpdate()}}})))},update_view_mode(){this.start()},show_embedded(e,t){var a=Object.assign({},e);delete a[t],this.embedded={arr:e[t],source:a}},view_page(e){this.dialogs.paragraph.visible=!0,this.dialogs.paragraph.start_index=e,this.clear_selection()},playing(){"gallery"==$["a"].config.view_mode&&(this.view_page(0),this.$refs.page_view.playing($["a"].config.playing_interval))},_keyup_handler(e){if("INPUT"!=e.target.tagName&&"TEXTAREA"!=e.target.tagName){var t,a,s=0;switch(this.$refs.all_items&&document.querySelector(".paragraph")&&(a=parseInt(this.$refs.all_items.clientWidth/document.querySelector(".paragraph").clientWidth)),e.key.toLowerCase()){case"arrowleft":this.dialogs.paragraph.visible||this.turn_page(this.page-1);break;case"arrowright":this.dialogs.paragraph.visible||this.turn_page(this.page+1);break;case"f":this.toggle_selection();break;case"g":this.group(e.altKey||e.ctrlKey);break;case"p":e.altKey||e.ctrlKey?this.split():this.merge();break;case"t":case"@":this.show_tagging_dialog();break;case"n":this.tag(["noted:"+(new Date).toISOString()]);break;case"d":case"-":case"delete":this.last_key==e.key&&this.selected_paragraphs().length>0&&(this.delete_items(),this.last_key=null);break;case"q":case"`":case"escape":this.dialogs.paragraph.visible=!1,this.clear_selection();break;case"a":case"arrowup":case"arrowdown":this.selected_items().length&&this.rating("ArrowDown"!=e.key?.5:-.5);break;case"r":this.last_key==e.key&&this.selected_paragraphs().length>0&&(this.reset_storage(),this.last_key=null);break;case"c":case"z":case"o":case"i":if(e.ctrlKey||e.metaKey)return;if(this.selected_paragraphs().length>0){var i=this.selected_paragraphs()[0];switch(e.key.toLowerCase()){case"o":this._open_window(i.source.url);break;case"c":if(e.ctrlKey)return;this._open_window({q:"author="+($["a"].quote(i.author)||i.keywords.filter(e=>e.startsWith("@"))[0]||""),groups:"none"});break;case"z":this._open_window(e.shiftKey?`/?q=source.url%25%27${$["a"].escape_regex(i.source.url).replace(/\/\d+\//,"/.*/")}'`:`/?q=id%3D${i._id}=>expand()&groups=none`);break;case"i":this.dialogs.info.visible=!this.dialogs.info.visible,this.dialogs.info.target=this.selected_paragraphs()[0];break}}break;case"h":case"j":case"k":case"l":case";":switch(e.key.toLowerCase()){case"h":s=-1;break;case"j":s=a;break;case"k":s=-a;break;case"l":s=1;break;case";":s=0;break}s=this.select_index<0?0:Math.min(Math.max(0,this.select_index+s),this.visible_data.length),e.ctrlKey||e.shiftKey||this.clear_selection(),this.update_selection(this.visible_data[s],e,s),t=document.querySelector(`[data-id="${this.visible_data[s]._id}"]`),window.scrollTo(0,t.offsetTop-t.clientHeight),this.select_index=s;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this.dialogs.tagging_shortcuts.visible=this.selected_paragraphs().length>0,this.dialogs.tagging_shortcuts.initial=e.key;break;default:var r=Object.values(this.plugin_pages).filter(t=>t.keybind==e.key);r.length&&this._open_window({archive:!0,q:`${this.scope(this.selected_paragraphs()[0])};plugin('${this.format(r[0].format,{mediaitem:this.selected_items()[0],paragraph:this.selected_paragraphs()[0]})}')`});break}this.last_key=null===this.last_key?"":e.key}},save(){$["a"].call(`collections/${this.dialogs.edit.target.mongocollection||"paragraph"}/${this.dialogs.edit.target._id}`,this.dialogs.edit.target).then(()=>{this.dialogs.edit.target=null,$["a"].notify({title:this.$t("saved")})})},send_task(e){this.dialogs.send_task.visible=!0,e&&(this.dialogs.send_task.pipeline=e,this.$refs.quicktask_results.start(1))},format(e,t){function a(e,a){var s=t;for(var i of a.split("."))s=s[i]||"";return s}return"string"==typeof e&&e.replace(/\{([\w\d._]+)\}/g,a)||""},quicktask(e){$["a"].call("quicktask",{pipeline:[["JSONDataSource",{content:JSON.stringify(this.selected_paragraphs().map(e=>Object.assign({},e,{matched_content:null})))}],...this.dialogs.send_task.pipeline.slice(1)]}).then(t=>{e.callback({result:t.result,offset:0,total:t.result.length,token:(new Date).getTime()})})},_open_window(e){"object"===typeof e&&(e="/"+$["a"].querystring_stringify(e)),window.open(e)},_show_dialog(e){this.drawer=!1,this.dialogs[e]=!0},fav(e){$["a"].fav(e)},favored(e){return $["a"].favored(e)},quote:$["a"].quote,selected_paragraphs(){return this.dialogs.paragraph.visible?this.visible_data.filter(e=>e._id==this.$refs.page_view.active_paragraph._id):[...this.selection]},selected_items(){return this.dialogs.paragraph.visible?[Object.assign({},this.$refs.page_view.active_item,{paragraph_id:this.selected_paragraphs()[0]._id})]:this.selected_paragraphs().reduce((e,t)=>e.concat(t.images.map(e=>(e.paragraph_id||(e.paragraph_id=t._id),e))),[])},selected_ids(){return this.selected_paragraphs().map(e=>e._id)},update_selection(e,t,a){var s=[];if(t&&t.shiftKey&&this.select_index>=0){document.getSelection().removeAllRanges();let e=Math.min(this.select_index,a),t=Math.max(this.select_index,a);for(var i=e;i<=t;++i)i==this.select_index||this.visible_data[i].spacer||s.push(this.visible_data[i])}else s=[e];for(var r of(this.select_index=a,s))t&&(r.selected=!r.selected),r._id&&r.selected?this.selection.push(r):this.selection.splice(this.selection.indexOf(r),1);this.selection_count=this.selection.length},set_selection(e){this.clear_selection(),e.forEach(e=>e.selected=!0),this.selection=e,this.selection_count=this.selection.length},toggle_selection(){this.visible_data.forEach(e=>e.selected=!e.selected),this.selection=this.visible_data.filter(e=>e._id&&e.selected),this.selection_count=this.selection.length},clear_selection(e){"undefined"===typeof e&&(e=this.visible_data),e.forEach(e=>{e.selected=!1,this.selection.splice(this.selection.indexOf(e),1)}),this.selection_count=this.selection.length},show_tagging_dialog(){if(this.selected_paragraphs().length>0){var e=new Set(this.selected_paragraphs().reduce((e,t)=>e.concat(t.keywords),[]));this.$refs.tagging_dialog.show(Array.from(e))}},set_author(e){var t=this.selected_paragraphs();t&&t.length&&$["a"].call(`collections/${t[0].mongocollection||"paragraph"}/batch`,{ids:this.selected_ids(),author:e,$push:{keywords:e}}).then(e=>{this.clear_selection(t),t.forEach(t=>{e.result[t._id]&&(t.author=e.result[t._id].author)})})},tag(e,t=!0){var a=this.selected_paragraphs();if(a&&a.length){var s=new Set(this.selected_paragraphs().reduce((e,t)=>e.concat(t.keywords),[])),i=t?e:e.filter(e=>!s.has(e)),r=t?[]:Array.from(s).filter(t=>!e.includes(t)),n={ids:this.selected_ids(),$push:{keywords:i},$pull:{keywords:r}};i.filter(e=>e.startsWith("@"))?n.author=i.filter(e=>e.startsWith("@"))[0]:r.filter(e=>e.startsWith("@"))&&(n.author=""),$["a"].call(`collections/${a[0].mongocollection||"paragraph"}/batch`,n).then(e=>{this.clear_selection(a),a.forEach(t=>{e.result[t._id]&&(t.keywords=e.result[t._id].keywords)})})}},select_paragraph_item_objects(e){var t={},a={};return this.selected_items().forEach(e=>{t[e.paragraph_id]||(t[e.paragraph_id]=[]),t[e.paragraph_id].push(e._id)}),e.forEach(e=>{a[e._id]||(a[e._id]=[]),a[e._id].splice(0,0,...this.dialogs.paragraph.visible?this.selected_items().map(e=>e._id):e.images.map(e=>e._id))}),{album_items:t,visible_album_items:a}},delete_items(){var e=this.selected_paragraphs(),t=this.select_paragraph_item_objects(e);$["a"].call("mediaitem/delete",{album_items:t.album_items}).then(()=>{e.forEach(e=>{e.images=e.images.filter(a=>!t.visible_album_items[e._id].includes(a._id))}),this.clear_selection(e)})},rating(e){var t=this.selected_paragraphs();"number"===typeof e&&(e={inc:e,least:e>0?1:-1}),e.ids=(e.item?[e.item]:this.selected_items()).map(e=>e._id),e.item&&delete e.item,"gallery"==$["a"].config.view_mode?$["a"].call("mediaitem/rating",e).then(e=>{e=e.result||{},this.clear_selection(t),t.forEach(t=>t.images.forEach(t=>"undefined"!==typeof e[t._id]&&(t.rating=e[t._id])))}):(t.forEach(e=>this.fav(e)),this.clear_selection(t))},group(e){var t=this.selected_paragraphs();if(t&&t.length){var a={ids:this.selected_ids(),ungroup:e};if(!e&&t.length==this.visible_data.length&&0==t.map(e=>e.keywords.filter(e=>e.match(/^\*[^0]/))).reduce((e,t)=>e.concat(t)).length){var s=this.current_q().replace(/[()"`'%^@\\]/g,"").split(/[,|]/)[0];a.group=(prompt(this.$t("group"),s)||"").replace(/^\*/,"")}$["a"].call(`collections/${t[0].mongocollection||"paragraph"}/group`,a).then(e=>{this.clear_selection(t),t.forEach(t=>t.keywords=t.keywords.filter(t=>!t.startsWith("*")&&t!==e.result).concat(e.result?[e.result]:[]))})}},merge(){var e=this.selected_paragraphs(),t=this.select_paragraph_item_objects(e);e&&e.length&&$["a"].call(`collections/${e[0].mongocollection||"paragraph"}/merge`,{paragraphs:t.album_items}).then(()=>this.clear_selection(e))},split(){var e=this.selected_paragraphs(),t=this.select_paragraph_item_objects(e);e&&e.length&&$["a"].call(`collections/${e[0].mongocollection||"paragraph"}/split`,{paragraphs:t.album_items}).then(()=>this.clear_selection(e))},reset_storage(){var e=this.selected_paragraphs();$["a"].call("mediaitem/reset_storage",{ids:this.selected_items().map(e=>e._id)}).then(()=>this.clear_selection(e))},get_paragraph_image(e){return $["a"].get_paragraph_image(e)},querystring_stringify:$["a"].querystring_stringify,scope:$["a"].scope}},it=st,rt=(a("faad"),a("8878"),Object(E["a"])(it,re,ne,!1,null,"7d00bbc8",null)),nt=rt.exports,ot={name:"SearchForm",components:{ResultsView:nt,ParamInput:oe["a"]},data(){return{datasets:[],selected_datasets:[],open_datasets:[],selected_mongocollections:[],q:"",groups:"none",sort:"",querystr:"",req:"",selection_bundles:{},external_json:null,page_size:50,cancel_source:$["a"].cancel_source(),expert:$["a"].config.expert}},mounted(){let e=$["a"].config;e.page_size&&(this.page_size=e.page_size),e.sort&&(this.sort=e.sort),e.groups&&(this.groups=e.groups);let t=$["a"].querystring_parse(location.search);for(var a of(e.expert&&t.q&&t.q.startsWith("? ")&&(t.q=t.q.replace(/^\? /,"")),["q","sort","groups"]))t[a]&&(this[a]=t[a]);$["a"].config.expert&&this.$refs.search_code.refresh(this.q),$["a"].get_datasets_hierarchy().then(a=>{this.datasets=a.hierarchy,this.selection_bundles=a.bundles,this.selected_datasets=t.selected_datasets||e.selected_datasets||[],this.q&&this.search(!0)})},methods:{datasets_req(){var e=this.selected_datasets.map(e=>this.selection_bundles[e]),t="";if(e.length>0){var a=e.filter(e=>!e.source).map(e=>$["a"].escape_regex(e.dataset_name)),s=e.filter(e=>e.source).map(e=>({file:e.source.split(":",2).pop(),dataset:e.dataset_name})),i="",r="";this.selected_mongocollections=Array.from(new Set(e.map(e=>e.mongocollection))),a.length>0&&(i="dataset%`^"+a.map(e=>""==e?"$":$["a"].escape_regex(e)).join("|^")+"`"),s.length>0&&(r=s.map(e=>`(dataset='${e.dataset}',source.file='${e.file}')`).join("|")),t="("+[i,r].filter(e=>e.length>0).join("|")+")"}return"gallery"==$["a"].config.view_mode&&(t+=(t?",":"")+"images!=[]"),t},search(e){this.external_json=null,0==this.selected_datasets.length&&(this.selected_datasets=this.datasets.map(e=>e.id)),this.req=this.datasets_req(),!0!==e&&history.pushState("","",$["a"].querystring_stringify(Object.assign($["a"].querystring_parse(location.search),{q:this.q,selected_datasets:this.selected_datasets,sort:this.sort,groups:this.groups,selected_mongocollections:this.selected_mongocollections}))),this.$refs.results.start(!0===e?void 0:1)},load_search(e){var t=(new Date).getTime()+Math.random();if(this.external_json)e.callback({result:this.external_json.slice(e.offset,e.offset+e.limit),offset:e.offset,total:this.external_json.length,token:t});else if(this.q||this.req)if(this.q.startsWith("file:"))this.load_remote_file(this.q.substring(5).trim());else{this.cancel_source&&this.cancel_source.cancel(),this.cancel_source=$["a"].cancel_source();var a={q:(this.expert?"? ":"")+this.q,req:this.req,sort:"object"===typeof this.sort?this.sort.value:this.sort,mongocollections:this.selected_mongocollections,offset:e.offset,limit:e.limit,groups:"object"===typeof this.groups?this.groups.value:this.groups};"random"!==a.sort&&($["a"].config.sort=a.sort),$["a"].config.groups=a.groups,$["a"].call("search",a,this.cancel_source).then(a=>{if(a){if(a.result.query){var s=new RegExp("("+this.keyword_patterns(a.result.query).filter(e=>e).join("|")+")","gi");this.results=a.result.results,"/()/gi"!=s&&(this.results=this.results.map(e=>(e.matched_content=(e.content||"").replace(s,"<em>$1</em>"),e)))}this.querystr=$["a"].querify(a.result.query).replace(/^\(|\)$/g,""),e.callback({token:t,result:a.result.results,offset:e.offset})}else console.log("WARNING: no data returned.")}),$["a"].call("search",Object.assign({count:!0},a,this.cancel_source)).then(a=>{a.result&&e.callback({token:t,total:a.result})})}},keyword_patterns(e){return Array.isArray(e)?e.map(e=>this.keyword_patterns(e)).reduce((e,t)=>e.concat(t),[]):["string","number","boolean"].includes(typeof e)?[]:Object.entries(e).map(e=>{let t=e[0],a=e[1];if("keywords"==t){if("string"==typeof a)return[$["a"].escape_regex(a)];if("string"==typeof a.$regex)return[a.$regex]}return this.keyword_patterns(a)}).reduce((e,t)=>e.concat(t),[])},export_query(e,t){"function"!==typeof t&&(t=e=>this.$router.push("/tasks/"+e.result).catch(()=>{})),$["a"].put("tasks/",{name:this.$t("search")+" "+(new Date).toLocaleString().replace(/[^\d]/g,""),pipeline:[["DBQueryDataSource",{query:this.q,req:this.req,mongocollections:this.selected_mongocollections}],["AccumulateParagraphs",{}],["Export",{output_format:e}]]}).then(t)},export_file(e){this.export_query(e,e=>{$["a"].put("queue/",{id:e.result}).then(e=>$["a"].notify({title:this.$t("task-enqueued",{task:e.result})}))})},drop_json_file(e){let t=Array.from(e.dataTransfer.files).filter(e=>e.name.match(/\.json$/));if(!t.length)return;let a=t[0],s=new FileReader;s.onload=e=>{this.external_json=JSON.parse(e.target.result),this.$refs.results.start()},s.readAsText(a)},load_remote_file(e){$["a"].call("image?file="+e).then(e=>{this.external_json=e,this.$refs.results.start()})}}},lt=ot,ct=(a("6fdc"),Object(E["a"])(lt,X,G,!1,null,"4e85c642",null)),ut=ct.exports,dt=a("a844"),pt=function(){var e=this,t=e._self._c;return t("div",[t(l["a"],{attrs:{flat:""}},[t(C["b"],[t("ParamInput",{attrs:{arg:{name:e.$t("name"),type:""}},model:{value:e.task.name,callback:function(t){e.$set(e.task,"name",t)},expression:"task.name"}}),t("span",[e._v("ID: "+e._s(e.task._id)+" "+e._s(e.$t("created-by"))+": "+e._s(e.task.creator))]),t(K["a"],[t(J["a"],[t(ee["a"],{staticClass:"d-inline-block",attrs:{label:e.$t("shared"),disabled:e.task.creator!==e.user},model:{value:e.task.shared,callback:function(t){e.$set(e.task,"shared",t)},expression:"task.shared"}}),t(ee["a"],{staticClass:"d-inline-block ml-5",attrs:{label:e.$t("resume-next")},model:{value:e.task.resume_next,callback:function(t){e.$set(e.task,"resume_next",t)},expression:"task.resume_next"}}),t(H["a"],{staticClass:"d-inline-block ml-5",attrs:{label:e.$t("concurrent"),type:"number",rules:[t=>t>=1&&t<=10&&t==parseInt(t)||e.$t("number-1-10")]},on:{input:t=>e.task.concurrent=parseInt(t)},model:{value:e.task.concurrent,callback:function(t){e.$set(e.task,"concurrent",t)},expression:"task.concurrent"}})],1)],1),t(K["a"],[t(J["a"],[t(o["a"],{attrs:{color:"primary"},on:{click:e.enqueue}},[t(u["a"],[e._v("mdi-play")]),e._v(" "+e._s(e.$t("run-background"))+" ")],1)],1)],1),t(S["a"],{staticClass:"mt-5 mb-5"}),t("div",{attrs:{id:"pipeline"}},[t("h2",[e._v(" "+e._s(e.$t("pipeline"))+" "),e.pipelines?t(o["a"],{staticClass:"ml-5",on:{click:function(t){e.blockly=!0}}},[t(u["a"],[e._v("mdi-layers")]),e._v(" "+e._s(e.$t("design-view")))],1):e._e()],1),t("Pipeline",{staticStyle:{"margin-left":"0 !important"},attrs:{map_id:"pipeline"},on:{shortcut:e.update_shortcut,validation:function(t){return e.update_valid("pipeline_main",t)}},model:{value:e.task.pipeline,callback:function(t){e.$set(e.task,"pipeline",t)},expression:"task.pipeline"}})],1),t("div",{attrs:{id:"shortcut_map"}},[t("h2",[e._v(e._s(e.$t("shortcut-params")))]),t("div",e._l(e.task.shortcut_map,(function(a,s){return t("div",{key:s},[t("ParamInput",{attrs:{arg:{name:s,type:"str",default:"''"}},model:{value:e.task.shortcut_map[s],callback:function(t){e.$set(e.task.shortcut_map,s,t)},expression:"task.shortcut_map[k]"}})],1)})),0)])],1),t(C["a"],[t(o["a"],{staticClass:"ml-5",attrs:{color:"primary"},on:{click:function(t){e.save().then(()=>e.notify(e.$t("saved")))}}},[t(u["a"],[e._v("mdi-check")]),e._v(" "+e._s(e.$t("save"))+" ")],1),t(o["a"],{staticClass:"ml-3",attrs:{color:"error"},on:{click:function(t){return e.delete_task()}}},[t(u["a"],[e._v("mdi-delete")]),e._v(" "+e._s(e.$t("delete"))+" ")],1),t(o["a"],{staticClass:"ml-3",on:{click:function(t){e.show_code=!e.show_code}}},[t(u["a"],[e._v("mdi-code-braces")])],1)],1),t(K["a"],{staticClass:"ma-10"},[t(dt["a"],{directives:[{name:"show",rawName:"v-show",value:e.show_code,expression:"show_code"}],attrs:{value:e.querify(e.task),readonly:""}})],1)],1),e.pipelines?t("BlocklyComponent",{directives:[{name:"show",rawName:"v-show",value:e.blockly,expression:"blockly"}],attrs:{json:e.task.pipeline,pipelines:e.pipelines,tasks:e.tasks},on:{save:function(t){e.task.pipeline=t,e.blockly=!1},cancel:function(t){e.blockly=!1}}}):e._e()],1)},ht=[],_t=a("0057"),gt=function(){var e=this,t=e._self._c;return t("div",[t("div",{ref:"blocklyDiv",staticClass:"blocklyDiv",attrs:{id:"blocklyDiv"}}),t("xml",{ref:"blocklyToolbox",staticStyle:{display:"none"}}),t("div",{staticClass:"options"},[t(o["a"],{attrs:{color:"primary"},on:{click:e.save}},[e._v(e._s(e.$t("save")))]),t(o["a"],{staticClass:"ml-5",on:{click:function(t){return e.$emit("cancel")}}},[e._v(e._s(e.$t("cancel")))])],1)],1)},mt=[],ft=a("54ca"),vt=a.n(ft),bt={name:"BlocklyComponent",props:["json","pipelines","tasks"],data(){return{workspace:null,blocks_dict:{}}},mounted(){var e=setInterval(()=>{if(this.pipelines&&this.json&&this.tasks.length&&this.$refs.blocklyDiv){var t={media:"media/",toolbox:this.load_toolbox()};console.log(t.toolbox),this.workspace=vt.a.inject(this.$refs.blocklyDiv,t),this.workspace.clear();var a=document.createElement("xml");this.to_xml(a,this.json),console.log(a),vt.a.Xml.domToWorkspace(a,this.workspace),clearInterval(e)}},1e3)},methods:{auto_parse(e){return"string"!==typeof e?e:"FALSE"===e||"TRUE"===e?"TRUE"===e:e.match(/^[+-]?\d+\.?\d*[Ee]?[+-]?\d*$/)?+e:e},load_toolbox(){var e={kind:"categoryToolbox",contents:[]};for(var t in e.contents.push({kind:"category",name:"过程处理",contents:[]}),this.pipelines){e.contents.push({kind:"category",name:t,colour:160,contents:[]});let i=e.contents.slice(-1)[0].contents,r=this.pipelines[t];for(var a in r){let e=r[a],t={previousStatement:null,nextStatement:null,colour:160,message0:`${e.name} ${e.doc}`};this.blocks_dict[e.name]=e;for(var s=0;s<e.args.length;++s){let a=e.args[s];a.description=a.description||a.name,t["message"+(s+1)]=a.description.includes("%1")?a.description:a.description+"：%1",t["args"+(s+1)]=[a.type.includes("|")?{type:"field_dropdown",name:a.name,options:a.type.split("|").map(e=>e.includes(":")?e.split(":"):[e,e])}:["float","int"].includes(a.type)?{type:"field_number",name:a.name}:"bool"==a.type?{type:"field_checkbox",name:a.name}:"TASK"==a.type?{type:"field_dropdown",name:a.name,options:this.tasks.map(e=>[e.name,e._id])}:"pipeline"==a.type?{type:"input_statement",name:a.name}:{type:"input_value",name:a.name}]}vt.a.Blocks[e.name]={init(){this.jsonInit(t)}},i.push({kind:"block",type:e.name})}}e.contents.push({kind:"category",name:"常量",contents:[{kind:"block",type:"text"},{kind:"block",type:"text_multiline"},{kind:"block",type:"math_number"}]});var i=[{type:"function_size",name:"数组长度",message0:"数组 %1 的长度",args0:[{type:"input_value",name:"VALUE"}],output:"Number",colour:160,tooltip:"Returns number of array element."},{type:"function_strlenCP",name:"字符串长度",message0:"字符串 %1 的长度",args0:[{type:"input_value",name:"VALUE"}],output:"Number",colour:160,tooltip:"Returns number of letters in the provided text."}];const r=Object.entries({"文件来源":"source__file","网页来源":"source__url","文件页码":"source__page","页码":"pagenum","日期":"pdate","关键词和标签":"keywords","内容":"content","语言":"lang","数据集":"dataset","大纲":"outline","图像":"images"});return e.contents.push({kind:"category",name:"查询",contents:[{kind:"block",type:"logic_compare"},{kind:"block",type:"logic_operation"},{kind:"block",type:"logic_boolean"},...r.map(e=>{var t={kind:"block",type:"constant_"+e[1],name:e[0],message0:e[0],args0:[],output:"String",color:160};return vt.a.Blocks[t.type]={init(){this.jsonInit(t)}},{kind:"block",type:t.type}}),...i.map(e=>(vt.a.Blocks[e.type]={init(){this.jsonInit(e)}},{kind:"block",type:e.type}))]}),e},to_xml(e,t){var a=0;for(var s of t){if(a>0){var i=document.createElement("next");e.appendChild(i),e=i}let t=s[0],d=s[1];var r=document.createElement("block");if(r.setAttribute("type",t),this.blocks_dict[t]){for(var n in d){let e=d[n],a=this.blocks_dict[t].args.filter(e=>e.name==n)[0];if(!a){console.log("?arg",n);continue}let s=a.type;var o="";if(["bool","float","int","TASK"].includes(s)||s.includes("|"))o=document.createElement("field"),o.setAttribute("name",n),e=""+e,"bool"==s&&(e=e.toUpperCase()),o.innerHTML=e,r.appendChild(o);else if("pipeline"==s)o=document.createElement("statement"),o.setAttribute("name",n),this.to_xml(o,e),r.appendChild(o);else{var l=document.createElement("value");l.setAttribute("name",n);var c=document.createElement("block");c.setAttribute("type",(e||"").includes("\n")?"text_multiline":"text");var u=document.createElement("field");u.setAttribute("name","TEXT"),u.innerHTML=e,c.appendChild(u),l.appendChild(c),r.appendChild(l)}}e.append(r),e=r,++a}else console.log("?unknown block",t)}},from_field_expr(e){var t="";switch(e.type=e.getAttribute("type"),e.type){case"math_number":case"text":case"text_multiline":return this.auto_parse(e.getElementsByTagName("field")[0].innerHTML);case"logic_compare":return t=e.querySelector('field[name="OP"]').textContent,this.from_field_expr(e.querySelector("[name=A]"))+{EQ:"=",LT:"<",LE:"<=",GT:">",GE:">=",NE:"!="}[t]+this.from_field_expr(e.querySelector("[name=B]"));default:if(e.type.startsWith("constant_"))return e.type.split("_",2)[1].replace(/__/g,".");if(e.type.startsWith("function_"))return e.type.split("_",2)[1]+"("+this.from_field_expr(e.type.querySelector("[name=VALUE]"))+")";break}return""},from_xml(e){var t=[];while(e){var a=null,s={name:e.getAttribute("type"),args:{}};for(var i of e.children)switch(i.tagName){case"next":a=i.children[0];break;case"field":case"value":s.args[i.getAttribute("name")]=this.from_field_expr(i.children[0]);break;case"statement":s.args[i.getAttribute("name")]=this.from_xml(i.children[0]);break}t.push([s.name,s.args]),e=a}return t},save(){var e=vt.a.Xml.workspaceToDom(this.workspace);if(e.children.length){var t=e.children[0],a=this.from_xml(t);console.log(a),this.$emit("save",a)}}}},yt=bt,kt=(a("f994"),Object(E["a"])(yt,gt,mt,!1,null,"350904c4",null)),wt=kt.exports,xt={name:"TaskDetail",components:{Pipeline:_t["a"],BlocklyComponent:wt,ParamInput:oe["a"]},props:["id"],data(){return{task:{_id:"",name:"",shortcut_map:{},pipeline:[]},blockly:!1,pipelines:null,valid:[],show_code:!1,tasks:[]}},mounted(){$["a"].call("tasks/"+this.id).then(e=>{this.task=e.result}),$["a"].call("tasks/").then(e=>this.tasks=e.result),$["a"].help_pipelines().then(e=>this.pipelines=e)},computed:{user(){return $["a"].user}},methods:{update_valid(e,t){var a=this.valid.indexOf(e);a>=0&&this.valid.splice(a,1),t||this.valid.push(e)},delete_task(){confirm(this.$t("confirm-delete"))&&$["a"].delete("tasks/"+this.task._id).then(e=>{e.result.ok&&($["a"].notify(this.$t("deleted")),this.$router.push("/tasks").catch(()=>{}))})},save(){if(!(this.valid.length>0)){for(var e in this.task.shortcut_map)""!==this.task.shortcut_map[e]&&null!==this.task.shortcut_map[e]||delete this.task.shortcut_map[e];return $["a"].call("tasks/"+this.task._id,this.task).then(e=>{var t=this.task._id;return this.task=e.result.updated,this.task._id=t,t})}alert(this.$t("invalid-input"))},notify(e){$["a"].notify({title:e})},enqueue(){this.save().then(e=>$["a"].put("queue/",{id:e}).then(e=>{this.notify(this.$t("task-enqueued",{task:e.result}))}))},update_shortcut(e,t){this.task.shortcut_map[e]=t||e.split(".").slice(-1)[0],this.$forceUpdate()},querify(){return this.task.pipeline.map(e=>{var t={};return t["$"+e[0]]=e[1],$["a"].querify(t).replace(/^\(|\)$/g,"")}).join(";\n")}}},$t=xt,qt=Object(E["a"])($t,pt,ht,!1,null,null,null),Ct=qt.exports,At=function(){var e=this,t=e._self._c;return t(ie["a"],[t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("quick-task"))+" "+e._s(e.task.name))]),t(C["b"],[t(d["a"],e._l(e.task.shortcut_map,(function(a,s){return t(h["a"],{key:a},[t(_["a"],[t(_["c"],[e._v(e._s(a))]),t(_["b"],[t("ParamInput",{attrs:{arg:e.get_map_arg(s)},on:{validation:function(t){return e.update_valid("shortcut_param_"+s,t)},input:function(t){return e.$forceUpdate()}},model:{value:e.shortcut_params[s],callback:function(t){e.$set(e.shortcut_params,s,t)},expression:"shortcut_params[v]"}})],1)],1)],1)})),1)],1),t(C["a"],[t(o["a"],{staticClass:"ml-4",on:{click:e.quicktask}},[t(u["a"],[e._v("mdi-fast-forward")]),e._v(" "+e._s(e.$t("run-now"))+" ")],1),t(o["a"],{on:{click:e.enqueue}},[t(u["a"],[e._v("mdi-play")]),e._v(" "+e._s(e.$t("run-background"))+" ")],1),t(o["a"],{attrs:{color:"primary"},on:{click:function(t){return e.$router.push("/tasks/"+e.id)}}},[t(u["a"],[e._v("mdi-file-edit-outline")]),e._v(" "+e._s(e.$t("edit"))+" ")],1)],1)],1),t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("results")))]),t(C["b"],[t("ResultsView",{ref:"results",attrs:{view_mode:e.view_mode},on:{load:e.load_search}}),e._v(" "+e._s(e.result_plain)+" ")],1)],1)],1)},St=[],jt=(a("b7ef"),a("907a"),a("3c5d"),a("fa9e"),a("77d9"),{name:"TaskShortcut",components:{ParamInput:oe["a"],ResultsView:nt},props:["id"],data(){return{stages:{},task:{_id:"",name:"",shortcut_map:{},pipeline:[]},view_mode:"list",shortcut_params:{},results:[],result_plain:"",valid:[]}},watch:{id(){this.shortcut_params={},this.results=[],this.valid=[],this.result_plain=""}},mounted(){$["a"].help_pipelines().then(e=>{for(var t in e)Object.assign(this.stages,e[t]);$["a"].call("tasks/"+this.id).then(e=>{for(var t in this.task=e.result,this.task.shortcut_map)this.shortcut_params[t]=this.get_map_val(t)})})},methods:{update_valid(e,t){var a=this.valid.indexOf(e);a>=0&&this.valid.splice(a,1),t||this.valid.push(e)},notify(e){$["a"].notify({title:e})},update_params(){for(var e in this.shortcut_params){const s=this.shortcut_params[e],i=e.split(".");var t=this.task.pipeline;for(var a of i.slice(1,-1))t=a.match(/^\d+$/)?t[+a][1]:t[a];t[i.slice(-1)[0]]=s}},quicktask(){this.update_params(),this.result_plain="",$["a"].call("quicktask",{pipeline:this.task.pipeline}).then(e=>{if(Array.isArray(e.result))this.results=e.result,this.$refs.results.start(1),this.result_plain="";else if("object"===typeof e.result&&null!==e.result&&e.result.__file_ext__){const t=(e,t="",a=512)=>{const s=atob(e),i=[];for(let n=0;n<s.length;n+=a){const e=s.slice(n,n+a),t=new Array(e.length);for(let a=0;a<e.length;a++)t[a]=e.charCodeAt(a);const r=new Uint8Array(t);i.push(r)}const r=new Blob(i,{type:t});return r};$["a"].blob_download(t(e.result.data),this.task.name+"."+e.result.__file_ext__)}else this.result_plain=JSON.stringify(e.result),this.results=[],this.$refs.results.start(1)})},enqueue(){if(this.update_params(),this.valid.length>0)alert(this.$t("invalid-input"));else{for(var e in this.task.shortcut_map)"undefined"!==typeof this.task.shortcut_map[e]&&""!==this.task.shortcut_map[e]&&null!==this.task.shortcut_map[e]||delete this.task.shortcut_map[e];$["a"].call("tasks/"+this.task._id,this.task).then(e=>{var t=this.task._id;return this.task=e.result.updated,this.task._id=t,t}).then(e=>$["a"].put("queue/",{id:e}).then(e=>{this.notify(this.$t("task-enqueued",{task:e.result}))}))}},querify(){var e=$["a"].querify(this.task.pipeline,"");return 1==this.task.pipeline.length?"[];"+e:e},get_map_arg(e){e=e.split(".");var t={},a=this.task.pipeline;for(var s of e.slice(1,-1))a=s.match(/^\d+$/)?a[+s]:a[1][s];var i=e.pop();return t=this.stages[a[0]].args.filter(e=>e.name==i)[0],t},get_map_val(e){e=e.split(".");var t=this.task.pipeline;for(var a of e.slice(1))t=a.match(/^\d+$/)?t[+a][1]:t[a];return t},load_search(e){var t=(new Date).getTime()+Math.random();e.callback({result:this.results,offset:0,total:this.results.length,token:t})}}}),Ot=jt,Pt=Object(E["a"])(Ot,At,St,!1,null,null,null),Tt=Pt.exports,Et=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("task"))+" "),t(y["a"]),t(o["a"],{attrs:{color:"primary"},on:{click:function(t){return e.create_task()}}},[t(u["a"],[e._v("mdi-plus")]),e._v(" "+e._s(e.$t("new-task"))+" ")],1)],1),t(C["b"],e._l(e.tasks,(function(a){return t(K["a"],{key:a._id,staticClass:"ma-3"},[t("span",{staticClass:"name"},[e._v(e._s(a.name))]),t("span",{staticClass:"opers"},[t(o["a"],{attrs:{to:"/tasks/"+a._id}},[t(u["a"],[e._v("mdi-file-edit-outline")])],1),t(o["a"],{on:{click:function(t){return e.duplicate_task(a)}}},[t(u["a"],[e._v("mdi-content-copy")])],1),t(o["a"],{on:{click:function(t){return e.enqueue_task(a)}}},[t(u["a"],[e._v("mdi-play")])],1)],1),t("br"),t("span",{staticClass:"id"},[e._v(e._s(a._id))])])})),1)],1)},It=[],Lt={data(){return{tasks:[]}},methods:{create_task(){$["a"].put("tasks/",{name:this.$t("new-task")+" "+new Date}).then(e=>this.$router.push("/tasks/"+e.result))},duplicate_task(e){var t=Object.assign({},e);t._id=null,t.name+=" "+this.$t("copy"),$["a"].put("tasks/",t).then(e=>this.$router.push("/tasks/"+e.result))},delete_task(e){$["a"].delete("tasks/"+e._id).then(()=>this.tasks=this.tasks.filter(t=>t._id!=e._id))},enqueue_task(e){$["a"].put("queue/",{id:e._id}).then(e=>{$["a"].notify(this.$t("task-enqueued",{task:e.result}))})}},mounted(){$["a"].call("tasks/").then(e=>this.tasks=e.result)}},Nt=Lt,Rt=(a("38d2"),Object(E["a"])(Nt,Et,It,!1,null,"1d2bdd0c",null)),Dt=Rt.exports,Ut=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("datasets")))]),t(C["b"],[t(d["a"],{attrs:{"two-line":""}},[t("draggable",{model:{value:e.datasets,callback:function(t){e.datasets=t},expression:"datasets"}},[e._l(e.datasets,(function(a){return[t(h["a"],{key:a._id},[t(_["a"],[t(_["c"],[e._v(" "+e._s(a.display_name||a.name)+" "),a.display_name?t("span",[e._v("("+e._s(a.name)+")")]):e._e(),t(o["a"],{staticClass:"oper",attrs:{icon:""},on:{click:function(t){e.rename_collection(a,e.prompt(e.$t("raname-to"),a.name))}}},[t(u["a"],[e._v("mdi-form-textbox")])],1),t(o["a"],{staticClass:"oper",attrs:{icon:""},on:{click:function(t){return e.refresh_sources(a)}}},[t(u["a"],[e._v("mdi-sync")])],1)],1)],1)],1)]}))],2)],1),t(K["a"],[t(J["a"],{staticClass:"opers",attrs:{cols:"2"}},[t(o["a"],{attrs:{icon:""},on:{click:e.append_dataset}},[t(u["a"],[e._v("mdi-plus")])],1)],1),t(J["a"],[t("ParamInput",{attrs:{arg:{name:e.$t("name"),type:"",default:""}},model:{value:e.input_coll.name,callback:function(t){e.$set(e.input_coll,"name",t)},expression:"input_coll.name"}})],1),t(J["a"],[t("ParamInput",{attrs:{arg:{name:e.$t("display-name"),type:"",default:""}},model:{value:e.input_coll.display_name,callback:function(t){e.$set(e.input_coll,"display_name",t)},expression:"input_coll.display_name"}})],1),t(J["a"],[t("ParamInput",{attrs:{arg:{name:e.$t("mongocollection"),type:"",default:""}},model:{value:e.input_coll.mongocollection,callback:function(t){e.$set(e.input_coll,"mongocollection",t)},expression:"input_coll.mongocollection"}})],1)],1),t(o["a"],{attrs:{color:"primary"},on:{click:e.save}},[t(u["a"],[e._v("mdi-check")]),e._v(" "+e._s(e.$t("save"))+" ")],1)],1)],1)},zt=[],Vt=a("b76a"),Wt=a.n(Vt),Mt={name:"DatasetList",components:{ParamInput:oe["a"],draggable:Wt.a},data(){return{datasets:[],input_coll:{},valid:[]}},mounted(){this.load_datasets()},methods:{load_datasets(){$["a"].get_datasets().then(e=>this.datasets=e)},prompt(e,t){return window.prompt(e,t)},update_valid(e,t,a){var s={_id:e};s[t]=a,$["a"].call("datasets/edit",s).then(()=>$["a"].notify({title:this.$t("updated")}))},save(){this.valid.length>0?alert(this.$t("invalid-input")):$["a"].call("datasets/batch",this.datasets.map((e,t)=>Object.assign({},e,{order_weight:t,sources:null}))).then(()=>$["a"].notify({title:this.$t("saved")}))},append_dataset(){this.input_coll.name&&$["a"].call("datasets/edit",this.input_coll).then(()=>{this.load_datasets(),this.input_coll={}})},rename_collection(e,t){e&&t&&$["a"].call("datasets/rename",{_id:e._id,to:t}).then(()=>$["a"].notify({title:this.$t("renamed")})).then(this.load_datasets)},refresh_sources(e){$["a"].call("datasets/sources",{_id:e._id}).then(()=>$["a"].notify({title:this.$t("refreshed")}))}}},Ft=Mt,Bt=(a("c9f4"),Object(E["a"])(Ft,Ut,zt,!1,null,"3ab1b9ae",null)),Jt=Bt.exports,Qt=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("history")))]),t(C["b"],e._l(e.history,(function(a){return t(K["a"],{key:a._id},[t(J["a"],[e._v(e._s(a.user))]),t(J["a"],[e._v(e._s(a.created_at))]),t(J["a"],{attrs:{cols:"6"},domProps:{textContent:e._s(a.queries.join("\n"))}}),t(J["a"],[t(o["a"],{attrs:{icon:""},on:{click:function(t){return e.export_query(a)}}},[t(u["a"],[e._v("mdi-file-export")])],1),t(o["a"],{attrs:{icon:""},on:{click:function(t){return e.replay(a)}}},[t(u["a"],[e._v("mdi-eye")])],1)],1)],1)})),1)],1)},Kt=[],Ht={data(){return{history:[]}},mounted(){$["a"].call("history").then(e=>this.history=e.result)},methods:{export_query(e){$["a"].put("tasks/",{pipeline:[["DBQueryDataSource",{query:e.queries[0]}]],name:this.$t("search")+" "+e.queries[0]}).then(e=>this.$router.push("/tasks/"+e.result)).catch(()=>{})},replay(e){this.$router.push("search?q="+encodeURIComponent(e.queries[0])+"&req="+encodeURIComponent(e.queries[1]))}}},Xt=Ht,Gt=Object(E["a"])(Xt,Qt,Kt,!1,null,null,null),Yt=Gt.exports,Zt=a("1514"),ea=a("71a3"),ta=a("c671"),aa=a("fe57"),sa=a("aac8"),ia=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("login")))]),t(C["b"],[t(aa["a"],{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[t(ea["a"],{key:"form"},[e._v(e._s(e.$t("username-login")))]),t(ea["a"],{key:"otp"},[e._v(e._s(e.$t("otp-login")))])],1),t(sa["a"],{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[t(ta["a"],{key:"form"},[t(H["a"],{attrs:{label:e.$t("username")},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),t(H["a"],{attrs:{type:"password",label:e.$t("password")},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login.apply(null,arguments)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),t(ta["a"],{key:"otp"},[t(H["a"],{attrs:{label:e.$t("username")},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),t(Zt["a"],{staticClass:"otp-input",attrs:{length:"6"},on:{finish:e.login},model:{value:e.otp,callback:function(t){e.otp=t},expression:"otp"}})],1)],1)],1),t(C["a"],[t(o["a"],{attrs:{color:"primary",dark:""},on:{click:e.login}},[e._v(e._s(e.$t("login")))]),t(y["a"]),t(ee["a"],{attrs:{label:e.$t("remember-me")},model:{value:e.remember,callback:function(t){e.remember=t},expression:"remember"}})],1)],1)},ra=[],na={name:"Login",data(){return{username:"",password:"",remember:!0,otp:"",tab:""}},methods:{login(e=null){$["a"].auth(this.username,this.password,e||this.otp,this.remember).then(()=>{this.$emit("logined"),this.$router.push("/")})}}},oa=na,la=(a("24cc"),Object(E["a"])(oa,ia,ra,!1,null,"00694030",null)),ca=la.exports,ua=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("task-result"))+" "+e._s(e.id))]),t(C["b"],[e.prompt?t("p",{domProps:{innerHTML:e._s(e.prompt)}}):"number"===typeof e.total?t("ResultsView",{ref:"results",on:{load:e.load_data}}):e.redirect?t("iframe",{attrs:{src:e.redirect}}):t("div",[e._v(e._s(e.$t("task-file-result")))])],1)],1)},da=[],pa={name:"QueueResult",props:["id"],components:{ResultsView:nt},data(){return{total:0,prompt:"",redirect:""}},watch:{id(){this.$refs.results.turn_page(1)}},methods:{load_data(e){var t=(new Date).getTime()-Math.random();$["a"].call("queue/"+encodeURIComponent(this.id)+"?offset="+e.offset+"&limit="+e.limit).then(a=>{a.__redirect__?(this.redirect=a.__redirect__,this.total=null):"undefined"!==typeof a.__exception__?this.prompt=`<h4>${a.__exception__}</h4><pre>${a.__tracestack__.join("\n")}</pre>`:a.result&&(this.total=a.result.total,e.callback({offset:e.offset,result:a.result.results,token:t}))}).catch(e=>{this.prompt="<h4>"+e.message+"</h4><p>"+e.stack.replace(/\n/g,"<br>")+"</p>",this.total=void 0})}}},ha=pa,_a=(a("84f1"),Object(E["a"])(ha,ua,da,!1,null,"78f93b1c",null)),ga=_a.exports,ma=a("c377"),fa=a("71d9"),va=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("file-storage")))]),t(C["b"],[t(f["a"],e._b({directives:[{name:"show",rawName:"v-show",value:e.progress>0,expression:"progress > 0"}]},"v-progress-linear",e.progress,!1)),t("input",{attrs:{type:"file",value:"",id:"file",hidden:"",multiple:""},on:{change:e.upload_file}}),t(K["a"],[t(J["a"],[t(o["a"],{attrs:{color:"primary"},on:{click:function(t){return e.open_file_dialog()}}},[t(u["a"],[e._v("mdi-upload")]),e._v(" "+e._s(e.$t("upload"))+" ")],1),t(o["a"],{staticClass:"ml-5",attrs:{color:"primary"},on:{click:function(t){return e.new_folder()}}},[t(u["a"],[e._v("mdi-plus")]),e._v(" "+e._s(e.$t("new-folder"))+" ")],1),t("span",{staticClass:"name ml-5"},[e._v(e._s(e.selected_dir))])],1)],1)],1),t(ie["a"],{staticClass:"ma-5"},[t(fa["a"],{attrs:{flat:""}},[t(H["a"],{attrs:{clearable:"",flat:"","hide-details":"","prepend-inner-icon":"mdi-magnify",label:e.$t("search"),"clear-icon-cb":e.update_files},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search_file.apply(null,arguments)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),t(ie["a"],[t(ma["a"],{attrs:{items:e.files,"items-per-page":20,page:e.page,"hide-default-footer":""},on:{"update:page":function(t){e.page=t}},scopedSlots:e._u([{key:"default",fn:function(a){return[e._l(a.items,(function(a){return[".."!=a.name&&a.name.startsWith(".")?e._e():t(K["a"],{key:a.fullpath},[t(J["a"],{staticClass:"name"},["file"===a.type?t(o["a"],{attrs:{icon:"",href:e.file_link(a)}},[t(u["a"],[e._v("mdi-download")])],1):t(o["a"],{attrs:{icon:""},on:{click:function(t){return e.enter(a.name)}}},["folder"==a.type?t(u["a"],[e._v("mdi-folder-open")]):t(u["a"],[e._v("mdi-arrow-left-circle")])],1),e._v(" "+e._s(".."==a.name?e.$t("parent-dir"):a.name)+" "),"file"==a.type?t("div",{staticClass:"description"},[e._v(" "+e._s(e.$t("size"))+": "+e._s((a.size/1024/1024).toFixed(2))+" MB "+e._s(e.$t("created-at"))+": "+e._s(e._f("dateSafe")(1e3*a.ctime))+" "+e._s(e.$t("modified-at"))+": "+e._s(e._f("dateSafe")(1e3*a.mtime))+" ")]):e._e()],1),t(y["a"]),t(J["a"],{staticClass:"opers"},["back"!==a.type?t(o["a"],{attrs:{icon:""},on:{click:function(t){return e.copy_file_path(a)}}},[t(u["a"],[e._v("mdi-content-copy")])],1):e._e(),a.name.match(/^jindai\.plugins\..*\.zip$/)?t(o["a"],{attrs:{icon:""},on:{click:function(t){return e.install_plugin(a)}}},[t(u["a"],[e._v("mdi-cog-outline")])],1):e._e(),"back"!==a.type?t(o["a"],{attrs:{icon:""},on:{click:function(t){return e.rename_file(a)}}},[t(u["a"],[e._v("mdi-form-textbox")])],1):e._e()],1)],1)]}))]}},{key:"footer",fn:function(){return[t(K["a"],{staticClass:"mt-2",attrs:{align:"center",justify:"center"}},[t(o["a"],{staticClass:"mr-1",attrs:{small:"",dark:"",fab:"",color:"blue darken-3"},on:{click:()=>e.page>1&&--e.page}},[t(u["a"],[e._v("mdi-chevron-left")])],1),t("span",{staticClass:"mr-4 ml-4 grey--text"},[e._v(" "+e._s(e.$t("pagination",{page:e.page,total:e.pages_count}))+" ")]),t(o["a"],{staticClass:"ml-1",attrs:{small:"",dark:"",fab:"",color:"blue darken-3"},on:{click:()=>e.page<e.pages_count&&++e.page}},[t(u["a"],[e._v("mdi-chevron-right")])],1)],1)]},proxy:!0}])})],1)],1),t(C["a"],[t("input",{attrs:{type:"hidden",id:"testing-code"}})])],1)},ba=[],ya={name:"StorageList",data(){return{files:[],selected_dir:"",progress:0,admin:!1,search:"",page:1}},computed:{pages_count(){return Math.ceil(this.files.length/20)}},methods:{open_file_dialog(){document.getElementById("file").click()},new_folder(){var e=prompt(this.$t("folder-name"));e&&$["a"].call("storage/"+this.selected_dir,{mkdir:e}).then(()=>{this.update_files()})},upload_file(e){let t=new FormData;for(var a=0;a<e.target.files.length;++a)t.append("file"+a,e.target.files[a]);$["a"].upload(this.selected_dir,t,e=>{this.progress=100*e.loaded/e.total|0}).then(e=>{for(var t of(this.progress=0,e.result))this.files.splice(""!=this.selected_dir?1:0,0,t)})},search_file(){this.search?$["a"].call("storage/"+this.selected_dir,{search:this.search}).then(e=>{this.files=e.result}):this.update_files()},file_link(e){return"/api/storage/"+e.fullpath.split("/").slice(1).join("/")},install_plugin(e){$["a"].call("plugins",{url:e.fullpath}).then(e=>{e.result&&$["a"].notify(this.$t("installed"))})},rename_file(e){var t=prompt(this.$t("raname-to"),e.name);t&&$["a"].call("storage/move",{source:e.fullpath,destination:t}.then(()=>this.update_files()))},update_files(){$["a"].call("storage/"+this.selected_dir).then(e=>{this.files=e.result,""!==this.selected_dir&&this.files.splice(0,0,{name:"..",type:"back"}),history.pushState(null,null,$["a"].querystring_stringify({path:this.selected_dir}))})},copy_file_path(e){const t=e.fullpath,a=document.querySelector("#testing-code");a.setAttribute("type","text"),a.setAttribute("value",t),a.select();try{document.execCommand("copy")}catch(s){alert("Oops, unable to copy")}a.setAttribute("type","hidden"),window.getSelection().removeAllRanges()},enter(e){this.selected_dir=".."===e?this.selected_dir.split("/").slice(0,-1).join("/"):this.selected_dir.split("/").filter(e=>e).concat(e).join("/")}},mounted(){this.selected_dir=$["a"].querystring_parse(location.search).path||"",this.update_files()},watch:{selected_dir(){this.update_files()}}},ka=ya,wa=(a("d3fc"),Object(E["a"])(ka,va,ba,!1,null,"75d2b232",null)),xa=wa.exports,$a=a("e0c7"),qa=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("system-admin"))+" ")]),t(C["b"],[t(d["a"],{attrs:{subheader:""}},[t($a["a"],[e._v(" "+e._s(e.$t("users"))+" ")]),t(h["a"],[t(o["a"],{attrs:{color:"primary"},on:{click:function(t){e.show_modify=!1,e.new_user={roles:[],datasets:[]},e.show_user_modal=!0}}},[t(u["a"],[e._v("mdi-plus")]),e._v(" "+e._s(e.$t("new-user"))+" ")],1)],1),e._l(e.users,(function(a){return t(h["a"],{key:a._id},[t(_["a"],[t(_["c"],[e._v(e._s(a.username))]),t(_["b"],[t(o["a"],{on:{click:function(t){e.show_modify=!0,e.new_user=Object.assign(a,{password:""}),e.show_user_modal=!0}}},[t(u["a"],[e._v("mdi-account-edit")]),e._v(" "+e._s(e.$t("user-role"))+" ")],1),t(o["a"],{staticClass:"ml-5",on:{click:function(t){return e.del_user(a)}}},[t(u["a"],[e._v("mdi-account-cancel")]),e._v(" "+e._s(e.$t("delete"))+" ")],1)],1)],1)],1)})),t("v-divide"),t($a["a"],[e._v(e._s(e.$t("schedule")))]),t(h["a"],[t(o["a"],{attrs:{color:"primary"},on:{click:function(t){e.show_creation=!0}}},[t(u["a"],[e._v("mdi-plus")]),e._v(" "+e._s(e.$t("new-schedule"))+" ")],1)],1),e._l(e.scheduled_jobs,(function(a){return t(h["a"],{key:a.key},[t(_["a"],[t(_["c"],[e._v(" "+e._s(a.key)+" : "+e._s(a.name)+" ("+e._s(a.repr)+")")]),t(_["b"],[t(o["a"],{on:{click:function(t){return e.delete_schedule(a.key)}}},[t(u["a"],[e._v("mdi-delete")]),e._v(" "+e._s(e.$t("cancel")))],1)],1)],1)],1)}))],2),t(A["a"],{model:{value:e.show_user_modal,callback:function(t){e.show_user_modal=t},expression:"show_user_modal"}},[t(l["a"],[e.show_modify?t(C["c"],[e._v(" "+e._s(e.$t("user-modify"))+" "),t(y["a"]),t(o["a"],{attrs:{icon:""},on:{click:function(t){e.show_user_modal=!1}}},[t(u["a"],[e._v("mdi-close")])],1)],1):t(C["c"],[e._v(e._s(e.$t("new-user")))]),t(C["b"],[t(H["a"],{attrs:{label:e.$t("username"),disabled:e.show_modify},model:{value:e.new_user.username,callback:function(t){e.$set(e.new_user,"username",t)},expression:"new_user.username"}}),t(H["a"],{attrs:{label:e.$t("password"),type:"password",disabled:e.show_modify},model:{value:e.new_user.password,callback:function(t){e.$set(e.new_user,"password",t)},expression:"new_user.password"}}),t(ee["a"],{attrs:{label:e.$t("role-query"),disabled:"","input-value":!0}}),t(ee["a"],{attrs:{label:e.$t("role-task"),disabled:"","input-value":!0}}),t(ee["a"],{attrs:{label:e.$t("role-admin"),value:"admin"},model:{value:e.new_user.roles,callback:function(t){e.$set(e.new_user,"roles",t)},expression:"new_user.roles"}}),t("treeselect",{attrs:{multiple:!0,options:e.datasets.hierarchy,placeholder:e.$t("permitted-datasets")},model:{value:e.new_user.datasets,callback:function(t){e.$set(e.new_user,"datasets",t)},expression:"new_user.datasets"}})],1),t(C["a"],[e.show_modify?t(o["a"],{attrs:{color:"primary"},on:{click:e.modify_user_role}},[e._v(e._s(e.$t("modify")))]):t(o["a"],{attrs:{color:"primary"},on:{click:e.add_user}},[e._v(e._s(e.$t("ok")))]),t(o["a"],{staticClass:"ml-5",on:{click:function(t){e.show_user_modal=!1}}},[e._v(e._s(e.$t("cancel")))])],1)],1)],1),t(A["a"],{model:{value:e.show_creation,callback:function(t){e.show_creation=t},expression:"show_creation"}},[t(l["a"],[t(C["c"],[e._v(e._s(e.$t("new-schedule")))]),t(C["b"],[t("ParamInput",{attrs:{arg:{type:"TASK",name:e.$t("task")}},model:{value:e.scheduler.task,callback:function(t){e.$set(e.scheduler,"task",t)},expression:"scheduler.task"}}),t("ParamInput",{attrs:{arg:{type:"str",name:"Description, e.g. day at 06:00"}},model:{value:e.scheduler.cron,callback:function(t){e.$set(e.scheduler,"cron",t)},expression:"scheduler.cron"}})],1),t(C["a"],[t(o["a"],{attrs:{color:"primary"},on:{click:e.create_schedule}},[t(u["a"],[e._v("mdi-plus")]),e._v(" "+e._s(e.$t("add")))],1),t(o["a"],{on:{click:function(t){e.show_creation=!1}}},[e._v(e._s(e.$t("cancel")))])],1)],1)],1)],1)],1)},Ca=[],Aa={name:"UserList",components:{ParamInput:oe["a"]},data(){return{users:[],show_user_modal:!1,show_modify:!1,datasets:[],new_user:{roles:[],datasets:[]},scheduled_jobs:[],show_creation:!1,scheduler:{task:"",cron:""}}},methods:{add_user(){$["a"].put("users/",this.new_user).then(e=>{$["a"].notify({text:this.$t("user-added",{user:e.result.username})}),this.users.push(e.result),this.show_user_modal=!1})},del_user(e){confirm(this.$t("user-delete-confirm",{user:e.username}))&&$["a"].delete("users/"+e.username).then(t=>{t.result.ok&&($["a"].notify({text:this.$t("user-deleted",{user:e.username})}),this.users=this.users.filter(t=>t._id!=e._id))})},modify_user_role(){$["a"].call("users/"+this.new_user.username,{roles:this.new_user.roles,datasets:this.new_user.datasets}).then(()=>this.show_user_modal=!1)},update_scheduler(){$["a"].call("scheduler").then(e=>this.scheduled_jobs=e.result)},create_schedule(){var e=`every ${this.scheduler.cron} do ${this.scheduler.task}`;$["a"].put("scheduler",{text:e}).then(()=>{this.scheduler={cron:"",task:""},this.update_scheduler()}),this.show_creation=!1},delete_schedule(e){$["a"].delete("scheduler/"+e).then(()=>{$["a"].notify({title:this.$t("deleted")}),this.update_scheduler()})}},mounted(){$["a"].call("users/").then(e=>this.users=e.result),$["a"].get_datasets_hierarchy().then(e=>this.datasets=e),this.update_scheduler()}},Sa=Aa,ja=(a("458e"),Object(E["a"])(Sa,qa,Ca,!1,null,"4a6f3d06",null)),Oa=ja.exports,Pa=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(e._s(e.$t("preferences")))]),t(C["b"],[t(ie["a"],[t(H["a"],{attrs:{type:"password",label:e.$t("password-old")},model:{value:e.old_password,callback:function(t){e.old_password=t},expression:"old_password"}}),t(H["a"],{attrs:{type:"password",label:e.$t("password-new")},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),t(H["a"],{attrs:{type:"password",label:e.$t("password-repeated")},model:{value:e.password2,callback:function(t){e.password2=t},expression:"password2"}})],1),t(ie["a"],{directives:[{name:"show",rawName:"v-show",value:e.otp_secret,expression:"otp_secret"}],staticClass:"otp-info"},[t(K["a"],[t("div",{ref:"qrCodeUrl",staticClass:"qrcode"}),t("div",{staticClass:"ml-5"},[e._v(" "+e._s(e.$t("otp-prompt",{otp_secret:e.otp_secret}))+" ")])])],1),t(ie["a"],[t(o["a"],{staticClass:"mr-3",attrs:{color:"primary"},on:{click:e.update_password}},[e._v(" "+e._s(e.$t("password-update"))+" ")]),e.otp?t(o["a"],{on:{click:function(t){return e.change_otp(!1)}}},[e._v(e._s(e.$t("otp-disable")))]):t(o["a"],{on:{click:function(t){return e.change_otp(!0)}}},[e._v(e._s(e.$t("otp-enable")))])],1),t(ie["a"],{staticClass:"mt-5"},[t(K["a"],[t(J["a"],[t(ee["a"],{attrs:{flat:"",label:e.$t("image-full-size")},model:{value:e.config.contain,callback:function(t){e.$set(e.config,"contain",t)},expression:"config.contain"}})],1)],1),t(K["a"],[t(J["a"],[t(ee["a"],{attrs:{flat:"",label:e.$t("expert-mode")},model:{value:e.config.expert,callback:function(t){e.$set(e.config,"expert",t)},expression:"config.expert"}})],1)],1),t(K["a"],[t(J["a"],[t(ee["a"],{attrs:{flat:"",label:e.$t("image-thumbnail")},model:{value:e.config.force_thumbnail,callback:function(t){e.$set(e.config,"force_thumbnail",t)},expression:"config.force_thumbnail"}})],1)],1),t(K["a"],[t(J["a"],[t(ee["a"],{attrs:{flat:"",label:e.$t("image-enhance")},model:{value:e.config.enhance,callback:function(t){e.$set(e.config,"enhance",t)},expression:"config.enhance"}})],1)],1),t(K["a"],[t(J["a"],[t(H["a"],{attrs:{type:"number",label:e.$t("playing-interval")},model:{value:e.config.playing_interval,callback:function(t){e.$set(e.config,"playing_interval",t)},expression:"config.playing_interval"}})],1)],1)],1)],1)],1)},Ta=[],Ea=a("d044"),Ia=a.n(Ea),La={name:"Preferences",data(){return{old_password:"",password:"",password2:"",otp:!1,otp_secret:"",username:"",config:$["a"].config}},mounted(){$["a"].call("authenticate").then(e=>{this.otp=e.result.otp_secret,this.username=e.result.username})},methods:{update_password(){this.password!==this.password2?$["a"].notify({text:this.$t("password-dismatch")}):$["a"].call("account/",{old_password:this.old_password,password:this.password}).then($["a"].notify(this.$t("updated")))},change_otp(e){$["a"].call("account/",{otp:e}).then(t=>{$["a"].notify(this.$t("updated")),this.otp=e,e&&t.result&&(this.otp_secret=t.result,this.create_qr_code())})},create_qr_code(){new Ia.a(this.$refs.qrCodeUrl,{text:`otpauth://totp/${this.username}?secret=${this.otp_secret}`,width:100,height:100,colorDark:"#000000",colorLight:"#ffffff",correctLevel:Ia.a.CorrectLevel.H})}}},Na=La,Ra=(a("9f06"),Object(E["a"])(Na,Pa,Ta,!1,null,"e2992790",null)),Da=Ra.exports,Ua=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(" "+e._s(e.$t("console"))+" ")]),t(C["b"],[t(v["a"],{attrs:{label:"Mongo Collection",items:e.mongocollections},on:{change:function(t){e.previewed="count"==e.command.operation}},model:{value:e.command.mongocollection,callback:function(t){e.$set(e.command,"mongocollection",t)},expression:"command.mongocollection"}}),t("ParamInput",{attrs:{arg:{name:"Query",type:"QUERY"}},on:{input:function(t){e.previewed="count"==e.command.operation}},model:{value:e.command.query,callback:function(t){e.$set(e.command,"query",t)},expression:"command.query"}}),t("ParamInput",{attrs:{arg:{name:"Operation",type:"update_many|delete_many|count"}},on:{input:function(t){e.previewed="count"==e.command.operation}},model:{value:e.command.operation,callback:function(t){e.$set(e.command,"operation",t)},expression:"command.operation"}}),t("ParamInput",{directives:[{name:"show",rawName:"v-show",value:"count"!=e.command.operation,expression:"command.operation != 'count'"}],attrs:{arg:{name:"Parameters",type:"QUERY"}},on:{input:function(t){e.previewed="count"==e.command.operation}},model:{value:e.command.operation_params,callback:function(t){e.$set(e.command,"operation_params",t)},expression:"command.operation_params"}})],1),t(C["a"],[t(o["a"],{on:{click:e.preview}},[e._v(e._s(e.$t("preview")))]),t(o["a"],{attrs:{disabled:!e.previewed},on:{click:e.execute}},[e._v(e._s(e.$t("execute")))])],1),t(C["b"],[t("pre",[e._v(e._s(e.preview_text))])]),t(C["b"],[e._v(" "+e._s(e.$t("history"))+" "),e._l(e.config.dbconsole.history,(function(a,s){return t(K["a"],{key:s},[t(J["a"],[e._v(e._s(e.stringify_command(a)))]),t(J["a"],[t("v-button",{attrs:{icon:""},on:{click:function(t){return e.replay(a)}}},[t(u["a"],[e._v("mdi-replay")])],1)],1)],1)}))],2)],1)},za=[],Va={name:"DbConsole",components:{ParamInput:oe["a"]},data(){return{mongocollections:[$["a"].config.dbconsole.mongocollection||"paragraph"],command:{mongocollection:$["a"].config.dbconsole.mongocollection||"paragraph",query:"",operation:"count",operation_params:"",preview:!0},previewed:!1,preview_text:"",config:$["a"].config}},methods:{get_command(){return Object.assign({},this.command,{operation_params:"count"==this.command.operation?"":this.command.operation_params})},stringify_command(e){return'MongoCollection("'+e.mongocollection+'").query('+JSON.stringify(e.query,"",2)+")."+e.operation+"("+JSON.stringify(e.operation_params,"",2)+")"},preview(){this.command.preview=!0,$["a"].call("admin/db",this.get_command()).then(e=>{e=e.result,this.preview_text=this.stringify_command(e),this.previewed=!0})},execute(){this.command.preview=!1,$["a"].config.dbconsole.mongocollection=this.command.mongocollection,$["a"].config.dbconsole.history||($["a"].config.dbconsole.history=[]),$["a"].config.dbconsole.history.splice(0,0,Object.assign({},this.command)),$["a"].config.dbconsole.history.length>10&&($["a"].config.dbconsole.history=$["a"].config.dbconsole.history.slice(0,10)),$["a"].config.save(),$["a"].call("admin/db",this.get_command()).then(e=>{this.preview_text+="\n\n"+JSON.stringify(e.result,"",2)})},replay(e){this.command=Object.assign({},e),this.execute()}},mounted(){$["a"].call("admin/db/collections").then(e=>this.mongocollections=e.result)}},Wa=Va,Ma=(a("2529"),Object(E["a"])(Wa,Ua,za,!1,null,"59c088dc",null)),Fa=Ma.exports,Ba=function(){var e=this,t=e._self._c;return t(l["a"],{attrs:{flat:""}},[t(C["c"],[e._v(" "+e._s(e.$t("auto-tagging"))+" ")]),t(C["b"],[t(ma["a"],{attrs:{items:e.auto_tags,"items-per-page":20,page:e.page,search:e.search,"hide-default-footer":""},on:{"update:page":function(t){e.page=t}},scopedSlots:e._u([{key:"header",fn:function(){return[t(fa["a"],{attrs:{flat:""}},[t(H["a"],{attrs:{clearable:"",flat:"","hide-details":"","prepend-inner-icon":"mdi-magnify",label:e.$t("search")},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),t(fa["a"],{staticClass:"mb-5",attrs:{flat:""}},[t(H["a"],{attrs:{label:e.$t("match-cond")},model:{value:e.new_tag.cond,callback:function(t){e.$set(e.new_tag,"cond",t)},expression:"new_tag.cond"}}),t(H["a"],{staticClass:"new-tag-data",attrs:{label:e.$t("tag")},model:{value:e.new_tag.tag,callback:function(t){e.$set(e.new_tag,"tag",t)},expression:"new_tag.tag"}}),t(o["a"],{staticClass:"new-tag-data",on:{click:function(t){return e.auto_tags_create(e.new_tag)}}},[t(u["a"],[e._v("mdi-plus")])],1)],1),t(K["a"],e._l([e.$t("match-cond"),e.$t("tag"),e.$t("operations")],(function(a,s){return t(J["a"],{key:s},[e._v(e._s(a))])})),1)]},proxy:!0},{key:"default",fn:function(a){return e._l(a.items,(function(a){return t(K["a"],{key:a._id,attrs:{cols:"12"}},[e._l(["cond","tag"],(function(s,i){return t(J["a"],{key:i},[e._v(" "+e._s(a[s])+" ")])})),t(J["a"],[t(o["a"],{attrs:{alt:"Delete "+a._id},on:{click:function(t){return e.auto_tags_delete([a._id])}}},[t(u["a"],[e._v("mdi-delete")])],1),t(o["a"],{staticClass:"ml-5",on:{click:function(t){return e.auto_tags_apply(a._id)}}},[t(u["a"],[e._v("mdi-check")])],1)],1)],2)}))}},{key:"footer",fn:function(){return[t(K["a"],{staticClass:"mt-2",attrs:{align:"center",justify:"center"}},[t(o["a"],{staticClass:"mr-1",attrs:{small:"",dark:"",fab:"",color:"blue darken-3"},on:{click:e.prev_page}},[t(u["a"],[e._v("mdi-chevron-left")])],1),t("span",{staticClass:"mr-4 ml-4 grey--text"},[e._v(" "+e._s(e.$t("pagination",{page:e.page,total:e.pages_count}))+" ")]),t(o["a"],{staticClass:"ml-1",attrs:{small:"",dark:"",fab:"",color:"blue darken-3"},on:{click:e.next_page}},[t(u["a"],[e._v("mdi-chevron-right")])],1)],1)]},proxy:!0}])})],1)],1)},Ja=[],Qa={name:"AutoTags",data:()=>({auto_tags:[],page:1,search:"",new_tag:{tag:"",cond:""}}),computed:{pages_count(){return Math.ceil(this.auto_tags.length/20)}},mounted(){this.reload()},methods:{auto_tags_create(){if(this.new_tag.cond.startsWith("@@")&&(this.new_tag.cond="author="+this.new_tag.cond.substr(1)),!this.new_tag.tag){var e=(this.new_tag.cond.match(/@([_\w]+)/)||["",""])[1];e&&(this.new_tag.tag="*"+e)}this.new_tag.tag!=this.new_tag.cond&&this.new_tag.tag&&$["a"].put("plugins/autotags",this.new_tag).then(e=>{e.__exception__||(this.new_tag.tag="",this.new_tag.cond="",this.reload())})},auto_tags_delete(e){$["a"].call("plugins/autotags",{ids:e,delete:!0}).then(()=>this.auto_tags=this.auto_tags.filter(t=>!e.includes(t._id)))},auto_tags_apply(e){$["a"].call("plugins/autotags",{apply:e}).then(()=>$["a"].notify(this.$t("success")))},reload(){$["a"].call("plugins/autotags").then(e=>this.auto_tags=e.result)},next_page(){this.page+1<=this.pages_count&&this.page++},prev_page(){this.page-1>=1&&this.page--},do_search(e,t){return t?e.filter(e=>[e.cond,e.tag].join(" ").toLowerCase().indexOf(t.toLowerCase())>=0):e}}},Ka=Qa,Ha=(a("7884"),Object(E["a"])(Ka,Ba,Ja,!1,null,"665e2f9c",null)),Xa=Ha.exports,Ga=function(){var e=this,t=e._self._c;return t("div",[t("QueryFormulator",{model:{value:e.test,callback:function(t){e.test=t},expression:"test"}}),t("pre",{domProps:{textContent:e._s(e.test)}})],1)},Ya=[],Za=function(){var e=this,t=e._self._c;return t("div",["expr"==e.context?t("param-input",{attrs:{arg:{name:e.$t("brackets"),type:"()|[]"}},on:{change:e.update},model:{value:e.brackets,callback:function(t){e.brackets=t},expression:"brackets"}}):e._e(),t(v["a"],{attrs:{items:e.choices},on:{change:e.update},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),[e.next.startsWith("literal-")?t("param-input",{attrs:{arg:{name:"",type:"str"}},on:{change:e.update},model:{value:e.embedded,callback:function(t){e.embedded=t},expression:"embedded"}}):"null"!=e.next?t("query-formulator",{attrs:{context:e.next},on:{change:e.update},model:{value:e.embedded,callback:function(t){e.embedded=t},expression:"embedded"}}):e._e()],t(v["a"],{attrs:{items:e.jointer_choices},on:{change:e.update},model:{value:e.jointer,callback:function(t){e.jointer=t},expression:"jointer"}}),e.jointer?[t("query-formulator",{attrs:{context:"expr"},on:{change:e.update},model:{value:e.successor,callback:function(t){e.successor=t},expression:"successor"}})]:e._e()],2)},es=[];const ts=["keywords","content","author","dataset","source.url","source.file","lang"],as=["=",["%","match-regex"],">","<",">=","<=","!="],ss=["",[",","op-and"],["|","op-or"],[";","op-list-sep"],["=>","op-list-join"]],is=["literal-any","literal-text"],rs=[["~","op-not"]],ns=["in","first","last","groupby",""];var os={name:"QueryFormulator",components:{ParamInput:oe["a"]},props:{context:{type:String,default:"expr"},value:{type:String,default:""}},data(){return{function:"match",selected:{literal:"null",type:"null"},jointer:"",embedded:"",successor:"",brackets:"()"}},methods:{_items_from_array(e,t){return t.map(t=>Array.isArray(t)&&2==t.length?{text:this.$t(t[1]),value:{type:e,literal:t[0]}}:{text:""+t,value:{type:e,literal:t}})},_selected_string(){switch(this.selected.type){case"literals":return"literal-text"==this.selected.literal?"`"+this.embedded+"`":this.embedded;case"binary-operators":case"uniary-operators":return this.selected.literal+this.embedded;default:return this.selected.literal}},_stringify(){return this._selected_string()+(this.jointer?this.jointer+this.successor:"")},update(){switch(this.context){case"expr":this.$emit("input",this.brackets[0]+this._stringify()+this.brackets[1]);break;default:this.$emit("input",this._stringify());break}this.$emit("change")}},computed:{jointer_choices(){return this._items_from_array("jointers",ss)},choices(){switch(this.context){case"value-from":return this._items_from_array("fields",ts);case"binary-operators":return this._items_from_array("binary-operators",as);case"expr":return[...this._items_from_array("null",["null"]),...this._items_from_array("uniary-operators",rs),...this._items_from_array("functions",ns),...this._items_from_array("fields",ts),...this._items_from_array("literals",is)];case"call":switch(this.function){case"match":return this._items_from_array("fields",ts);case"regexMatch":return this._items_from_array("parameters",["input","regex","options"]);case"groupby":return this._items_from_array("parameters",[["id","group-by"]])}}return[]},next(){switch(this.selected.type){case"fields":return"binary-operators";case"binary-operators":case"uniary-operators":return"expr";case"null":return"null";case"literals":return this.selected.literal;default:return"fields"}}}},ls=os,cs=Object(E["a"])(ls,Za,es,!1,null,null,null),us=cs.exports,ds={name:"QueryFormTest",components:{QueryFormulator:us},data:()=>({test:""})},ps=ds,hs=Object(E["a"])(ps,Ga,Ya,!1,null,null,null),_s=hs.exports;s["default"].config.ignoredElements=["field","block","category","xml","mutation","value","sep"],s["default"].use(M["a"]),s["default"].filter("dateSafe",(function(e){if(!e)return"";if("number"===typeof e&&e<1e4||(""+e).match(/^\d{4}(-\d{1,2})?$/))return e;var t=new Date(e).toLocaleString();return"Invalid Date"===t?e:t})),s["default"].component("treeselect",B.a);const gs=[{path:"*",component:ut},{path:"/login",component:ca,name:"Login"},{path:"/view/:path(.*)",component:Ie,name:"PageView"},{path:"/tasks/shortcut/:id",component:Tt,props:!0},{path:"/tasks/:id",component:Ct,props:!0},{path:"/tasks",component:Dt},{path:"/datasets",component:Jt},{path:"/history",component:Yt},{path:"/results/:id(.*)",component:ga,props:!0},{path:"/storage",component:xa},{path:"/admin",component:Oa},{path:"/preferences",component:Da},{path:"/dbconsole",component:Fa},{path:"/autotags",component:Xa},{path:"/querytest",component:_s}],ms=new M["a"]({routes:gs,mode:"history",scrollBehavior(){return{x:0,y:0}}});ms.beforeEach((e,t,a)=>{"Login"===e.name||localStorage.token?a():a({name:"Login"})}),new s["default"]({vuetify:W,router:ms,i18n:N["a"],render:e=>e(z)}).$mount("#app")},"58bd":function(e,t,a){},"5d27":function(e,t,a){},6178:function(e,t,a){},"64f6":function(e,t,a){},"6d2d":function(e,t,a){e.exports=a.p+"img/loading.aef9417c.png"},"6f36":function(e,t,a){},"6fdc":function(e,t,a){"use strict";a("a893")},"6fe0":function(e,t,a){},"714f":function(e,t,a){},7884:function(e,t,a){"use strict";a("3b7a")},"84e2":function(e,t,a){},"84f1":function(e,t,a){"use strict";a("e8c9")},8878:function(e,t,a){"use strict";a("c48c")},"8d8f":function(e,t,a){},"8f34":function(e,t,a){},"9f06":function(e,t,a){"use strict";a("6178")},a893:function(e,t,a){},bf0f:function(e,t,a){"use strict";a.d(t,"b",(function(){return c}));var s=a("2b0e"),i=a("a925");s["default"].use(i["a"]);const r="chs",n="localeLanguage",o={chs:a("cb76"),cht:a("20fe"),en:a("edd4"),ja:a("0423")},l=new i["a"]({locale:r,messages:o,fallbackLocale:"cn"}),c=e=>{void 0===e&&(e=window.localStorage.getItem(n),void 0===o[e]&&(e=r)),window.localStorage.setItem(n,e),Object.keys(o).forEach(e=>{document.body.classList.remove("lang-"+e)}),document.body.classList.add("lang-"+e),document.body.setAttribute("lang",e),s["default"].config.lang=e,l.locale=e};c(),window.i18n=l,t["a"]=l},c000:function(e,t,a){"use strict";a("6f36")},c04a:function(e,t,a){},c48c:function(e,t,a){},c53e:function(e,t,a){"use strict";a("10e1")},c9f4:function(e,t,a){"use strict";a("5d27")},cb76:function(e){e.exports=JSON.parse('{"_lang":"简体中文","add":"添加","author":"作者","browse":"浏览","cancel":"取消","concurrent":"并行数","confirm-delete":"确认要删除该项目吗？","copy":"复制","created-at":"创建于","created-by":"创建者","dataset":"数据集","default":"默认","delete":"删除","deleted":"已删除。","delimiter":"分隔符","design-view":"设计视图","drop-in-files":"在此拖入文件","edit-paragraph":"编辑段落","edit":"编辑","export-excel":"导出 Excel","export-json":"导出 JSON","export-task":"导出新任务","file-storage":"文件存储","finished-tasks":"已完成的任务","finished":"已完成","found-results":"已找到 %{total} 个结果。","group":"按组","grouping":"分组","image-enhance":"增强图像","image-full-size":"显示全图","image-thumbnail":"缩略图","installed":"已成功安装。","playing-interval":"播放间隔毫秒数","invalid-input":"无效的输入值。","langs":"自动:auto|简体中文:chs|繁体中文:cht|英文:en|德文:de|法文:fr|俄文:ru|西班牙文:es|葡萄牙文:pt|日文:ja|韩文/朝鲜文:kr|越南文:vn","match-file-type":"文件应为下列类型之一: %{type}","match-type":"输入值应为 %{type} 类型","metadata":"元数据","modified-at":"修改于","modify":"修改","name":"名称","new-schedule":"新计划任务","new-task":"新任务","new-user":"新用户","no-available":"无可用结果。","none":"无","number-1-10":"输入值应介于 1 - 10 之间。","ok":"确认","otp-prompt":"请使用 Authenticator 扫描上述二维码，或输入如下信息：%{otp_secret}。本信息仅显示一次。","otp-enable":"启用 OTP 登录","otp-disable":"关闭 OTP 登录","page-size":"每页结果数","pagenum":"页码","parent-dir":"返回上级目录","password":"密码","pdate-rev":"从新到旧","pdate":"从旧到新","permitted-datasets":"允许访问的数据集","pipeline":"任务流程","play":"播放","prefix":"前缀","query":"查询","quick-task":"快速任务","random":"随机","required":"必填","reset-storage":"重置","results":"结果","resume-next":"忽略错误","role-admin":"管理员","role-query":"查询","role-task":"任务管理","run-at":"运行于","run-background":"队列运行","run-now":"立即运行","running-tasks":"运行中的任务","running":"运行中","save":"保存","saved":"已保存。","schedule":"计划任务","search":"搜索","shared":"共享","shortcut-params":"快速任务参数","size":"大小","sort":"排序","source":"来源","tag-batch":"批量标签","tag":"标签","tagging":"标签","task-enqueued":"任务 %{task} 已加入到队列中。","task":"任务","text":"文本","total":"总数","upload":"上传","user-added":"成功添加用户 %{user}。","user-delete-confirm":"确认要删除用户 %{user} 吗？","user-deleted":"用户 %{user} 已成功删除.","user-modify":"修改用户","user-role":"用户角色","username":"用户名","users":"用户","view":"查看","waiting-tasks":"等待中的任务","waiting":"等待中","account":"账户","admin":"管理","all":"全部","auto-tagging":"自动标签","clear":"清除","console":"控制台","history":"历史","log-out":"登出","password-new":"新密码","password-old":"旧密码","password-repeated":"重复新密码","password-dismatch":"新密码输入不一致。","permissions":"权限","tasks":"任务","user":"用户","updated":"已成功更新。","merge":"合并","password-update":"更改密码","datasets":"数据集","renamed":"重命名成功。","refreshed":"已刷新。","match-cond":"匹配条件","operations":"操作","pagination":"第 %{page} / %{total} 页","pagenum-modes":"修改全部页面:all|只修改当前页面:solo|只修改本页之后的页面:after","raname-to":"更名为","preview":"预览","execute":"执行","login":"登录","username-login":"用户名密码登录","otp-login":"OTP 登录","remember-me":"记住我","date":"日期","outline":"大纲","edit-pagenum":"编辑页码","modify-mode":"修改模式","task-result":"任务结果","task-file-result":"任务结果为文件，请下载。","preferences":"设置","split":"分离","send-task":"发送到任务","send-to":"发送到","backend-disconnected":"后台连接错误，请稍后再试","forbidden":"没有访问权限，请重新登录","unmatched-credentials":"登录信息有误，请检查","system-admin":"系统管理","folio-mode":"对开模式","brackets":"括号","expert-mode":"专家模式","success":"成功","latest-imported":"最近导入","new-folder":"新建文件夹","folder-name":"文件夹名称","display-name":"显示名称","mongocollection":"数据库集合名"}')},cbe0:function(e,t,a){},d3fc:function(e,t,a){"use strict";a("c04a")},d5a4:function(e,t,a){},d722:function(e,t,a){"use strict";(function(e){a("d9e2"),a("907a"),a("3c5d"),a("fa9e"),a("77d9");var s=a("bc3a"),i=a.n(s),r=a("2b0e"),n=a("852e"),o=a.n(n),l=a("bf0f");const c=a("e2ff"),u=a("38fe"),d="/api/",p=[];var h=localStorage.token||"";function _(){let e={fit:"both",drawer:!0,contain:!1,enhance:!1,force_thumbnail:!1,playing_interval:1e3,view_mode:"list",page_size:50,tagging:{batch_delim:", ",batch_prefix:"*"},dbconsole:{mongocollection:"paragraph",history:[]},groups:"none",sort:"id",expert:!1,multiple_image_domains:!0};function t(e){localStorage["local_config"]=JSON.stringify(e)}function a(){return JSON.parse(localStorage["local_config"]||"{}")}let s={get(t,a){var s=t[a]||"";switch(typeof e[a]){case"number":return+s;case"boolean":return!0===s}return s},set(a,s,i){switch(typeof e[s]){case"number":i=+i;break;case"boolean":i=""+i=="true";break}return a[s]=i,t(a),!0}};return new Proxy(Object.assign({save(){t(this)}},e,a()),s)}o.a.set("token",h,{domain:"."+location.hostname}),t["a"]={stack:p,locale:"chs",bus:new r["default"],user:"",apiBase:d,notify(e){this.bus.$emit("alert",e)},querystring_parse(e){var t={};for(var a of new URLSearchParams(e).entries())a[1].startsWith("JSON__")?a[1]=JSON.parse(a[1].slice(6)):a[1].match(/^\d+$/)?a[1]=+a[1]:a[1].match(/^(true|false)$/)&&(a[1]="true"==a[1]),t[a[0]]=a[1];return t},querystring_stringify(e){var t="";for(var a in e){let s=e[a];switch(t+=`&${a}=`,typeof s){case"object":t+="JSON__"+encodeURIComponent(JSON.stringify(s));break;case"string":t+=encodeURIComponent(s);break;default:t+=s;break}}return""===t?"":"?"+t.substring(1)},blob_download(e,t){var a=URL.createObjectURL(e);const s=document.createElement("a");s.href=a,s.download=t,s.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout(()=>{window.URL.revokeObjectURL(a),s.remove()},100)},cancel_source(){return i.a.CancelToken.source()},_catch_and_then(e){function t(e,t){this.name="DataError",this.message=e,this.stack=t}return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,e.then(e=>{if(p.length>0&&(p.pop(),this.bus.$emit("loading",p.length)),e.data.__exception__)throw new t(e.data.__exception__,e.data.__tracestack__.join("\n"));return e.data}).catch(e=>{if(console.log(e),p.length>0&&(p.pop(),this.bus.$emit("loading",p.length)),"string"===typeof e.message&&(e=e.message,e.match("code 502")?e="backend-disconnected":e.match("Forbidden.")?(localStorage.token="",e="forbidden",location.href.endsWith("/login")||(location.href="/login")):e.match("Unmatched credentials")&&(e="unmatched-credentials")),"Cancel"!==e.toString())throw this.notify(e),e})},_axios_config(e){return this.locale||(this.locale=l["a"].locale),Object.assign({headers:{"X-Authentication-Token":h,"X-Preferred-Language":this.locale}},e||{})},upload(e,t,a){return this._catch_and_then(i.a.put(this.apiBase+"storage/"+e,t,this._axios_config({onUploadProgress:a})))},auth(e,t,a,s){return"string"==typeof a&&(a=a.substr(0,6)),new Promise((i,r)=>{this.call("authenticate",{username:e,password:t,otp:a}).then(e=>{e?(localStorage.token=h=e.result,o.a.set("token",h,s?{expires:30}:void 0),i(e)):r(e)})})},log_out(){return i.a.delete(this.apiBase+"authenticate").then(()=>{location.reload()})},escape_regex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},help_pipelines(){return this._pipelines?new Promise(e=>{e(this._pipelines)}):this.call("help/pipelines").then(e=>(this._pipelines=e.result,e.result))},help_langs(){return this._langs?new Promise(e=>{e(this._langs)}):this.call("help/langs").then(e=>(this._langs=e.result,e.result))},querify(e){function t(e){if(e.match(/^\(.*\)$/)){var t=0;for(var a of e.substr(1,e.length-2))switch(a){case"(":++t;break;case")":if(!t)return e;--t;break;case",":case"|":return e}if(0==t)return e.substr(1,e.length-2)}return e}if(Array.isArray(e))return 0==e.length?"[]":1==e.length?"["+t(this.querify(e[0]))+"]":"["+e.map(e=>t(this.querify(e))).join(";")+"]";if(null===e||void 0===e)return"null";if("object"==typeof e){var a="";for(var s of Object.entries(e)){let e=s[0],i=s[1];switch(e){case"$and":a+=",("+i.map(e=>t(this.querify(e))).join(",")+")";break;case"$or":a+=",("+i.map(e=>t(this.querify(e))).join("|")+")";break;case"$options":break;case"$regex":a+="%"+this.querify(i);break;default:e.startsWith("$")?a+=","+e.substr(1)+"("+t(this.querify(i))+")":(a+=","+e,i=this.querify(i),i.startsWith("(%")?a+=i.substr(1,i.length-2):a+="="+i);break}}return"("+t(a.replace(/^,/,""))+")"}return JSON.stringify(e)},logined(){return new Promise((e,t)=>{this.call("authenticate").then(t=>{this.user=t.result.username,e(t)}).catch(t)})},call(e,t,a=null){return p.push(e),this.bus.$emit("loading",p.length),"undefined"!==typeof t?this._catch_and_then(i.a.post(d+e,t,this._axios_config(a?{cancelToken:a.token}:{}))):this._catch_and_then(i.a.get(d+e,this._axios_config(a?{cancelToken:a.token}:{})))},delete(e,t){return p.push(e),this.bus.$emit("loading",p.length),"undefined"!==typeof t?this._catch_and_then(i.a.delete(d+e,t,this._axios_config())):this._catch_and_then(i.a.delete(d+e,this._axios_config()))},put(e,t){return p.push(e),this.bus.$emit("loading",p.length),this._catch_and_then(i.a.put(d+e,t,this._axios_config()))},cut_words(e){return this.call("quicktask",{pipeline:[["WordCut",{lang:"auto",content:e}]]})},queue(){return this.call("queue/").then(e=>e.result).catch(()=>{})},fav(e){const t="favored:"+this.user;var a={keywords:t};this.favored(e)?(e.keywords=e.keywords.filter(e=>e!=t),a={$pull:a}):(e.keywords.push(t),a={$push:a}),this.call(`collections/${e.mongocollection||"paragraph"}/${e._id}`,a)},favored(e){return e.keywords.includes("favored:"+this.user)},get_datasets(){function e(e){var t=[],a="";for(var s of e.name.split("--"))a+=s,t.push(a),a+="--";return t}return this.call("datasets").then(t=>{var a={},s=t.result.sort(e=>e.order_weight);for(var i of s)for(var r of e(i))a[r]||(a[r]=i.order_weight);function n(t,s){for(var i=e(t),r=e(s),n=0;n<i.length&&n<r.length;++n){let e=i[n],t=r[n];if(a[e]!==a[t])return a[e]-a[t]}return t.name.localeCompare(s.name)}return s.sort(n)})},get_datasets_hierarchy(){var e={};return this.get_datasets().then(t=>{var a={id:"ROOT",name:"",children:[]};for(var s of(t=t.map(e=>(e.segments=(e.display_name||e.name).split("--"),e.level=e.segments.length,e)),t))for(var i=a,r=0,n=s.segments[0];r<s.level;r++,n+="--"+s.segments[r]){var o=i.children.filter(e=>e.id==n)[0];"undefined"===typeof o&&(o={id:n,label:s.segments[r],children:[]},e[o.id]={name:n,dataset_name:s.name,mongocollection:s.mongocollection},i.children.push(o)),i=o}return{hierarchy:a.children,bundles:e}})},quote(e){return e=e||"",e.match(/[`'"()\s.&,+%:/]|(^\d+(\.\d+)?$)/)?"`"+e.replace(/`/g,"\\`")+"`":(""===e&&(e="''"),e)},_generate_domain(e,t){const a=/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/,s=e=>{let t=0;for(let a=0;a<e.length;a++){const s=e.charCodeAt(a);t=(t<<5)-t+s,t&=t}return new Uint32Array([t])[0].toString(36)};return this.config.multiple_image_domains&&location.hostname.match(a)?`//${t}-`+s(e)+"."+location.host:""},get_image_url(t){var a="";if(t.file.indexOf("://")>=0){let e=(t.url||t.orig_path||"").split(".").pop(),s=t.file.split("://");a=`/images/${s[0]}/${s[1].replace("$",t.block_id)||t.block_id}/image.${e.length<=4?e:"data"}`}else a=t.file.match(/\.pdf$/)&&"undefined"!==typeof t.page?`/images/file/${t.file}__hash/pdf/${t.page}`:t.file?"/images/file/"+t.file:t.url?t.url:"/images/object/"+e.from(JSON.stringify(t)).toString("base64");return this._generate_domain(a,"img")+a},get_item_image(e,t){let a=this.config;if(!e||!e.source||!e.source.url&&!e.source.file)return c;var s="";return e&&"video"==e.item_type?e.thumbnail?this.get_image_url({file:e.thumbnail,url:".jpg"}):u:(t||a.force_thumbnail&&(s+="__hash/thumbnail/1280"),e.source.file?(e.source.file.indexOf("://")>=0&&(e.source.block_id=e._id),this.get_image_url(e.source)+s):e.source.url)},get_item_video(e){return e.source.file?(e.source.file.indexOf("://")>=0&&(e.source.block_id=e._id),this.get_image_url(e.source)):e.source.url},get_paragraph_image(e){return e.images&&e.images.length?this.get_item_image(e.images[0]):e.source&&e.source.file&&e.source.file.endsWith(".pdf")?this.get_item_image(e):c},scope(e){if(e.author)return"author="+JSON.stringify(e.author);if(Array.isArray(e.keywords)){var t=e.keywords.filter(e=>e.startsWith("@"));if(t.length)return JSON.stringify(t[0]);var a=e.keywords.filter(e=>e.startsWith("*"));if(a.length)return JSON.stringify(a[0])}return"id="+e._id},config:_()}}).call(this,a("b639").Buffer)},df07:function(e,t,a){"use strict";a("e3d7")},e2ff:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV4AAACWBAMAAABkyf1EAAAAG1BMVEXMzMzFxcW+vr63t7exsbGqqqqjo6OcnJyWlpawiKwlAAADbklEQVR42u2YQU/bQBBGx0kgHF1AJcegijZHeqlyDFIFOVJOOaZqVXKMSkF7DCSOv59dzew6wSFpqzZdsPS9A6zsjfw8Hs/sWoQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEELIXwKk9n8PT06tOfQSfHsV872vmG9WMV+fwBXyvayUb4aHSvneY76UO3F37Se+F/knkbfux8ovk4v8SxjWr/OrWL6TAdqF3A6AeVryxeQIyNM6gKFZnrvg9k4P2ZyaK7Iqhm/LROzCIxRaj3z14LCDUEj6OuWzSuogszkdFGdj+DYsgfXCGt5HF/a+M+QOU5ePrJA0bIpmUNNGXYgkNkI7kq+4eZDrYJYeLi/sfZGlGsqe9LUTtnCT7o9wqoG+SQ+cs9vM3+8Pls/lf/t29fIqN1LVzuLCwfdS3aYiu3pikEsYuTwVOQL0HoYa+IdYvk2MTS5RK2mEBr3wTfUexiJ1/eOmlrpjqdm0uvr2reO4WSzfunruwQuJmPXSV9O5pU8gwUTLn/hRwz8GzQfnX8R5LF9xucnt+KXaICv5Tm3UDlM/9sKPdvUWNLaS+EzoIJpvBz2VCwrdecnXF480TPXtwZLIXssuQmaEOVF8dzFWuaDQyUu+94tOV/i+6ZtvGqIa0qgZp6CpRA0zVQoRaqHcL8q+tXNtZpNHk31JBvzTieErI6TmW17mrPO11ut9iznP4NtC7w/j2wVwd7bMh8e+vWi+O7jfmL9lX4evx6Fotxf5MI65npxYQc021oeSbwPfy/XM3rdJbF/po6X193JN/S35Bksz75XrWfIqom8Lg0WgVvpbyddnbWJN0bJgVLRxacWrv36ZKAlma9YPJV8/aFhn9isJ7ceWQP08YnzFYdP6bCW+bQvlRGSAYn1mC80aZjF9u9i0/l3J36HV4EmY7Px6MjveHyweSxTfJjbtL0q+dcxVDdM0TB6h2HPEKb+Fry1k1+/fVuovgIeRBtOGtiobFHukeL76ovsAZ/Ir3yPbQXfV9zWAqTVDC/ClPAMn7vY3q6xz3J1Kw+lD+OBuU98MD1207w//SGculaKbVUS09s1vnmYV8U2sHyeRqu4WsP37bqSvJFugj6v0wEX6CrUF/PezWWUqQ+Ki7dm2Q/0ad2dCCCGEEEIIIYQQQgghhBBCCCHkBfITuFeSbWJ0VM4AAAAASUVORK5CYII="},e3d7:function(e,t,a){},e8c9:function(e,t,a){},edd4:function(e){e.exports=JSON.parse('{"_lang":"English","account":"Account","add":"Add","admin":"Administration","all":"All","author":"Author","auto-tagging":"Auto Tagging","browse":"Browse","cancel":"Cancel","clear":"Clear","concurrent":"Concurrent","confirm-delete":"Sure to delete this item?","console":"Console","copy":"Copy","created-at":"Created","created-by":"Created by","dataset":"Dataset","default":"Default","delete":"Delete","deleted":"Deleted.","delimiter":"Delimiter","design-view":"Design View","drop-in-files":"Drop in Files Here","edit-paragraph":"Edit Paragraph","edit":"Edit","export-excel":"Export to XLSX","export-json":"Export to JSON","export-task":"Export as new Task","file-storage":"File Storage","finished-tasks":"Finished Tasks","finished":"Finished","found-results":"Found %{total} results.","group":"Group","grouping":"Grouping","history":"History","image-enhance":"Enhance Image","image-full-size":"Full Size","image-thumbnail":"Thumbnails","installed":"Installed.","playing-interval":"Playing interval (ms)","invalid-input":"Invalid Input value.","langs":"Auto:auto","log-out":"Log Out","match-file-type":"File should be of types: %{type}","match-type":"Input value should be of type: %{type}","metadata":"Metadata","modified-at":"Modified","modify":"Modify","name":"Name","new-schedule":"New Schedule","new-task":"New Task","new-user":"New User","no-available":"No available results","none":"None","number-1-10":"Input value should be between 1 and 10","ok":"OK","otp-prompt":"Please use the Authenticator to scan the above QR code or enter the following information: %{otp_secret}. This message will not be displayed any more.","otp-disable":"Disable OTP","otp-enable":"Enable OTP","page-size":"Page Size","pagenum":"Page #","parent-dir":"Parent Directory","password":"Password","password-new":"New Password","password-old":"Old Password","password-repeated":"Repeat New Password","password-dismatch":"New passwords dismatch.","pdate-rev":"Latest","pdate":"Oldest","permissions":"Permissions","permitted-datasets":"Permitted Datasets","pipeline":"Pipeline","play":"Play","prefix":"Prefix","query":"Query","quick-task":"Quick Task","random":"Random","required":"Required","reset-storage":"Rst. Storage","results":"Results","resume-next":"Ignore Errors","role-admin":"Administrator","role-query":"Query","role-task":"Task Management","run-at":"Run at","run-background":"Run in Background","run-now":"Run Now","running-tasks":"Running Tasks","running":"Running","save":"Save","saved":"Saved","schedule":"Schedule","search":"Search","separate":"Separate","shared":"Shared","shortcut-params":"Shortcut Parameters","size":"Size","sort":"Sort","source":"Source","tag-batch":"Batch Tagging","tag":"Tag","tagging":"Tagging","task-enqueued":"Task %{task} enqueued.","task":"Task","tasks":"Tasks","text":"Text","total":"Total","upload":"Upload","updated":"Updated.","user-added":"User %{user} added.","user-delete-confirm":"Sure to delete user %{user}?","user-deleted":"User %{user} deleted.","user-modify":"Modify User","user-role":"User Role","user":"User","username":"User Name","users":"Users","view":"View","waiting-tasks":"Waiting Tasks","waiting":"Waiting","merge":"Merge","password-update":"Update Password","datasets":"Datasets","renamed":"Renamed.","refreshed":"Refreshed.","match-cond":"Match Condition","operations":"Operations","pagination":"Page %{page} / %{total}","raname-to":"Raname to","preview":"Preview","execute":"Execute","login":"Login","username-login":"Login with Password","otp-login":"Login with OTP","remember-me":"Remember me","date":"Date","outline":"Outline","edit-pagenum":"Edit Page Number","modify-mode":"Modify Mode","pagenum-modes":"All:all|Current Page Only:solo|Pages Following Only:after","task-result":"Task Result","task-file-result":"Task Result is a file, please download it.","preferences":"Preferences","split":"Split","send-task":"Send to Task","send-to":"Send to","backend-disconnected":"Backend Disconnected.","unmatched-credentials":"Unmatched credentials.","system-admin":"System","folio-mode":"Folio mode","brackets":"Brackets","expert-mode":"Expert mode","success":"Success","latest-imported":"Latest Imported","new-folder":"New Folder","folder-name":"Folder Name","display-name":"Display Name","mongocollection":"MongoDB Collection Name"}')},ee69:function(e,t,a){"use strict";a("714f")},f947:function(e,t,a){"use strict";a("8f34")},f994:function(e,t,a){"use strict";a("1f8a")},faad:function(e,t,a){"use strict";a("364c")}});
//# sourceMappingURL=app.868f68b1.js.map